<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>生产计划管理系统</title>
    <!-- Tailwind CSS v3 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <!-- 统一的 Tailwind 配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1a365d',      // 深蓝色主色调
                        secondary: '#4299e1',    // 浅蓝色辅助色
                        success: '#48bb78',      // 成功绿色
                        warning: '#ed8936',      // 警告橙色
                        danger: '#e53e3e',       // 错误红色
                        light: '#f7fafc',        // 浅色背景
                        dark: '#2d3748',         // 深色文字
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    boxShadow: {
                        card: '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',
                    }
                }
            }
        }
    </script>
    
    <!-- 日历视图切换功能 -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 视图切换按钮
            const yearViewBtn = document.getElementById('year-view-btn');
            const monthViewBtn = document.getElementById('month-view-btn');
            const weekViewBtn = document.getElementById('week-view-btn');
            
            // 视图容器
            const yearView = document.getElementById('year-view');
            const monthView = document.getElementById('month-view');
            const weekView = document.getElementById('week-view');
            
            // 筛选器容器
            const monthFilterContainer = document.getElementById('month-filter-container');
            const weekFilterContainer = document.getElementById('week-filter-container');
            
            // 年份导航
            const prevYearBtn = document.getElementById('prev-year');
            const nextYearBtn = document.getElementById('next-year');
            const currentYearDisplay = document.getElementById('current-year-display');
            
            // 月份导航
            const prevMonthBtn = document.getElementById('prev-month');
            const nextMonthBtn = document.getElementById('next-month');
            const currentMonthDisplay = document.getElementById('current-month-display');
            
            // 周次导航
            const prevWeekBtn = document.getElementById('prev-week');
            const nextWeekBtn = document.getElementById('next-week');
            const currentWeekDisplay = document.getElementById('current-week-display');
            
            // 筛选器
            const yearFilter = document.getElementById('year-filter');
            const monthFilter = document.getElementById('month-filter');
            const weekFilter = document.getElementById('week-filter');
            
            // 初始化年度
            const initYearBtn = document.getElementById('init-year-btn');
            const initYearWizard = document.getElementById('init-year-wizard');
            const closeInitWizard = document.getElementById('close-init-wizard');
            const cancelInitWizard = document.getElementById('cancel-init-wizard');
            const confirmInitWizard = document.getElementById('confirm-init-wizard');
            
            // 班次详情面板
            const shiftDetailPanel = document.getElementById('shift-detail-panel');
            const closeShiftDetail = document.getElementById('close-shift-detail');
            const saveShiftDetail = document.getElementById('save-shift-detail');
            
            // 保存按钮
            const saveCalendarBtn = document.getElementById('save-calendar-btn');
            
            // 当前日期状态
            let currentYear = 2025;
            let currentMonth = 7; // 7月
            let currentWeek = 27; // 第27周
            
            // 视图切换函数
            function switchView(viewType) {
                // 隐藏所有视图
                yearView.classList.add('hidden');
                monthView.classList.add('hidden');
                weekView.classList.add('hidden');
                
                // 重置所有按钮样式
                yearViewBtn.classList.remove('bg-blue-600', 'text-white');
                yearViewBtn.classList.add('bg-white', 'text-gray-700');
                monthViewBtn.classList.remove('bg-blue-600', 'text-white');
                monthViewBtn.classList.add('bg-white', 'text-gray-700');
                weekViewBtn.classList.remove('bg-blue-600', 'text-white');
                weekViewBtn.classList.add('bg-white', 'text-gray-700');
                
                // 隐藏所有筛选器容器
                monthFilterContainer.classList.add('hidden');
                weekFilterContainer.classList.add('hidden');
                
                // 显示选中的视图
                if (viewType === 'year') {
                    yearView.classList.remove('hidden');
                    yearViewBtn.classList.remove('bg-white', 'text-gray-700');
                    yearViewBtn.classList.add('bg-blue-600', 'text-white');
                } else if (viewType === 'month') {
                    monthView.classList.remove('hidden');
                    monthViewBtn.classList.remove('bg-white', 'text-gray-700');
                    monthViewBtn.classList.add('bg-blue-600', 'text-white');
                    monthFilterContainer.classList.remove('hidden');
                } else if (viewType === 'week') {
                    weekView.classList.remove('hidden');
                    weekFilterContainer.classList.remove('hidden');
                    weekViewBtn.classList.remove('bg-white', 'text-gray-700');
                    weekViewBtn.classList.add('bg-blue-600', 'text-white');
                }
            }
            
            // 年份导航函数
            function navigateYear(direction) {
                currentYear += direction;
                currentYearDisplay.textContent = `${currentYear}年`;
                yearFilter.value = currentYear;
                updateCalendarData();
            }
            
            // 月份导航函数
            function navigateMonth(direction) {
                currentMonth += direction;
                if (currentMonth > 12) {
                    currentMonth = 1;
                    currentYear++;
                } else if (currentMonth < 1) {
                    currentMonth = 12;
                    currentYear--;
                }
                
                const monthNames = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];
                currentMonthDisplay.textContent = `${currentYear}年${monthNames[currentMonth-1]}`;
                yearFilter.value = currentYear;
                monthFilter.value = currentMonth;
                updateCalendarData();
            }
            
            // 周次导航函数
            function navigateWeek(direction) {
                currentWeek += direction;
                if (currentWeek > 52) {
                    currentWeek = 1;
                    currentYear++;
                } else if (currentWeek < 1) {
                    currentWeek = 52;
                    currentYear--;
                }
                
                // 简化的周次日期范围计算（实际应用中需要更精确的计算）
                const startDate = new Date(currentYear, 0, (currentWeek - 1) * 7 + 1);
                const endDate = new Date(currentYear, 0, currentWeek * 7);
                
                const formatDate = (date) => {
                    return `${date.getMonth() + 1}月${date.getDate()}日`;
                };
                
                currentWeekDisplay.textContent = `${currentYear}年第${currentWeek}周 (${formatDate(startDate)}-${formatDate(endDate)})`;
                yearFilter.value = currentYear;
                weekFilter.value = currentWeek;
                updateCalendarData();
            }
            
            // 更新日历数据（模拟数据更新）
            function updateCalendarData() {
                // 在实际应用中，这里会根据选择的年份、月份、周次从后端获取数据
                console.log(`更新日历数据: ${currentYear}年, ${currentMonth}月, 第${currentWeek}周`);
                
                // 模拟数据加载
                const loadingMessage = document.createElement('div');
                loadingMessage.className = 'text-center py-4 text-blue-600';
                loadingMessage.innerHTML = '<i class="fa fa-spinner fa-spin mr-2"></i> 正在加载数据...';
                
                // 根据当前视图添加加载提示
                if (!yearView.classList.contains('hidden')) {
                    yearView.querySelector('.grid').appendChild(loadingMessage);
                    setTimeout(() => {
                        yearView.querySelector('.grid').removeChild(loadingMessage);
                    }, 1000);
                } else if (!monthView.classList.contains('hidden')) {
                    monthView.querySelector('table').parentNode.insertBefore(loadingMessage, monthView.querySelector('table'));
                    setTimeout(() => {
                        monthView.querySelector('table').parentNode.removeChild(loadingMessage);
                    }, 1000);
                } else if (!weekView.classList.contains('hidden')) {
                    weekView.querySelector('.bg-white').appendChild(loadingMessage);
                    setTimeout(() => {
                        weekView.querySelector('.bg-white').removeChild(loadingMessage);
                    }, 1000);
                }
            }
            
            // 打开班次详情面板
            function openShiftDetail(date, shiftType) {
                document.getElementById('detail-date').textContent = date;
                document.getElementById('detail-shift').value = shiftType;
                shiftDetailPanel.classList.remove('translate-x-full');
            }
            
            // 关闭班次详情面板
            function closeShiftDetailPanel() {
                shiftDetailPanel.classList.add('translate-x-full');
            }
            
            // 打开初始化年度向导
            function openInitYearWizard() {
                initYearWizard.classList.remove('hidden');
            }
            
            // 关闭初始化年度向导
            function closeInitYearWizardPanel() {
                initYearWizard.classList.add('hidden');
            }
            
            // 确认初始化年度
            function confirmInitYear() {
                const year = document.getElementById('wizard-year').value;
                const shiftModel = document.getElementById('wizard-shift-model').value;
                const holidays = document.getElementById('wizard-holidays').value;
                
                console.log(`初始化年度: ${year}, 班次模型: ${shiftModel}, 节假日: ${holidays}`);
                
                // 显示成功消息
                alert(`成功初始化${year}年度排产日历！`);
                closeInitYearWizardPanel();
            }
            
            // 保存日历设置
            function saveCalendarSettings() {
                alert('日历设置已保存！');
            }
            
            // 保存班次详情
            function saveShiftDetails() {
                const date = document.getElementById('detail-date').textContent;
                const shift = document.getElementById('detail-shift').value;
                const workcenter = document.getElementById('detail-workcenter').value;
                const workers = document.getElementById('detail-workers').value;
                const equipment = document.getElementById('detail-equipment').value;
                const capacity = document.getElementById('detail-capacity').value;
                
                console.log(`保存班次详情: ${date}, ${shift}, ${workcenter}, ${workers}人, ${equipment}台设备, 产能: ${capacity}`);
                
                // 显示成功消息
                alert('班次详情已保存！');
                closeShiftDetailPanel();
            }
            
            // 绑定事件监听器
            yearViewBtn.addEventListener('click', () => switchView('year'));
            monthViewBtn.addEventListener('click', () => switchView('month'));
            weekViewBtn.addEventListener('click', () => switchView('week'));
            
            prevYearBtn.addEventListener('click', () => navigateYear(-1));
            nextYearBtn.addEventListener('click', () => navigateYear(1));
            
            prevMonthBtn.addEventListener('click', () => navigateMonth(-1));
            nextMonthBtn.addEventListener('click', () => navigateMonth(1));
            
            prevWeekBtn.addEventListener('click', () => navigateWeek(-1));
            nextWeekBtn.addEventListener('click', () => navigateWeek(1));
            
            yearFilter.addEventListener('change', (e) => {
                currentYear = parseInt(e.target.value);
                currentYearDisplay.textContent = `${currentYear}年`;
                updateCalendarData();
            });
            
            monthFilter.addEventListener('change', (e) => {
                currentMonth = parseInt(e.target.value);
                const monthNames = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];
                currentMonthDisplay.textContent = `${currentYear}年${monthNames[currentMonth-1]}`;
                updateCalendarData();
            });
            
            weekFilter.addEventListener('change', (e) => {
                currentWeek = parseInt(e.target.value);
                navigateWeek(0); // 更新显示，但不改变周次
            });
            
            initYearBtn.addEventListener('click', openInitYearWizard);
            closeInitWizard.addEventListener('click', closeInitYearWizardPanel);
            cancelInitWizard.addEventListener('click', closeInitYearWizardPanel);
            confirmInitWizard.addEventListener('click', confirmInitYear);
            
            closeShiftDetail.addEventListener('click', closeShiftDetailPanel);
            saveShiftDetail.addEventListener('click', saveShiftDetails);
            
            saveCalendarBtn.addEventListener('click', saveCalendarSettings);
            
            // 为日历天添加点击事件
            document.querySelectorAll('.calendar-day').forEach(day => {
                day.addEventListener('click', function() {
                    const date = this.getAttribute('data-date');
                    openShiftDetail(date, 'morning');
                });
            });
            
            // 为年度视图中的月份添加点击事件
            document.querySelectorAll('#year-view .grid-cols-3 > div').forEach(month => {
                month.addEventListener('click', function() {
                    // 从点击的元素中提取月份信息
                    const monthName = this.querySelector('.font-medium').textContent;
                    const monthMap = {
                        '1月': 1, '2月': 2, '3月': 3, '4月': 4, '5月': 5, '6月': 6,
                        '7月': 7, '8月': 8, '9月': 9, '10月': 10, '11月': 11, '12月': 12
                    };
                    
                    currentMonth = monthMap[monthName];
                    switchView('month');
                    navigateMonth(0); // 更新显示，但不改变月份
                });
            });
            
            // 初始化视图
            switchView('year');
            
            // 初始化月度产能图表
            if (document.getElementById('monthlyCapacityChart')) {
                const ctx = document.getElementById('monthlyCapacityChart').getContext('2d');
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['第1周', '第2周', '第3周', '第4周', '第5周'],
                        datasets: [
                            {
                                label: '总装线1',
                                data: [180, 190, 200, 185, 195],
                                backgroundColor: 'rgba(66, 153, 225, 0.7)',
                                borderColor: 'rgba(66, 153, 225, 1)',
                                borderWidth: 1
                            },
                            {
                                label: '总装线2',
                                data: [170, 185, 195, 190, 180],
                                backgroundColor: 'rgba(72, 187, 120, 0.7)',
                                borderColor: 'rgba(72, 187, 120, 1)',
                                borderWidth: 1
                            },
                            {
                                label: '机加工线',
                                data: [150, 160, 165, 170, 175],
                                backgroundColor: 'rgba(237, 137, 54, 0.7)',
                                borderColor: 'rgba(237, 137, 54, 1)',
                                borderWidth: 1
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: '产能 (台)'
                                }
                            }
                        }
                    }
                });
            }
        });
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .transition-all {
                transition-property: all;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 150ms;
            }
            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }
            .scrollbar-hide {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
            .gantt-task {
                position: absolute;
                height: 80%;
                top: 10%;
                border-radius: 4px;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                font-size: 12px;
                cursor: pointer;
                transition: all 0.2s;
            }
            .gantt-task:hover {
                transform: scaleY(1.1);
                box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            }
            .calendar-day {
                height: 80px;
                min-width: 120px;
                border: 1px solid #e2e8f0;
                transition: all 0.2s;
            }
            .calendar-day:hover {
                background-color: #f7fafc;
                box-shadow: inset 0 0 0 2px #4299e1;
            }
            .shift-block {
                height: 20px;
                margin: 2px 0;
                border-radius: 3px;
                padding: 0 4px;
                font-size: 11px;
                color: white;
                display: flex;
                align-items: center;
                cursor: pointer;
            }
        }
    </style>
</head>
<body class="bg-gray-100 font-sans">
    <div class="flex h-screen overflow-hidden">
        <!-- 左侧导航栏 -->
        <aside class="bg-primary text-white w-64 flex-shrink-0 hidden md:block">
            <div class="p-4 border-b border-blue-800">
                <h1 class="text-xl font-bold">生产计划管理系统</h1>
            </div>
            <nav class="mt-4">
                <!-- 计划需求管理 -->
                <div class="px-4 py-2 text-xs text-blue-300 uppercase tracking-wider cursor-pointer flex justify-between items-center plan-demand-toggle">
                    <span>计划需求管理</span>
                    <i class="fa fa-chevron-down transition-transform duration-200"></i>
                </div>
                <div class="plan-demand-submenu hidden">

                    <a href="#activity-02" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-02">
                        <i class="fa fa-download w-5 h-5 mr-3"></i>
                        <span>02 订单同步管理</span>
                    </a>
                    <a href="#activity-04" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-04">
                        <i class="fa fa-filter w-5 h-5 mr-3"></i>
                        <span>04 主计划编制</span>
                    </a>
                    <a href="#activity-06" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-06">
                        <i class="fa fa-exchange w-5 h-5 mr-3"></i>
                        <span>06 工厂调拨管理</span>
                    </a>
                    <a href="#activity-07" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-07">
                        <i class="fa fa-list-alt w-5 h-5 mr-3"></i>
                        <span>07 生产订单接收</span>
                    </a>
                    <a href="#activity-27" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-27">
                        <i class="fa fa-database w-5 h-5 mr-3"></i>
                        <span>27 滚动储备管理</span>
                    </a>
                </div>
                
                <!-- 需求分析与协同 -->
                <div class="px-4 py-2 mt-4 text-xs text-blue-300 uppercase tracking-wider cursor-pointer flex justify-between items-center demand-analysis-toggle">
                    <span>需求分析与协同</span>
                    <i class="fa fa-chevron-down transition-transform duration-200"></i>
                </div>
                <div class="demand-analysis-submenu hidden">
                    <a href="#activity-03" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-03">
                        <i class="fa fa-line-chart w-5 h-5 mr-3"></i>
                        <span>03 滚动计划编制</span>
                    </a>
                    <a href="#activity-05" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-05">
                        <i class="fa fa-flask w-5 h-5 mr-3"></i>
                        <span>05 研发协同管理</span>
                    </a>
                    <a href="#activity-08" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-08">
                        <i class="fa fa-cubes w-5 h-5 mr-3"></i>
                        <span>08 备件需求计划</span>
                    </a>
                    <a href="#activity-10" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-10">
                        <i class="fa fa-file-text-o w-5 h-5 mr-3"></i>
                        <span>10 业务联络书下发</span>
                    </a>
                    <a href="#activity-14" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-14">
                        <i class="fa fa-paper-plane w-5 h-5 mr-3"></i>
                        <span>14 版本发布与变更控制台</span>
                    </a>
                    <a href="#activity-15" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-15">
                        <i class="fa fa-comments-o w-5 h-5 mr-3"></i>
                        <span>15 计划执行反馈</span>
                    </a>
                </div>
                
                <!-- 工艺与产能管理 -->
                <div class="px-4 py-2 mt-4 text-xs text-blue-300 uppercase tracking-wider cursor-pointer flex justify-between items-center process-capacity-toggle">
                    <span>工艺与产能管理</span>
                    <i class="fa fa-chevron-down transition-transform duration-200"></i>
                </div>
                <div class="process-capacity-submenu hidden">
                    <a href="#activity-09" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-09">
                        <i class="fa fa-wrench w-5 h-5 mr-3"></i>
                        <span>09 工艺参数匹配</span>
                    </a>
                    <a href="#activity-11" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-11">
                        <i class="fa fa-calculator w-5 h-5 mr-3"></i>
                        <span>11 产能核算分析</span>
                    </a>
                    <a href="#activity-12" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-12">
                        <i class="fa fa-exclamation-triangle w-5 h-5 mr-3"></i>
                        <span>12 未齐套物料管理</span>
                    </a>
                    <a href="#activity-13" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-13">
                        <i class="fa fa-sliders w-5 h-5 mr-3"></i>
                        <span>13 工艺参数维护</span>
                    </a>
                    <a href="#activity-25" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-25">
                        <i class="fa fa-cogs w-5 h-5 mr-3"></i>
                        <span>25 机台模具资源建模</span>
                    </a>
                    <a href="#activity-26" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-26">
                        <i class="fa fa-code w-5 h-5 mr-3"></i>
                        <span>26 产能公式配置</span>
                    </a>
                    <a href="#activity-01" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-01">
                        <i class="fa fa-calendar-check-o w-5 h-5 mr-3"></i>
                        <span>01 排产日历设置</span>
                    </a>
                </div>
                
                <!-- 库存与MRP运算 -->
                <div class="px-4 py-2 mt-4 text-xs text-blue-300 uppercase tracking-wider cursor-pointer flex justify-between items-center inventory-mrp-toggle">
                    <span>库存与MRP运算</span>
                    <i class="fa fa-chevron-down transition-transform duration-200"></i>
                </div>
                <div class="inventory-mrp-submenu hidden">
                    <a href="#activity-16" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-16">
                        <i class="fa fa-tasks w-5 h-5 mr-3"></i>
                        <span>16 MRP需求中心</span>
                    </a>
                    <a href="#activity-17" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-17">
                        <i class="fa fa-shopping-cart w-5 h-5 mr-3"></i>
                        <span>17 物料需求监控</span>
                    </a>
                    <a href="#activity-18" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-18">
                        <i class="fa fa-balance-scale w-5 h-5 mr-3"></i>
                        <span>18 库存核对</span>
                    </a>
                    <a href="#activity-19" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-19">
                        <i class="fa fa-exclamation-circle w-5 h-5 mr-3"></i>
                        <span>19 物料状态反馈</span>
                    </a>
                    <a href="#activity-21" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-21">
                        <i class="fa fa-code-fork w-5 h-5 mr-3"></i>
                        <span>21 外购订单下发</span>
                    </a>
                </div>
                
                <!-- 高级排产与执行 -->
                <div class="px-4 py-2 mt-4 text-xs text-blue-300 uppercase tracking-wider cursor-pointer flex justify-between items-center advanced-scheduling-toggle">
                    <span>高级排产与执行</span>
                    <i class="fa fa-chevron-down transition-transform duration-200"></i>
                </div>
                <div class="advanced-scheduling-submenu hidden">
                    <a href="#activity-20" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-20">
                        <i class="fa fa-play-circle-o w-5 h-5 mr-3"></i>
                        <span>20 内控计划下发</span>
                    </a>
                    <a href="#activity-22" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-22">
                        <i class="fa fa-bar-chart w-5 h-5 mr-3"></i>
                        <span>22 智能排产台</span>
                    </a>
                    <a href="#activity-23" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-23">
                        <i class="fa fa-send-o w-5 h-5 mr-3"></i>
                        <span>23 两器T+3计划下发</span>
                    </a>
                    <a href="#activity-24" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-24">
                        <i class="fa fa-check-circle-o w-5 h-5 mr-3"></i>
                        <span>24 执行监控中心</span>
                    </a>
<!-- 新增 Activity 28 -->
                    <a href="#activity-28" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-28">
                        <i class="fa fa-globe w-5 h-5 mr-3"></i>
                        <span>28 系统集成全景图</span>
                    </a>
                     <a href="#activity-29" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all nav-link pl-10" data-target="activity-29">
                        <i class="fa fa-globe w-5 h-5 mr-3"></i>
                        <span>29 全景计划追溯大厅</span>
                    </a>
                </div>
            </nav>
        </aside>

        <!-- 移动端导航按钮 -->
        <div class="md:hidden fixed bottom-4 right-4 z-50">
            <button id="mobile-nav-toggle" class="bg-primary text-white p-3 rounded-full shadow-lg">
                <i class="fa fa-bars"></i>
            </button>
        </div>

        <!-- 移动端导航菜单 -->
        <div id="mobile-nav" class="fixed inset-0 bg-primary z-40 transform translate-x-full transition-transform duration-300 md:hidden">
            <div class="flex justify-end p-4">
                <button id="mobile-nav-close" class="text-white">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            <nav class="mt-4 text-white">
                <!-- 移动端导航菜单项 -->
                <!-- 计划需求管理 -->
                <div class="px-4 py-2 text-xs text-blue-300 uppercase tracking-wider cursor-pointer flex justify-between items-center mobile-plan-demand-toggle">
                    <span>计划需求管理</span>
                    <i class="fa fa-chevron-down transition-transform duration-200"></i>
                </div>
                <div class="mobile-plan-demand-submenu hidden">

                    <a href="#activity-02" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-02">
                        <i class="fa fa-download w-5 h-5 mr-3"></i>
                        <span>02 订单同步管理</span>
                    </a>
                    <a href="#activity-04" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-04">
                        <i class="fa fa-filter w-5 h-5 mr-3"></i>
                        <span>04 主计划编制</span>
                    </a>
                    <a href="#activity-06" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-06">
                        <i class="fa fa-exchange w-5 h-5 mr-3"></i>
                        <span>06 工厂调拨管理</span>
                    </a>
                    <a href="#activity-07" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-07">
                        <i class="fa fa-list-alt w-5 h-5 mr-3"></i>
                        <span>07 生产订单接收</span>
                    </a>
                </div>
                
                <!-- 需求分析与协同 -->
                <div class="px-4 py-2 mt-4 text-xs text-blue-300 uppercase tracking-wider cursor-pointer flex justify-between items-center mobile-demand-analysis-toggle">
                    <span>需求分析与协同</span>
                    <i class="fa fa-chevron-down transition-transform duration-200"></i>
                </div>
                <div class="mobile-demand-analysis-submenu hidden">
                    <a href="#activity-03" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-03">
                        <i class="fa fa-line-chart w-5 h-5 mr-3"></i>
                        <span>03 滚动计划编制</span>
                    </a>
                    <a href="#activity-05" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-05">
                        <i class="fa fa-flask w-5 h-5 mr-3"></i>
                        <span>05 研发协同管理</span>
                    </a>
                    <a href="#activity-08" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-08">
                        <i class="fa fa-cubes w-5 h-5 mr-3"></i>
                        <span>08 备件需求计划</span>
                    </a>
                    <a href="#activity-10" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-10">
                        <i class="fa fa-file-text-o w-5 h-5 mr-3"></i>
                        <span>10 业务联络书下发</span>
                    </a>
                    <a href="#activity-14" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-14">
                        <i class="fa fa-paper-plane w-5 h-5 mr-3"></i>
                        <span>14 版本发布与变更控制台</span>
                    </a>
                    <a href="#activity-15" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-15">
                        <i class="fa fa-comments-o w-5 h-5 mr-3"></i>
                        <span>15 计划执行反馈</span>
                    </a>
                </div>
                
                <!-- 工艺与产能管理 -->
                <div class="px-4 py-2 mt-4 text-xs text-blue-300 uppercase tracking-wider cursor-pointer flex justify-between items-center mobile-process-capacity-toggle">
                    <span>工艺与产能管理</span>
                    <i class="fa fa-chevron-down transition-transform duration-200"></i>
                </div>
                <div class="mobile-process-capacity-submenu hidden">
                    <a href="#activity-09" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-09">
                        <i class="fa fa-wrench w-5 h-5 mr-3"></i>
                        <span>09 工艺参数匹配</span>
                    </a>
                    <a href="#activity-11" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-11">
                        <i class="fa fa-calculator w-5 h-5 mr-3"></i>
                        <span>11 产能核算分析</span>
                    </a>
                    <a href="#activity-12" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-12">
                        <i class="fa fa-exclamation-triangle w-5 h-5 mr-3"></i>
                        <span>12 未齐套物料管理</span>
                    </a>
                    <a href="#activity-13" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-13">
                        <i class="fa fa-sliders w-5 h-5 mr-3"></i>
                        <span>13 工艺参数维护</span>
                    </a>
                    <a href="#activity-01" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-01">
                        <i class="fa fa-calendar-check-o w-5 h-5 mr-3"></i>
                        <span>01 排产日历设置</span>
                    </a>
                </div>
                
                <!-- 库存与MRP运算 -->
                <div class="px-4 py-2 mt-4 text-xs text-blue-300 uppercase tracking-wider cursor-pointer flex justify-between items-center mobile-inventory-mrp-toggle">
                    <span>库存与MRP运算</span>
                    <i class="fa fa-chevron-down transition-transform duration-200"></i>
                </div>
                <div class="mobile-inventory-mrp-submenu hidden">
                    <a href="#activity-16" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-16">
                        <i class="fa fa-tasks w-5 h-5 mr-3"></i>
                        <span>16 MRP需求中心</span>
                    </a>
                    <a href="#activity-17" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-17">
                        <i class="fa fa-shopping-cart w-5 h-5 mr-3"></i>
                        <span>17 物料需求监控</span>
                    </a>
                    <a href="#activity-18" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-18">
                        <i class="fa fa-balance-scale w-5 h-5 mr-3"></i>
                        <span>18 库存核对</span>
                    </a>
                    <a href="#activity-19" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-19">
                        <i class="fa fa-exclamation-circle w-5 h-5 mr-3"></i>
                        <span>19 物料状态反馈</span>
                    </a>
                    <a href="#activity-21" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-21">
                        <i class="fa fa-code-fork w-5 h-5 mr-3"></i>
                        <span>21 外购订单下发</span>
                    </a>
                </div>
                
                <!-- 高级排产与执行 -->
                <div class="px-4 py-2 mt-4 text-xs text-blue-300 uppercase tracking-wider cursor-pointer flex justify-between items-center mobile-advanced-scheduling-toggle">
                    <span>高级排产与执行</span>
                    <i class="fa fa-chevron-down transition-transform duration-200"></i>
                </div>
                <div class="mobile-advanced-scheduling-submenu hidden">
                    <a href="#activity-20" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-20">
                        <i class="fa fa-play-circle-o w-5 h-5 mr-3"></i>
                        <span>20 内控计划下发</span>
                    </a>
                    <a href="#activity-22" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-22">
                        <i class="fa fa-bar-chart w-5 h-5 mr-3"></i>
                        <span>22 智能排产台</span>
                    </a>
                    <a href="#activity-23" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-23">
                        <i class="fa fa-send-o w-5 h-5 mr-3"></i>
                        <span>23 两器T+3计划下发</span>
                    </a>
                    <a href="#activity-24" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-24">
                        <i class="fa fa-check-circle-o w-5 h-5 mr-3"></i>
                        <span>24 执行监控中心</span>
                    </a>
<!-- 新增 Activity 28 -->
                    <a href="#activity-28" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-28">
                        <i class="fa fa-globe w-5 h-5 mr-3"></i>
                        <span>28 系统集成全景图</span>
                    </a>
                    <a href="#activity-29" class="flex items-center px-4 py-3 hover:bg-blue-800 transition-all mobile-nav-link pl-10" data-target="activity-29">
                        <i class="fa fa-globe w-5 h-5 mr-3"></i>
                        <span>29 全景计划追溯大厅</span>
                    </a>
                </div>
            </nav>
        </div>

        <!-- 主内容区 -->
        <main class="flex-1 overflow-y-auto bg-gray-100">
            <!-- 顶部导航栏 -->
            <header class="bg-white shadow-sm">
                <div class="flex items-center justify-between px-4 py-3">
                    <div class="flex items-center">
                        <button id="sidebar-toggle" class="mr-4 text-gray-500 focus:outline-none md:hidden">
                            <i class="fa fa-bars"></i>
                        </button>
                        <h2 id="page-title" class="text-lg font-medium text-gray-800">生产计划管理系统</h2>
                    </div>
                    <div class="flex items-center">
                        <div class="relative mr-4">
                            <input type="text" placeholder="搜索..." class="pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <i class="fa fa-search absolute left-3 top-3 text-gray-400"></i>
                        </div>
                        <div class="relative">
                            <button class="flex items-center text-gray-700 focus:outline-none">
                                <span class="mr-2">管理员</span>
                                <i class="fa fa-user-circle text-xl"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </header>

            <!-- 内容区域 -->
            <div class="container mx-auto px-4 py-6">
                <!-- 仪表盘概览 -->
                <div id="dashboard" class="mb-8">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-blue-100 text-blue-600">
                                    <i class="fa fa-calendar fa-2x"></i>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">年度计划进度</p>
                                    <p class="text-2xl font-semibold text-gray-800">75%</p>
                                </div>
                            </div>
                            <div class="mt-4">
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-blue-600 h-2 rounded-full" style="width: 75%"></div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-green-100 text-green-600">
                                    <i class="fa fa-check-circle fa-2x"></i>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">已完成订单</p>
                                    <p class="text-2xl font-semibold text-gray-800">128</p>
                                </div>
                            </div>
                            <div class="mt-4">
                                <p class="text-sm text-green-600"><i class="fa fa-arrow-up"></i> 12% 较上月</p>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-yellow-100 text-yellow-600">
                                    <i class="fa fa-clock-o fa-2x"></i>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">待处理订单</p>
                                    <p class="text-2xl font-semibold text-gray-800">42</p>
                                </div>
                            </div>
                            <div class="mt-4">
                                <p class="text-sm text-yellow-600"><i class="fa fa-arrow-up"></i> 5% 较上月</p>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-6">
                            <div class="flex items-center">
                                <div class="p-3 rounded-full bg-red-100 text-red-600">
                                    <i class="fa fa-exclamation-triangle fa-2x"></i>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-500">异常订单</p>
                                    <p class="text-2xl font-semibold text-gray-800">7</p>
                                </div>
                            </div>
                            <div class="mt-4">
                                <p class="text-sm text-red-600"><i class="fa fa-arrow-down"></i> 3% 较上月</p>
                            </div>
                        </div>
                    </div>

                    <div class="mt-8 grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-medium text-gray-800 mb-4">产能负荷趋势</h3>
                            <div class="h-64">
                                <canvas id="capacityChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-medium text-gray-800 mb-4">订单状态分布</h3>
                            <div class="h-64">
                                <canvas id="orderStatusChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 活动内容区域 -->
                <div id="activity-content">
                    <!-- 01 排产日历设置 -->
                    <div id="activity-01" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">01 排产日历设置</h3>
                                <p class="text-sm text-gray-500 mt-1">多维度排产日历配置与管理</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>年度排产日历：配置年度工作日、节假日数据，定义不同车间/产线的标准班次模型</li>
                                        <li>月度排产日历：细化月度生产计划，支持按产品类型、客户优先级进行月度产能分配</li>
                                        <li>周度排产日历：精确到周的生产任务安排，支持瓶颈资源识别和优化调整</li>
                                        <li>产能初始化：基于多维度日历与班次设置生成资源可用产能模型</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">日期/班次信息、产品工艺参数、资源能力数据</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">多维度产能日历、Time_Bucket（产能时间桶）、资源负荷分析</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 资源日历配置页面 -->
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-800">多维度排产日历配置</h3>
                                <div class="flex space-x-2">
                                    <div class="flex border border-gray-300 rounded overflow-hidden">
                                        <button id="year-view-btn" class="px-3 py-2 bg-blue-600 text-white hover:bg-blue-700 transition-all">
                                            <i class="fa fa-calendar-o mr-1"></i> 年度
                                        </button>
                                        <button id="month-view-btn" class="px-3 py-2 bg-white text-gray-700 hover:bg-gray-100 transition-all">
                                            <i class="fa fa-calendar-minus-o mr-1"></i> 月度
                                        </button>
                                        <button id="week-view-btn" class="px-3 py-2 bg-white text-gray-700 hover:bg-gray-100 transition-all">
                                            <i class="fa fa-calendar-check-o mr-1"></i> 周度
                                        </button>
                                    </div>
                                    <button id="init-year-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                        <i class="fa fa-calendar-plus-o mr-1"></i> 初始化年度
                                    </button>
                                    <button id="save-calendar-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all">
                                        <i class="fa fa-save mr-1"></i> 保存
                                    </button>
                                </div>
                            </div>
                            <div class="p-6">
                                <!-- 筛选区 -->
                                <div class="flex flex-wrap gap-4 mb-6">
                                    <div class="w-full md:w-auto">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">车间</label>
                                        <select id="workshop-filter" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                            <option value="">全部车间</option>
                                            <option value="1">总装车间</option>
                                            <option value="2">机加工车间</option>
                                            <option value="3">电子车间</option>
                                        </select>
                                    </div>
                                    <div class="w-full md:w-auto">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">产线</label>
                                        <select id="line-filter" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                            <option value="">全部产线</option>
                                            <option value="1">总装线1</option>
                                            <option value="2">总装线2</option>
                                            <option value="3">机加工线1</option>
                                            <option value="4">机加工线2</option>
                                        </select>
                                    </div>
                                    <div class="w-full md:w-auto">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">年度</label>
                                        <select id="year-filter" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                            <option value="2025">2025</option>
                                            <option value="2024">2024</option>
                                            <option value="2023">2023</option>
                                        </select>
                                    </div>
                                    <div id="month-filter-container" class="w-full md:w-auto hidden">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">月份</label>
                                        <select id="month-filter" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                            <option value="1">1月</option>
                                            <option value="2">2月</option>
                                            <option value="3">3月</option>
                                            <option value="4">4月</option>
                                            <option value="5">5月</option>
                                            <option value="6">6月</option>
                                            <option value="7">7月</option>
                                            <option value="8">8月</option>
                                            <option value="9">9月</option>
                                            <option value="10">10月</option>
                                            <option value="11">11月</option>
                                            <option value="12">12月</option>
                                        </select>
                                    </div>
                                    <div id="week-filter-container" class="w-full md:w-auto hidden">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">周次</label>
                                        <select id="week-filter" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                            <option value="1">第1周</option>
                                            <option value="2">第2周</option>
                                            <option value="3">第3周</option>
                                            <option value="4">第4周</option>
                                            <option value="5">第5周</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- 日历视图区域 -->
                                <div id="calendar-views">
                                    <!-- 年度视图 -->
                                    <div id="year-view" class="calendar-view">
                                        <div class="overflow-x-auto">
                                            <div class="min-w-[1200px]">
                                                <!-- 年份选择器 -->
                                                <div class="flex justify-between items-center mb-4">
                                                    <button id="prev-year" class="text-gray-500 hover:text-gray-700">
                                                        <i class="fa fa-chevron-left"></i>
                                                    </button>
                                                    <h4 id="current-year-display" class="text-lg font-medium">2025年</h4>
                                                    <button id="next-year" class="text-gray-500 hover:text-gray-700">
                                                        <i class="fa fa-chevron-right"></i>
                                                    </button>
                                                </div>

                                                <!-- 年度日历网格 -->
                                                <div class="grid grid-cols-4 gap-4">
                                                    <!-- 第一季度 -->
                                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                                        <h5 class="text-center font-medium mb-3">第一季度</h5>
                                                        <div class="grid grid-cols-3 gap-2">
                                                            <div class="text-center p-2 border border-gray-200 rounded cursor-pointer hover:bg-blue-50">
                                                                <div class="font-medium">1月</div>
                                                                <div class="text-xs text-gray-500 mt-1">工作日: 22天</div>
                                                                <div class="text-xs text-gray-500">班次: 两班制</div>
                                                            </div>
                                                            <div class="text-center p-2 border border-gray-200 rounded cursor-pointer hover:bg-blue-50">
                                                                <div class="font-medium">2月</div>
                                                                <div class="text-xs text-gray-500 mt-1">工作日: 19天</div>
                                                                <div class="text-xs text-gray-500">班次: 两班制</div>
                                                            </div>
                                                            <div class="text-center p-2 border border-gray-200 rounded cursor-pointer hover:bg-blue-50">
                                                                <div class="font-medium">3月</div>
                                                                <div class="text-xs text-gray-500 mt-1">工作日: 21天</div>
                                                                <div class="text-xs text-gray-500">班次: 两班制</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <!-- 第二季度 -->
                                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                                        <h5 class="text-center font-medium mb-3">第二季度</h5>
                                                        <div class="grid grid-cols-3 gap-2">
                                                            <div class="text-center p-2 border border-gray-200 rounded cursor-pointer hover:bg-blue-50">
                                                                <div class="font-medium">4月</div>
                                                                <div class="text-xs text-gray-500 mt-1">工作日: 22天</div>
                                                                <div class="text-xs text-gray-500">班次: 两班制</div>
                                                            </div>
                                                            <div class="text-center p-2 border border-gray-200 rounded cursor-pointer hover:bg-blue-50">
                                                                <div class="font-medium">5月</div>
                                                                <div class="text-xs text-gray-500 mt-1">工作日: 21天</div>
                                                                <div class="text-xs text-gray-500">班次: 两班制</div>
                                                            </div>
                                                            <div class="text-center p-2 border border-gray-200 rounded cursor-pointer hover:bg-blue-50">
                                                                <div class="font-medium">6月</div>
                                                                <div class="text-xs text-gray-500 mt-1">工作日: 20天</div>
                                                                <div class="text-xs text-gray-500">班次: 两班制</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <!-- 第三季度 -->
                                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                                        <h5 class="text-center font-medium mb-3">第三季度</h5>
                                                        <div class="grid grid-cols-3 gap-2">
                                                            <div class="text-center p-2 border border-gray-200 rounded cursor-pointer hover:bg-blue-50">
                                                                <div class="font-medium">7月</div>
                                                                <div class="text-xs text-gray-500 mt-1">工作日: 23天</div>
                                                                <div class="text-xs text-gray-500">班次: 两班制</div>
                                                            </div>
                                                            <div class="text-center p-2 border border-gray-200 rounded cursor-pointer hover:bg-blue-50">
                                                                <div class="font-medium">8月</div>
                                                                <div class="text-xs text-gray-500 mt-1">工作日: 22天</div>
                                                                <div class="text-xs text-gray-500">班次: 两班制</div>
                                                            </div>
                                                            <div class="text-center p-2 border border-gray-200 rounded cursor-pointer hover:bg-blue-50">
                                                                <div class="font-medium">9月</div>
                                                                <div class="text-xs text-gray-500 mt-1">工作日: 21天</div>
                                                                <div class="text-xs text-gray-500">班次: 两班制</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <!-- 第四季度 -->
                                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                                        <h5 class="text-center font-medium mb-3">第四季度</h5>
                                                        <div class="grid grid-cols-3 gap-2">
                                                            <div class="text-center p-2 border border-gray-200 rounded cursor-pointer hover:bg-blue-50">
                                                                <div class="font-medium">10月</div>
                                                                <div class="text-xs text-gray-500 mt-1">工作日: 21天</div>
                                                                <div class="text-xs text-gray-500">班次: 两班制</div>
                                                            </div>
                                                            <div class="text-center p-2 border border-gray-200 rounded cursor-pointer hover:bg-blue-50">
                                                                <div class="font-medium">11月</div>
                                                                <div class="text-xs text-gray-500 mt-1">工作日: 22天</div>
                                                                <div class="text-xs text-gray-500">班次: 两班制</div>
                                                            </div>
                                                            <div class="text-center p-2 border border-gray-200 rounded cursor-pointer hover:bg-blue-50">
                                                                <div class="font-medium">12月</div>
                                                                <div class="text-xs text-gray-500 mt-1">工作日: 20天</div>
                                                                <div class="text-xs text-gray-500">班次: 两班制</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 月度视图 -->
                                    <div id="month-view" class="calendar-view hidden">
                                        <div class="overflow-x-auto">
                                            <div class="min-w-[1000px]">
                                                <!-- 月份选择器 -->
                                                <div class="flex justify-between items-center mb-4">
                                                    <button id="prev-month" class="text-gray-500 hover:text-gray-700">
                                                        <i class="fa fa-chevron-left"></i>
                                                    </button>
                                                    <h4 id="current-month-display" class="text-lg font-medium">2025年7月</h4>
                                                    <button id="next-month" class="text-gray-500 hover:text-gray-700">
                                                        <i class="fa fa-chevron-right"></i>
                                                    </button>
                                                </div>

                                                <!-- 月度产能分布图表 -->
                                                <div class="bg-white p-4 rounded-lg shadow mb-4">
                                                    <h5 class="font-medium mb-3">月度产能分布</h5>
                                                    <div class="h-64">
                                                        <canvas id="monthlyCapacityChart"></canvas>
                                                    </div>
                                                </div>

                                                <!-- 日历表格 -->
                                                <table class="w-full border-collapse">
                                                    <thead>
                                                        <tr class="bg-gray-50">
                                                            <th class="border border-gray-200 p-2 text-left text-sm font-medium text-gray-500">日期</th>
                                                            <th class="border border-gray-200 p-2 text-center text-sm font-medium text-gray-500">一</th>
                                                            <th class="border border-gray-200 p-2 text-center text-sm font-medium text-gray-500">二</th>
                                                            <th class="border border-gray-200 p-2 text-center text-sm font-medium text-gray-500">三</th>
                                                            <th class="border border-gray-200 p-2 text-center text-sm font-medium text-gray-500">四</th>
                                                            <th class="border border-gray-200 p-2 text-center text-sm font-medium text-gray-500">五</th>
                                                            <th class="border border-gray-200 p-2 text-center text-sm font-medium text-gray-500">六</th>
                                                            <th class="border border-gray-200 p-2 text-center text-sm font-medium text-gray-500">日</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td class="border border-gray-200 p-2 text-sm text-gray-500">周1</td>
                                                            <td class="border border-gray-200 p-1 calendar-day" data-date="2025-07-01">
                                                                <div class="text-xs text-gray-500 mb-1">1</div>
                                                                <div class="shift-block bg-green-500">早班 (8:00-16:00)</div>
                                                                <div class="shift-block bg-blue-500">晚班 (16:00-24:00)</div>
                                                            </td>
                                                            <td class="border border-gray-200 p-1 calendar-day" data-date="2025-07-02">
                                                                <div class="text-xs text-gray-500 mb-1">2</div>
                                                                <div class="shift-block bg-green-500">早班 (8:00-16:00)</div>
                                                                <div class="shift-block bg-blue-500">晚班 (16:00-24:00)</div>
                                                            </td>
                                                            <td class="border border-gray-200 p-1 calendar-day" data-date="2025-07-03">
                                                                <div class="text-xs text-gray-500 mb-1">3</div>
                                                                <div class="shift-block bg-green-500">早班 (8:00-16:00)</div>
                                                                <div class="shift-block bg-blue-500">晚班 (16:00-24:00)</div>
                                                            </td>
                                                            <td class="border border-gray-200 p-1 calendar-day" data-date="2025-07-04">
                                                                <div class="text-xs text-gray-500 mb-1">4</div>
                                                                <div class="shift-block bg-green-500">早班 (8:00-16:00)</div>
                                                                <div class="shift-block bg-blue-500">晚班 (16:00-24:00)</div>
                                                            </td>
                                                            <td class="border border-gray-200 p-1 calendar-day" data-date="2025-07-05">
                                                                <div class="text-xs text-gray-500 mb-1">5</div>
                                                                <div class="shift-block bg-green-500">早班 (8:00-16:00)</div>
                                                            </td>
                                                            <td class="border border-gray-200 p-1 calendar-day bg-gray-100" data-date="2025-07-06">
                                                                <div class="text-xs text-gray-500 mb-1">6</div>
                                                                <div class="text-xs text-gray-400">休息日</div>
                                                            </td>
                                                            <td class="border border-gray-200 p-1 calendar-day bg-gray-100" data-date="2025-07-07">
                                                                <div class="text-xs text-gray-500 mb-1">7</div>
                                                                <div class="text-xs text-gray-400">休息日</div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td class="border border-gray-200 p-2 text-sm text-gray-500">周2</td>
                                                            <td class="border border-gray-200 p-1 calendar-day" data-date="2025-07-08">
                                                                <div class="text-xs text-gray-500 mb-1">8</div>
                                                                <div class="shift-block bg-green-500">早班 (8:00-16:00)</div>
                                                                <div class="shift-block bg-blue-500">晚班 (16:00-24:00)</div>
                                                            </td>
                                                            <td class="border border-gray-200 p-1 calendar-day" data-date="2025-07-09">
                                                                <div class="text-xs text-gray-500 mb-1">9</div>
                                                                <div class="shift-block bg-green-500">早班 (8:00-16:00)</div>
                                                                <div class="shift-block bg-blue-500">晚班 (16:00-24:00)</div>
                                                            </td>
                                                            <td class="border border-gray-200 p-1 calendar-day" data-date="2025-07-10">
                                                                <div class="text-xs text-gray-500 mb-1">10</div>
                                                                <div class="shift-block bg-green-500">早班 (8:00-16:00)</div>
                                                                <div class="shift-block bg-blue-500">晚班 (16:00-24:00)</div>
                                                            </td>
                                                            <td class="border border-gray-200 p-1 calendar-day" data-date="2025-07-11">
                                                                <div class="text-xs text-gray-500 mb-1">11</div>
                                                                <div class="shift-block bg-green-500">早班 (8:00-16:00)</div>
                                                                <div class="shift-block bg-blue-500">晚班 (16:00-24:00)</div>
                                                            </td>
                                                            <td class="border border-gray-200 p-1 calendar-day" data-date="2025-07-12">
                                                                <div class="text-xs text-gray-500 mb-1">12</div>
                                                                <div class="shift-block bg-green-500">早班 (8:00-16:00)</div>
                                                            </td>
                                                            <td class="border border-gray-200 p-1 calendar-day bg-gray-100" data-date="2025-07-13">
                                                                <div class="text-xs text-gray-500 mb-1">13</div>
                                                                <div class="text-xs text-gray-400">休息日</div>
                                                            </td>
                                                            <td class="border border-gray-200 p-1 calendar-day bg-gray-100" data-date="2025-07-14">
                                                                <div class="text-xs text-gray-500 mb-1">14</div>
                                                                <div class="text-xs text-gray-400">休息日</div>
                                                            </td>
                                                        </tr>
                                                        <!-- 更多日历行... -->
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 周度视图 -->
                                    <div id="week-view" class="calendar-view hidden">
                                        <div class="overflow-x-auto">
                                            <div class="min-w-[1200px]">
                                                <!-- 周次选择器 -->
                                                <div class="flex justify-between items-center mb-4">
                                                    <button id="prev-week" class="text-gray-500 hover:text-gray-700">
                                                        <i class="fa fa-chevron-left"></i>
                                                    </button>
                                                    <h4 id="current-week-display" class="text-lg font-medium">2025年第27周 (7月1日-7月7日)</h4>
                                                    <button id="next-week" class="text-gray-500 hover:text-gray-700">
                                                        <i class="fa fa-chevron-right"></i>
                                                    </button>
                                                </div>

                                                <!-- 周度产能分析 -->
                                                <div class="bg-white p-4 rounded-lg shadow mb-4">
                                                    <h5 class="font-medium mb-3">周度产能分析</h5>
                                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                                        <div class="bg-blue-50 p-3 rounded-lg">
                                                            <div class="text-sm font-medium text-gray-700">计划产能</div>
                                                            <div class="text-2xl font-bold text-blue-600">800 台</div>
                                                            <div class="text-xs text-gray-500 mt-1">较上周 +5%</div>
                                                        </div>
                                                        <div class="bg-green-50 p-3 rounded-lg">
                                                            <div class="text-sm font-medium text-gray-700">实际产能</div>
                                                            <div class="text-2xl font-bold text-green-600">780 台</div>
                                                            <div class="text-xs text-gray-500 mt-1">完成率 97.5%</div>
                                                        </div>
                                                        <div class="bg-yellow-50 p-3 rounded-lg">
                                                            <div class="text-sm font-medium text-gray-700">瓶颈资源</div>
                                                            <div class="text-2xl font-bold text-yellow-600">装配线2</div>
                                                            <div class="text-xs text-gray-500 mt-1">负荷率 110%</div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- 周度甘特图 -->
                                                <div class="bg-white p-4 rounded-lg shadow">
                                                    <h5 class="font-medium mb-3">周度生产任务甘特图</h5>
                                                    <div class="relative h-64 border-l border-gray-300">
                                                        <!-- 时间刻度 -->
                                                        <div class="absolute top-0 left-0 right-0 h-6 flex justify-between text-xs text-gray-500">
                                                            <div class="w-1/7 text-center">周一</div>
                                                            <div class="w-1/7 text-center">周二</div>
                                                            <div class="w-1/7 text-center">周三</div>
                                                            <div class="w-1/7 text-center">周四</div>
                                                            <div class="w-1/7 text-center">周五</div>
                                                            <div class="w-1/7 text-center">周六</div>
                                                            <div class="w-1/7 text-center">周日</div>
                                                        </div>
                                                        
                                                        <!-- 甘特图任务条 -->
                                                        <div class="absolute top-8 left-0 right-0 h-12 border-t border-gray-200">
                                                            <div class="gantt-task bg-blue-500" style="left: 0%; width: 71.4%;">
                                                                产品A (500台)
                                                            </div>
                                                        </div>
                                                        <div class="absolute top-24 left-0 right-0 h-12 border-t border-gray-200">
                                                            <div class="gantt-task bg-green-500" style="left: 28.6%; width: 57.1%;">
                                                                产品B (300台)
                                                            </div>
                                                        </div>
                                                        <div class="absolute top-40 left-0 right-0 h-12 border-t border-gray-200">
                                                            <div class="gantt-task bg-purple-500" style="left: 0%; width: 42.9%;">
                                                                产品C (200台)
                                                            </div>
                                                            <div class="gantt-task bg-orange-500" style="left: 57.1%; width: 14.3%;">
                                                                产品D (100台)
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 班次详情面板 (默认隐藏) -->
                        <div id="shift-detail-panel" class="fixed right-0 top-0 h-full w-96 bg-white shadow-lg transform translate-x-full transition-transform duration-300 z-20">
                            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-800">班次详情</h3>
                                <button id="close-shift-detail" class="text-gray-500 hover:text-gray-700">
                                    <i class="fa fa-times"></i>
                                </button>
                            </div>
                            <div class="p-6">
                                <div class="mb-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">日期</label>
                                    <p id="detail-date" class="text-sm text-gray-600">2025-07-01</p>
                                </div>
                                <div class="mb-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">班次</label>
                                    <select id="detail-shift" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                        <option value="morning">早班 (8:00-16:00)</option>
                                        <option value="afternoon">中班 (16:00-24:00)</option>
                                        <option value="night">晚班 (0:00-8:00)</option>
                                    </select>
                                </div>
                                <div class="mb-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">工作中心</label>
                                    <select id="detail-workcenter" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                        <option value="1">总装线1</option>
                                        <option value="2">总装线2</option>
                                        <option value="3">机加工线1</option>
                                        <option value="4">机加工线2</option>
                                    </select>
                                </div>
                                <div class="mb-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">可用人数</label>
                                    <input type="number" id="detail-workers" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" value="10">
                                </div>
                                <div class="mb-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">设备数量</label>
                                    <input type="number" id="detail-equipment" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" value="5">
                                </div>
                                <div class="mb-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">标准产能</label>
                                    <input type="number" id="detail-capacity" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" value="100">
                                </div>
                                <div class="mt-6 flex justify-end">
                                    <button id="save-shift-detail" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                        <i class="fa fa-save mr-1"></i> 保存
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- 初始化年度向导 (默认隐藏) -->
                        <div id="init-year-wizard" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
                            <div class="bg-white rounded-lg shadow w-full max-w-md">
                                <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                    <h3 class="text-lg font-medium text-gray-800">初始化年度</h3>
                                    <button id="close-init-wizard" class="text-gray-500 hover:text-gray-700">
                                        <i class="fa fa-times"></i>
                                    </button>
                                </div>
                                <div class="p-6">
                                    <div class="mb-4">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">选择年度</label>
                                        <select id="wizard-year" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                            <option value="2025">2025</option>
                                            <option value="2024">2024</option>
                                            <option value="2023">2023</option>
                                        </select>
                                    </div>
                                    <div class="mb-4">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">工作日设置</label>
                                        <div class="flex flex-wrap gap-2">
                                            <label class="inline-flex items-center">
                                                <input type="checkbox" class="form-checkbox text-blue-600" checked>
                                                <span class="ml-2 text-sm text-gray-700">周一</span>
                                            </label>
                                            <label class="inline-flex items-center">
                                                <input type="checkbox" class="form-checkbox text-blue-600" checked>
                                                <span class="ml-2 text-sm text-gray-700">周二</span>
                                            </label>
                                            <label class="inline-flex items-center">
                                                <input type="checkbox" class="form-checkbox text-blue-600" checked>
                                                <span class="ml-2 text-sm text-gray-700">周三</span>
                                            </label>
                                            <label class="inline-flex items-center">
                                                <input type="checkbox" class="form-checkbox text-blue-600" checked>
                                                <span class="ml-2 text-sm text-gray-700">周四</span>
                                            </label>
                                            <label class="inline-flex items-center">
                                                <input type="checkbox" class="form-checkbox text-blue-600" checked>
                                                <span class="ml-2 text-sm text-gray-700">周五</span>
                                            </label>
                                            <label class="inline-flex items-center">
                                                <input type="checkbox" class="form-checkbox text-blue-600">
                                                <span class="ml-2 text-sm text-gray-700">周六</span>
                                            </label>
                                            <label class="inline-flex items-center">
                                                <input type="checkbox" class="form-checkbox text-blue-600">
                                                <span class="ml-2 text-sm text-gray-700">周日</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="mb-4">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">班次模型</label>
                                        <select id="wizard-shift-model" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                            <option value="two-shift">两班制 (早班+晚班)</option>
                                            <option value="three-shift">三班制 (早班+中班+晚班)</option>
                                            <option value="one-shift">单班制 (早班)</option>
                                        </select>
                                    </div>
                                    <div class="mb-4">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">节假日设置</label>
                                        <div class="flex items-center">
                                            <input type="text" id="wizard-holidays" class="flex-1 border border-gray-300 rounded-l px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="例如: 2025-01-01,2025-02-17">
                                            <button class="px-3 py-2 bg-blue-600 text-white rounded-r hover:bg-blue-700 transition-all">
                                                <i class="fa fa-calendar"></i>
                                            </button>
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">格式: YYYY-MM-DD,多个日期用逗号分隔</p>
                                    </div>
                                    <div class="mt-6 flex justify-end">
                                        <button id="cancel-init-wizard" class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all mr-2">
                                            取消
                                        </button>
                                        <button id="confirm-init-wizard" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                            确认
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 02 获取订单 -->
                    <div id="activity-02" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">02 订单同步管理</h3>
                                <p class="text-sm text-gray-500 mt-1">计划集成控制台、同步与快照页</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>接口同步：调用接口获取总装APS/SAP中状态为Locked的需求工单</li>
                                        <li>快照管理：生成同步批次版本快照，记录同步时间戳</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">总装接口数据</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">原始需求池、同步快照</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 需求同步控制台 -->
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">需求同步控制台</h3>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <div class="flex flex-wrap gap-4">
                                        <div class="w-full md:w-auto">
                                            <label class="block text-sm font-medium text-gray-700 mb-1">同步源</label>
                                            <select id="sync-source" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="aps">总装APS</option>
                                                <option value="sap">SAP</option>
                                            </select>
                                        </div>
                                        <div class="w-full md:w-auto md:ml-auto self-end">
                                            <button id="execute-sync" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                                <i class="fa fa-refresh mr-1"></i> 执行同步
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- 同步历史列表 -->
                                <div class="bg-white shadow overflow-hidden rounded-lg">
                                    <table class="min-w-full divide-y divide-gray-200">
                                        <thead class="bg-gray-50">
                                            <tr>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">快照ID</th>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">同步时间</th>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">同步源</th>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">工单数</th>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                            </tr>
                                        </thead>
                                        <tbody class="bg-white divide-y divide-gray-200">
                                            <tr>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">SNAP-20250721-001</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-21 09:15:32</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">总装APS</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">128</td>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                        Success
                                                    </span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                    <a href="#" class="text-blue-600 hover:text-blue-900 mr-4">查看明细</a>
                                                    <a href="#" class="text-blue-600 hover:text-blue-900">导出</a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">SNAP-20250720-001</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-20 14:30:21</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">SAP</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">86</td>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                        Success
                                                    </span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                    <a href="#" class="text-blue-600 hover:text-blue-900 mr-4">查看明细</a>
                                                    <a href="#" class="text-blue-600 hover:text-blue-900">导出</a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">SNAP-20250719-001</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-19 10:45:12</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">总装APS</td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">0</td>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                                        Fail
                                                    </span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                    <a href="#" class="text-blue-600 hover:text-blue-900 mr-4">查看日志</a>
                                                    <a href="#" class="text-gray-400 cursor-not-allowed">导出</a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- 同步进度弹窗 (默认隐藏) -->
                        <div id="sync-progress-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
                            <div class="bg-white rounded-lg shadow w-full max-w-md">
                                <div class="p-6 border-b border-gray-200">
                                    <h3 class="text-lg font-medium text-gray-800">正在同步数据</h3>
                                </div>
                                <div class="p-6">
                                    <div class="mb-4">
                                        <div class="flex justify-between mb-1">
                                            <span class="text-sm font-medium text-gray-700">进度</span>
                                            <span id="sync-progress-text" class="text-sm font-medium text-gray-700">0%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div id="sync-progress-bar" class="bg-blue-600 h-2 rounded-full" style="width: 0%"></div>
                                        </div>
                                    </div>
                                    <p id="sync-status-text" class="text-sm text-gray-600">正在连接数据源...</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 03 编制滚动计划 -->
                    <div id="activity-03" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">03 滚动计划编制</h3>
                                <p class="text-sm text-gray-500 mt-1">中长期规划、滚动负荷分析页</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>滚动计划导入：解析Excel格式中长期预测数据并结构化存储</li>
                                        <li>粗能力计算：对比预测负荷与产线额定产能，计算负荷百分比输出趋势数据</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">Excel预测数据</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">负荷预警图、负荷分析表</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 滚动负荷分析页面 -->
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-800">滚动负荷分析</h3>
                                <div class="flex space-x-2">
                                    <button id="import-forecast-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                        <i class="fa fa-upload mr-1"></i> 导入
                                    </button>
                                    <button id="export-report-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all">
                                        <i class="fa fa-download mr-1"></i> 导出报告
                                    </button>
                                </div>
                            </div>
                            <div class="p-6">
                                <!-- 上传区域 -->
                                <div class="mb-6 border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                                    <input type="file" id="forecast-file" class="hidden" accept=".xlsx">
                                    <label for="forecast-file" class="cursor-pointer">
                                        <div class="mb-2">
                                            <i class="fa fa-file-excel-o text-4xl text-gray-400"></i>
                                        </div>
                                        <p class="text-sm font-medium text-gray-700">点击上传Excel预测数据</p>
                                        <p class="text-xs text-gray-500 mt-1">支持 .xlsx 格式文件</p>
                                    </label>
                                </div>

                                <!-- 图表区域 -->
                                <div class="mb-6">
                                    <div class="flex justify-between items-center mb-4">
                                        <h4 class="text-md font-medium text-gray-700">负荷趋势图</h4>
                                        <div class="flex space-x-2">
                                            <select id="chart-period" class="border border-gray-300 rounded px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="month">月视图</option>
                                                <option value="week" selected>周视图</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="bg-white border border-gray-200 rounded-lg p-4 h-80">
                                        <canvas id="loadTrendChart"></canvas>
                                    </div>
                                </div>

                                <!-- 负荷分析表 -->
                                <div class="border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="bg-gray-50 p-4 border-b border-gray-200">
                                        <h4 class="text-md font-medium text-gray-700">负荷分析表</h4>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">时间段</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">产线</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">预测负荷(工时)</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">额定产能(工时)</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">负荷率</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2025-07-21 至 2025-07-27</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">总装线1</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">950</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">1000</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">95%</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            正常
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2025-07-21 至 2025-07-27</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">总装线2</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">1050</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">1000</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">105%</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                            预警
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2025-07-21 至 2025-07-27</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">机加工线1</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">1150</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">1000</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">115%</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                                            超载
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2025-07-28 至 2025-08-03</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">总装线1</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">900</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">1000</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">90%</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            正常
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2025-07-28 至 2025-08-03</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">总装线2</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">950</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">1000</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">95%</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            正常
                                                        </span>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                 <!-- 04 编制主计划 -->
<div id="activity-04" class="activity-section hidden">
    <div class="bg-white rounded-lg shadow mb-6">
        <div class="p-6 border-b border-gray-200">
            <h3 class="text-lg font-medium text-gray-800">04 主计划编制</h3>
            <p class="text-sm text-gray-500 mt-1">战略计划控制台、储备策略配置与主计划生成</p>
        </div>
        <div class="p-6">
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                <ul class="list-disc pl-5 text-sm text-gray-600">
                    <li>储备策略配置：配置滚动拉动模式参数，或录入运营重点储备机型（白名单）</li>
                    <li>主计划合成：自动合并总装正式订单与战略储备需求，标识需求来源类型</li>
                    <li>清洗与异常：集成ETL分流规则，处理内销/出口字段缺失等异常</li>
                </ul>
            </div>
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-gray-50 p-4 rounded">
                        <p class="text-sm font-medium text-gray-700">输入</p>
                        <p class="text-sm text-gray-600">总装订单、运营储备需求、滚动预测</p>
                    </div>
                    <div class="bg-gray-50 p-4 rounded">
                        <p class="text-sm font-medium text-gray-700">输出</p>
                        <p class="text-sm text-gray-600">合成后的主计划池 (含储备标记)</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 战略主计划编制控制台 -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
        <!-- 分区一：滚动拉动策略配置 -->
        <div class="bg-white rounded-lg shadow lg:col-span-1">
            <div class="p-4 border-b border-gray-200 flex justify-between items-center bg-blue-50 rounded-t-lg">
                <h3 class="text-md font-medium text-blue-800"><i class="fa fa-cogs mr-2"></i>滚动拉动模式</h3>
                <label class="relative inline-flex items-center cursor-pointer">
                    <input type="checkbox" id="rolling-mode-switch" class="sr-only peer" checked>
                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                </label>
            </div>
            <div class="p-6 space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">触发阈值 (总装订单量)</label>
                    <div class="relative">
                        <input type="number" id="rolling-threshold" class="block w-full pl-3 pr-12 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 sm:text-sm" value="5">
                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">万</span>
                        </div>
                    </div>
                    <p class="text-xs text-gray-500 mt-1">当总订单 > 此值时触发拉动</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">提前期 (Lead Time)</label>
                    <div class="relative">
                        <input type="number" id="rolling-lead-time" class="block w-full pl-3 pr-12 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 sm:text-sm" value="15">
                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">天</span>
                        </div>
                    </div>
                    <p class="text-xs text-gray-500 mt-1">将预测计划提前 N 天转生产</p>
                </div>
            </div>
        </div>

        <!-- 分区一：运营主动干预 (White List) -->
        <div class="bg-white rounded-lg shadow lg:col-span-2">
            <div class="p-4 border-b border-gray-200 flex justify-between items-center bg-purple-50 rounded-t-lg">
                <h3 class="text-md font-medium text-purple-800"><i class="fa fa-edit mr-2"></i>运营储备录入 (White List)</h3>
                <span class="text-xs text-purple-600 bg-purple-100 px-2 py-1 rounded">独立需求源</span>
            </div>
            <div class="p-6">
                <!-- 录入表单 -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4 items-end">
                    <div class="md:col-span-1">
                        <label class="block text-xs font-medium text-gray-700 mb-1">储备机型/物料</label>
                        <input type="text" id="ops-material" class="w-full border border-gray-300 rounded px-3 py-2 text-sm" placeholder="如: COMP-X001">
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-700 mb-1">数量</label>
                        <input type="number" id="ops-qty" class="w-full border border-gray-300 rounded px-3 py-2 text-sm" placeholder="0">
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-700 mb-1">截止日期 <span class="text-red-500">*</span></label>
                        <input type="date" id="ops-deadline" class="w-full border border-gray-300 rounded px-3 py-2 text-sm">
                    </div>
                    <div>
                        <button id="add-ops-demand-btn" class="w-full px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition-all text-sm">
                            <i class="fa fa-plus mr-1"></i> 添加需求
                        </button>
                    </div>
                </div>
                
                <!-- 简易列表 -->
                <div class="bg-gray-50 rounded border border-gray-200 h-32 overflow-y-auto p-2">
                    <table class="min-w-full text-xs" id="ops-list-table">
                        <thead>
                            <tr class="text-left text-gray-500 border-b border-gray-200">
                                <th class="pb-1">物料</th>
                                <th class="pb-1">数量</th>
                                <th class="pb-1">截止日期</th>
                                <th class="pb-1">操作</th>
                            </tr>
                        </thead>
                        <tbody class="text-gray-700">
                            <tr>
                                <td class="py-1">COMP-SPEC-A</td>
                                <td>500</td>
                                <td>2025-08-01</td>
                                <td><a href="#" class="text-red-600">删除</a></td>
                            </tr>
                            <tr>
                                <td class="py-1">COMP-SPEC-B</td>
                                <td>1,200</td>
                                <td>2025-08-15</td>
                                <td><a href="#" class="text-red-600">删除</a></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- 分区二：主计划合成区 -->
    <div class="bg-white rounded-lg shadow">
        <div class="p-6 border-b border-gray-200 flex justify-between items-center">
            <h3 class="text-lg font-medium text-gray-800">主计划合成池</h3>
            <div class="flex space-x-3">
                <button id="open-etl-modal-btn" class="px-4 py-2 bg-yellow-50 text-yellow-700 border border-yellow-200 rounded hover:bg-yellow-100 transition-all flex items-center">
                    <i class="fa fa-filter mr-2"></i> 异常清洗
                    <span class="ml-2 bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full">3</span>
                </button>
                <button id="generate-master-plan-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all shadow-sm">
                    <i class="fa fa-magic mr-2"></i> 应用策略并生成
                </button>
            </div>
        </div>
        <div class="p-6">
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">来源</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">计划单号</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料编码</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数量</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">截止日期</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">储备策略标签</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200" id="master-plan-tbody">
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">总装订单</span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MP-202507-001</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">COMP-100A</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium">5,000</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-28</td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="text-xs text-gray-500 border border-gray-300 px-2 py-1 rounded">Follow_Assy</span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="text-green-600"><i class="fa fa-check-circle"></i> 正常</span>
                            </td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-purple-100 text-purple-800">运营储备</span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">STR-202507-002</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">COMP-SPEC-A</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium">500</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-08-01</td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="text-xs text-purple-700 bg-purple-50 border border-purple-200 px-2 py-1 rounded">Type=Strategic</span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="text-green-600"><i class="fa fa-check-circle"></i> 正常</span>
                            </td>
                        </tr>
                        <!-- 更多模拟数据 -->
                    </tbody>
                </table>
            </div>
            <div class="mt-4 flex justify-end">
                 <span class="text-sm text-gray-500 mr-4 self-center">共 45 条计划记录，其中战略储备 12 条</span>
                 <button class="px-4 py-2 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                    导出 Excel
                </button>
            </div>
        </div>
    </div>

    <!-- ETL异常处理弹窗 (默认隐藏) -->
    <div id="etl-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
        <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white">
            <div class="flex justify-between items-center pb-3 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">ETL 异常数据修正</h3>
                <button id="close-etl-modal-btn" class="text-gray-400 hover:text-gray-500">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            <div class="py-4">
                <!-- 复用原本的异常列表逻辑 -->
                <div class="bg-yellow-50 p-3 rounded mb-4 text-sm text-yellow-800 border border-yellow-200">
                    <i class="fa fa-exclamation-triangle mr-2"></i> 发现 3 条数据缺失关键字段，无法进入主计划池，请修正。
                </div>
                <table class="min-w-full text-sm">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-4 py-2 text-left">原始ID</th>
                            <th class="px-4 py-2 text-left">异常原因</th>
                            <th class="px-4 py-2 text-left">修正操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="border-b">
                            <td class="px-4 py-3">ORD-ERR-001</td>
                            <td class="text-red-600">内销单缺失 Batch</td>
                            <td>
                                <input type="text" class="border rounded px-2 py-1 text-xs w-32" placeholder="补录Batch">
                                <button class="ml-2 text-blue-600 text-xs">保存</button>
                            </td>
                        </tr>
                        <tr class="border-b">
                            <td class="px-4 py-3">ORD-ERR-002</td>
                            <td class="text-red-600">Mat_Code 格式错误</td>
                            <td>
                                <input type="text" class="border rounded px-2 py-1 text-xs w-32" value="ERR-CODE">
                                <button class="ml-2 text-blue-600 text-xs">保存</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="flex justify-end pt-3">
                <button id="close-etl-modal-bottom-btn" class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 text-sm">关闭</button>
            </div>
        </div>
    </div>
</div>
      
                    <!-- 05 研发 -->
                    <div id="activity-05" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">05 研发协同管理</h3>
                                <p class="text-sm text-gray-500 mt-1">协同门户、试制任务申请页</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>试制提单：录入试制任务信息，校验必填排产特征，支持图纸附件上传</li>
                                        <li>申请单流转：管理研发提交、计划审核的任务流转状态</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">研发输入的排产特征、附件</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">试制申请单（状态Pending）</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 试制申请单页面 -->
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">试制申请单</h3>
                            </div>
                            <div class="p-6">
                                <form id="trial-application-form">
                                    <!-- 基本信息 -->
                                    <div class="mb-6">
                                        <h4 class="text-md font-medium text-gray-700 mb-4">基本信息</h4>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">联络书号 <span class="text-red-500">*</span></label>
                                                <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入联络书号" required>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">需求日期 <span class="text-red-500">*</span></label>
                                                <input type="date" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">产品名称 <span class="text-red-500">*</span></label>
                                                <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入产品名称" required>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">试制数量 <span class="text-red-500">*</span></label>
                                                <input type="number" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入试制数量" required>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 排产特征 -->
                                    <div class="mb-6">
                                        <h4 class="text-md font-medium text-gray-700 mb-4">排产特征 <span class="text-red-500">*</span></h4>
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">翅片类型</label>
                                                <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                                    <option value="">请选择</option>
                                                    <option value="type1">类型1</option>
                                                    <option value="type2">类型2</option>
                                                    <option value="type3">类型3</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">排数</label>
                                                <input type="number" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入排数" required>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">孔数</label>
                                                <input type="number" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入孔数" required>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 附件上传 -->
                                    <div class="mb-6">
                                        <h4 class="text-md font-medium text-gray-700 mb-4">附件上传</h4>
                                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                                            <input type="file" id="attachment-upload" class="hidden" multiple accept=".pdf,.jpg,.jpeg,.png,.dwg">
                                            <label for="attachment-upload" class="cursor-pointer">
                                                <div class="mb-2">
                                                    <i class="fa fa-cloud-upload text-4xl text-gray-400"></i>
                                                </div>
                                                <p class="text-sm font-medium text-gray-700">点击上传图纸或相关文件</p>
                                                <p class="text-xs text-gray-500 mt-1">支持 PDF、JPG、PNG、DWG 格式，最多 5 个文件</p>
                                            </label>
                                        </div>
                                        <div class="mt-4">
                                            <div class="flex items-center justify-between p-2 bg-gray-50 rounded">
                                                <div class="flex items-center">
                                                    <i class="fa fa-file-pdf-o text-red-500 mr-2"></i>
                                                    <span class="text-sm text-gray-700">产品图纸.pdf</span>
                                                </div>
                                                <div class="flex items-center">
                                                    <span class="text-xs text-gray-500 mr-2">2.5MB</span>
                                                    <button class="text-red-500 hover:text-red-700">
                                                        <i class="fa fa-times"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 备注 -->
                                    <div class="mb-6">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">备注</label>
                                        <textarea class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" rows="3" placeholder="请输入备注信息"></textarea>
                                    </div>

                                    <!-- 操作按钮 -->
                                    <div class="flex justify-end space-x-3">
                                        <button type="reset" class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all">
                                            重置
                                        </button>
                                        <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                            提交申请
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- 06 其他工厂 -->
                    <div id="activity-06" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">06 工厂调拨管理</h3>
                                <p class="text-sm text-gray-500 mt-1">计划集成控制台、游离单据抓取页</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>凭证抓取：按配置凭证类型，通过接口扫描SAP中的调拨单（ZOR）及预留单（RES）</li>
                                        <li>增量更新：基于时间戳仅抓取新增或变更的单据</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">SAP ZOR/RES接口数据</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">调拨单、预留单</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 游离单据管理页面 -->
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-800">游离单据管理</h3>
                                <div class="flex space-x-2">
                                    <button id="manual-fetch-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                        <i class="fa fa-refresh mr-1"></i> 手动抓取
                                    </button>
                                    <button id="refresh-list-btn" class="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-all">
                                        <i class="fa fa-list mr-1"></i> 刷新列表
                                    </button>
                                </div>
                            </div>
                            <div class="p-6">
                                <!-- Tab标签 -->
                                <div class="mb-6 border-b border-gray-200">
                                    <ul class="flex flex-wrap -mb-px">
                                        <li class="mr-2">
                                            <a href="#" class="inline-block p-4 border-b-2 border-blue-500 text-blue-500 rounded-t-lg active">
                                                调拨单
                                            </a>
                                        </li>
                                        <li class="mr-2">
                                            <a href="#" class="inline-block p-4 border-b-2 border-transparent hover:text-gray-600 hover:border-gray-300 rounded-t-lg">
                                                预留单
                                            </a>
                                        </li>
                                    </ul>
                                </div>

                                <!-- 调拨单列表 -->
                                <div class="border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                        <h4 class="text-md font-medium text-gray-700">调拨单列表</h4>
                                        <div class="flex items-center">
                                            <span class="text-sm text-gray-500 mr-2">共 8 条记录</span>
                                            <div class="relative">
                                                <input type="text" placeholder="搜索SAP单号..." class="pl-10 pr-4 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <i class="fa fa-search absolute left-3 top-2 text-gray-400"></i>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">SAP单号</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数量</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">需求日</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">来源工厂</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">目标工厂</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MES状态</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">ZOR-202507-001</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">COMP-100A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">50</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-25</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">工厂A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">工厂B</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            已确认
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看</a>
                                                        <a href="#" class="text-blue-600 hover:text-blue-900">导出</a>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">ZOR-202507-002</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">COMP-200B</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">30</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-28</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">工厂C</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">工厂B</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                            待确认
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看</a>
                                                        <a href="#" class="text-blue-600 hover:text-blue-900">导出</a>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">ZOR-202507-003</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">COMP-300C</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">20</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-08-01</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">工厂A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">工厂C</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            已确认
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看</a>
                                                        <a href="#" class="text-blue-600 hover:text-blue-900">导出</a>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200">
                                        <div class="text-sm text-gray-700">
                                            显示 <span class="font-medium">1</span> 到 <span class="font-medium">3</span> 条，共 <span class="font-medium">8</span> 条
                                        </div>
                                        <div class="flex space-x-2">
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 disabled:opacity-50" disabled>
                                                上一页
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm bg-blue-50 text-blue-600">
                                                1
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                2
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                3
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                下一页
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 07 接收生产订单 -->
                    <div id="activity-07" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">07 生产订单接收</h3>
                                <p class="text-sm text-gray-500 mt-1">需求管理中心、全量需求大厅</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>订单全集视图：汇聚总装、试制、调拨等多源订单，统一展示订单属性</li>
                                        <li>状态监控：标记并更新订单生命周期状态（待清洗/待排产/已锁定）</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">各来源订单数据</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">统一需求池</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 需求管理大厅页面 -->
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-800">需求管理大厅</h3>
                                <div class="flex space-x-2">
                                    <button id="export-excel-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all">
                                        <i class="fa fa-file-excel-o mr-1"></i> 导出Excel
                                    </button>
                                    <button id="batch-lock-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                        <i class="fa fa-lock mr-1"></i> 批量锁定
                                    </button>
                                </div>
                            </div>
                            <div class="p-6">
                                <!-- 搜索栏 -->
                                <div class="mb-6 bg-gray-50 p-4 rounded-lg">
                                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">订单号</label>
                                            <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入订单号">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">物料</label>
                                            <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入物料编码或名称">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">来源</label>
                                            <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="">全部来源</option>
                                                <option value="aps">总装APS</option>
                                                <option value="sap">SAP</option>
                                                <option value="rd">研发试制</option>
                                                <option value="transfer">调拨单</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">状态</label>
                                            <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="">全部状态</option>
                                                <option value="pending">待清洗</option>
                                                <option value="ready">待排产</option>
                                                <option value="locked">已锁定</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mt-4 flex justify-end">
                                        <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all mr-2">
                                            重置
                                        </button>
                                        <button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                            搜索
                                        </button>
                                    </div>
                                </div>

                                <!-- 订单列表 -->
                                <div class="border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                        <h4 class="text-md font-medium text-gray-700">订单列表</h4>
                                        <div class="flex items-center">
                                            <span class="text-sm text-gray-500 mr-2">共 24 条记录</span>
                                        </div>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                        <input type="checkbox" class="form-checkbox text-blue-600">
                                                    </th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">来源</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">单号</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数量</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">日期</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">工艺</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">缺料</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MES状态</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <input type="checkbox" class="form-checkbox text-blue-600">
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">总装APS</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">APS-202507-001</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">COMP-100A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">50</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-25</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            已锁定
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <i class="fa fa-check-circle text-green-500"></i>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <i class="fa fa-exclamation-circle text-red-500"></i>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">详情</a>
                                                        <a href="#" class="text-blue-600 hover:text-blue-900">锁定</a>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <input type="checkbox" class="form-checkbox text-blue-600">
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">SAP</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">SAP-202507-002</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">COMP-200B</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">30</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-28</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                            待排产
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <i class="fa fa-check-circle text-green-500"></i>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <i class="fa fa-check-circle text-green-500"></i>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">详情</a>
                                                        <a href="#" class="text-blue-600 hover:text-blue-900">锁定</a>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <input type="checkbox" class="form-checkbox text-blue-600">
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">研发试制</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">RD-202507-003</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">COMP-300C</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">5</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-08-01</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                                            待清洗
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <i class="fa fa-exclamation-circle text-red-500"></i>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <i class="fa fa-check-circle text-green-500"></i>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">详情</a>
                                                        <a href="#" class="text-gray-400 cursor-not-allowed">锁定</a>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <input type="checkbox" class="form-checkbox text-blue-600">
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">调拨单</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">ZOR-202507-001</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">COMP-100A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">50</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-25</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                            待排产
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <i class="fa fa-check-circle text-green-500"></i>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <i class="fa fa-check-circle text-green-500"></i>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">详情</a>
                                                        <a href="#" class="text-blue-600 hover:text-blue-900">锁定</a>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200">
                                        <div class="text-sm text-gray-700">
                                            显示 <span class="font-medium">1</span> 到 <span class="font-medium">4</span> 条，共 <span class="font-medium">24</span> 条
                                        </div>
                                        <div class="flex space-x-2">
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 disabled:opacity-50" disabled>
                                                上一页
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm bg-blue-50 text-blue-600">
                                                1
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                2
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                3
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                4
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                5
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                6
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                下一页
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 08 备件计划 -->
                    <div id="activity-08" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">08 备件需求计划</h3>
                                <p class="text-sm text-gray-500 mt-1">备件管理中心、计划管理页</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>同步计划：从销售系统同步备件订单数据</li>
                                        <li>创建计划：基于同步数据创建备件生产计划</li>
                                        <li>结构化解析：执行父件（销售组件）转子件（生产零件）的解析逻辑</li>
                                        <li>映射匹配：优先调用SAP接口匹配，失败检索本地知识库，支持人工建立映射</li>
                                        <li>智能匹配：优先调SAP接口，失败则查历史记录</li>
                                        <li>人工保存：手工选择关系后，勾选"保存至知识库"，下次自动匹配</li>
                                        <li>下发生产：将已确认的备件计划下发到生产订单系统</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">销售系统备件订单、SAP BOM数据</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">备件生产计划、生产子项、子件需求、私有BOM映射表</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 备件计划管理页面 -->
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-800">备件计划管理</h3>
                                <div class="flex space-x-2">
                                    <button id="create-spare-part-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                        <i class="fa fa-plus mr-1"></i> 创建计划
                                    </button>
                                    <button id="sync-from-sap-btn" class="px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition-all">
                                        <i class="fa fa-refresh mr-1"></i> SAP同步
                                    </button>
                                    <button id="export-spare-part-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all">
                                        <i class="fa fa-download mr-1"></i> 导出
                                    </button>
                                </div>
                            </div>
                            <div class="p-6">
                                <!-- 搜索栏 -->
                                <div class="mb-6 bg-gray-50 p-4 rounded-lg">
                                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">计划编号</label>
                                            <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入计划编号">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">物料</label>
                                            <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入物料编码或名称">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">适用设备</label>
                                            <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="">全部设备</option>
                                                <option value="equipment1">设备1</option>
                                                <option value="equipment2">设备2</option>
                                                <option value="equipment3">设备3</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">计划日期</label>
                                            <input type="date" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                        </div>
                                    </div>
                                    <div class="mt-4 flex justify-end">
                                        <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all mr-2">
                                            重置
                                        </button>
                                        <button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                            搜索
                                        </button>
                                    </div>
                                </div>

                                <!-- 备件计划列表 -->
                                <div class="border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                        <h4 class="text-md font-medium text-gray-700">备件计划列表</h4>
                                        <div class="flex items-center">
                                            <span class="text-sm text-gray-500 mr-2">共 15 条记录</span>
                                        </div>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                        <input type="checkbox" id="select-all-plans" class="h-4 w-4 text-blue-600 rounded">
                                                    </th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">计划编号</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料描述</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">适用设备</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">计划数量</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">计划日期</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">创建人</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">BOM状态</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <tr class="hover:bg-blue-50">
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <input type="checkbox" class="plan-checkbox h-4 w-4 text-blue-600 rounded" value="SP-202507-001">
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">SP-202507-001</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">SP-100A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">手工焊号组件A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">设备1</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">10</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-25</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">张三</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            已审核
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                            待映射
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <button class="text-blue-600 hover:text-blue-900 mr-2 map-bom-btn" data-id="SP-202507-001">
                                                            <i class="fa fa-link mr-1"></i> BOM映射
                                                        </button>
                                                        <button class="text-green-600 hover:text-green-900 issue-to-production-btn" data-id="SP-202507-001">
                                                            <i class="fa fa-paper-plane mr-1"></i> 下发生产
                                                        </button>
                                                    </td>
                                                </tr>
                                                <tr class="hover:bg-blue-50">
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <input type="checkbox" class="plan-checkbox h-4 w-4 text-blue-600 rounded" value="SP-202507-002">
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">SP-202507-002</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">SP-200B</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">手工焊号组件B</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">设备2</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">5</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-28</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">李四</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            已审核
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            已映射
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <button class="text-blue-600 hover:text-blue-900 mr-2 map-bom-btn" data-id="SP-202507-002">
                                                            <i class="fa fa-link mr-1"></i> BOM映射
                                                        </button>
                                                        <button class="text-green-600 hover:text-green-900 issue-to-production-btn" data-id="SP-202507-002">
                                                            <i class="fa fa-paper-plane mr-1"></i> 下发生产
                                                        </button>
                                                    </td>
                                                </tr>
                                                <tr class="hover:bg-blue-50">
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <input type="checkbox" class="plan-checkbox h-4 w-4 text-blue-600 rounded" value="SP-202507-003">
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">SP-202507-003</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">SP-300C</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">手工焊号组件C</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">设备3</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">20</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-08-01</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">王五</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                            待审核
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                            待映射
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <button class="text-blue-600 hover:text-blue-900 mr-2 map-bom-btn" data-id="SP-202507-003">
                                                            <i class="fa fa-link mr-1"></i> BOM映射
                                                        </button>
                                                        <button class="text-gray-400 cursor-not-allowed" disabled>
                                                            <i class="fa fa-paper-plane mr-1"></i> 下发生产
                                                        </button>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200">
                                        <div class="text-sm text-gray-700">
                                            显示 <span class="font-medium">1</span> 到 <span class="font-medium">3</span> 条，共 <span class="font-medium">15</span> 条
                                        </div>
                                        <div class="flex space-x-2">
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 disabled:opacity-50" disabled>
                                                上一页
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm bg-blue-50 text-blue-600">
                                                1
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                2
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                3
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                4
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                5
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                下一页
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- 批量操作按钮 -->
                                <div class="mt-4 flex justify-end">
                                    <button id="batch-issue-to-production-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all disabled:bg-gray-300 disabled:cursor-not-allowed" disabled>
                                        <i class="fa fa-paper-plane mr-1"></i> 批量下发生产订单
                                    </button>
                                </div>

                        </div>
                    </div>

                    <!-- BOM映射弹窗 -->
                    <div id="bom-mapping-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
                        <div class="bg-white rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] overflow-hidden">
                            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-800">备件BOM映射</h3>
                                <button id="close-bom-mapping-modal" class="text-gray-500 hover:text-gray-700">
                                    <i class="fa fa-times text-xl"></i>
                                </button>
                            </div>
                            <div class="p-6 overflow-y-auto max-h-[calc(90vh-120px)]">
                                <div class="mb-4">
                                    <div class="bg-blue-50 p-4 rounded-lg">
                                        <h4 class="text-sm font-medium text-gray-700 mb-2">当前备件计划</h4>
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                            <div>
                                                <p class="text-xs text-gray-500">计划编号</p>
                                                <p class="text-sm font-medium text-gray-900" id="modal-plan-id">SP-202507-001</p>
                                            </div>
                                            <div>
                                                <p class="text-xs text-gray-500">物料编码</p>
                                                <p class="text-sm font-medium text-gray-900" id="modal-material-code">SP-100A</p>
                                            </div>
                                            <div>
                                                <p class="text-xs text-gray-500">物料描述</p>
                                                <p class="text-sm font-medium text-gray-900" id="modal-material-name">手工焊号组件A</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- BOM映射Split Panel -->
                                <div class="flex flex-col md:flex-row gap-6">
                                    <!-- 左侧：未匹配父件列表 -->
                                    <div class="w-full md:w-1/2 border border-gray-200 rounded-lg overflow-hidden">
                                        <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                            <h4 class="text-md font-medium text-gray-700">未匹配父件列表</h4>
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-500 mr-2">共 <span id="modal-unmapped-count">5</span> 条记录</span>
                                            </div>
                                        </div>
                                        <div class="overflow-y-auto max-h-[300px]">
                                            <table class="min-w-full divide-y divide-gray-200">
                                                <thead class="bg-gray-50 sticky top-0">
                                                    <tr>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                            <input type="checkbox" id="modal-select-all-parents" class="h-4 w-4 text-blue-600 rounded">
                                                        </th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">父件编码</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">父件名称</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数量</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="bg-white divide-y divide-gray-200 modal-parent-items">
                                                    <tr class="hover:bg-blue-50 cursor-pointer modal-parent-item" data-id="P001">
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <input type="checkbox" class="modal-parent-checkbox h-4 w-4 text-blue-600 rounded" value="P001">
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">P001</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">手工焊号组件A</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">10</td>
                                                    </tr>
                                                    <tr class="hover:bg-blue-50 cursor-pointer modal-parent-item" data-id="P002">
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <input type="checkbox" class="modal-parent-checkbox h-4 w-4 text-blue-600 rounded" value="P002">
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">P002</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">手工焊号组件B</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">5</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <!-- 右侧：子件选择器 -->
                                    <div class="w-full md:w-1/2 border border-gray-200 rounded-lg overflow-hidden">
                                        <div class="bg-gray-50 p-4 border-b border-gray-200">
                                            <h4 class="text-md font-medium text-gray-700">子件选择器</h4>
                                        </div>
                                        <div class="p-6">
                                            <div id="modal-no-selection-message" class="text-center py-12">
                                                <i class="fa fa-arrow-left text-gray-400 text-4xl mb-4"></i>
                                                <p class="text-gray-500">请从左侧选择一个父件进行映射</p>
                                            </div>
                                            
                                            <div id="modal-child-selection-panel" class="hidden">
                                                <div class="mb-6">
                                                    <h5 class="text-sm font-medium text-gray-700 mb-2">已选父件</h5>
                                                    <div class="bg-blue-50 p-4 rounded-lg">
                                                        <div class="flex justify-between items-center">
                                                            <div>
                                                                <p class="text-sm font-medium text-gray-900"><span id="modal-selected-parent-id">P001</span> - <span id="modal-selected-parent-name">手工焊号组件A</span></p>
                                                                <p class="text-sm text-gray-600">数量: <span id="modal-selected-parent-qty">10</span></p>
                                                            </div>
                                                            <button id="modal-clear-selection-btn" class="text-sm text-red-600 hover:text-red-800">
                                                                <i class="fa fa-times mr-1"></i> 清除选择
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="mb-6">
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">搜索子件</label>
                                                    <div class="relative">
                                                        <input type="text" id="modal-child-search" class="w-full border border-gray-300 rounded px-3 py-2 pl-10 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="输入子件编码或名称搜索...">
                                                        <i class="fa fa-search absolute left-3 top-3 text-gray-400"></i>
                                                    </div>
                                                </div>

                                                <div class="mb-6">
                                                    <h5 class="text-sm font-medium text-gray-700 mb-2">可选子件列表</h5>
                                                    <div class="border border-gray-300 rounded-lg max-h-[200px] overflow-y-auto">
                                                        <table class="min-w-full divide-y divide-gray-200">
                                                            <tbody class="bg-white divide-y divide-gray-200 modal-child-items">
                                                                <tr class="hover:bg-blue-50 cursor-pointer modal-child-item" data-id="C001">
                                                                    <td class="px-4 py-3 whitespace-nowrap">
                                                                        <input type="radio" name="modal-child-select" class="modal-child-radio h-4 w-4 text-blue-600" value="C001">
                                                                    </td>
                                                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">C001</td>
                                                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">冲床零件A</td>
                                                                </tr>
                                                                <tr class="hover:bg-blue-50 cursor-pointer modal-child-item" data-id="C002">
                                                                    <td class="px-4 py-3 whitespace-nowrap">
                                                                        <input type="radio" name="modal-child-select" class="modal-child-radio h-4 w-4 text-blue-600" value="C002">
                                                                    </td>
                                                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">C002</td>
                                                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">冲床零件B</td>
                                                                </tr>
                                                                <tr class="hover:bg-blue-50 cursor-pointer modal-child-item" data-id="C003">
                                                                    <td class="px-4 py-3 whitespace-nowrap">
                                                                        <input type="radio" name="modal-child-select" class="modal-child-radio h-4 w-4 text-blue-600" value="C003">
                                                                    </td>
                                                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">C003</td>
                                                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">自动焊号零件A</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>

                                                <div class="mb-6">
                                                    <div class="flex items-center">
                                                        <input type="checkbox" id="modal-save-to-knowledge" class="h-4 w-4 text-blue-600 rounded">
                                                        <label for="modal-save-to-knowledge" class="ml-2 text-sm text-gray-700">保存至知识库</label>
                                                    </div>
                                                    <p class="text-xs text-gray-500 mt-1">勾选后，此映射关系将保存到本地知识库，下次自动匹配</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- 已映射关系列表 -->
                                <div class="mt-8">
                                    <h4 class="text-md font-medium text-gray-700 mb-4">已映射关系列表</h4>
                                    <div class="border border-gray-200 rounded-lg overflow-hidden">
                                        <div class="overflow-x-auto">
                                            <table class="min-w-full divide-y divide-gray-200">
                                                <thead class="bg-gray-50">
                                                    <tr>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">父件编码</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">父件名称</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">子件编码</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">子件名称</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">映射来源</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">映射时间</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="bg-white divide-y divide-gray-200 modal-mapped-items">
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">P002</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">手工焊号组件B</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">C002</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">冲床零件B</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
                                                                知识库
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-19 14:15</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-6 flex justify-end">
                                <button id="modal-cancel-btn" class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all mr-2">
                                    取消
                                </button>
                                <button id="modal-confirm-mapping-btn" class="px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all disabled:bg-gray-300 disabled:cursor-not-allowed" disabled>
                                    <i class="fa fa-check mr-1"></i> 确认映射
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 创建备件计划弹窗 -->
                <div id="create-spare-part-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
                    <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl">
                        <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-lg font-medium text-gray-800">创建备件计划</h3>
                            <button id="close-create-spare-part-modal" class="text-gray-500 hover:text-gray-700">
                                <i class="fa fa-times text-xl"></i>
                            </button>
                        </div>
                        <div class="p-6">
                            <form id="create-spare-part-form">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">物料编码 <span class="text-red-500">*</span></label>
                                        <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">物料描述 <span class="text-red-500">*</span></label>
                                        <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">适用设备 <span class="text-red-500">*</span></label>
                                        <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                            <option value="">请选择设备</option>
                                            <option value="equipment1">设备1</option>
                                            <option value="equipment2">设备2</option>
                                            <option value="equipment3">设备3</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">计划数量 <span class="text-red-500">*</span></label>
                                        <input type="number" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="1" required>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">计划日期 <span class="text-red-500">*</span></label>
                                        <input type="date" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">计划类型</label>
                                        <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                            <option value="regular">常规</option>
                                            <option value="emergency">紧急</option>
                                            <option value="maintenance">维护</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="mt-6">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">备注</label>
                                    <textarea class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" rows="3"></textarea>
                                </div>
                                <div class="mt-6 flex justify-end">
                                    <button type="button" id="cancel-create-spare-part-btn" class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all mr-2">
                                        取消
                                    </button>
                                    <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                        <i class="fa fa-save mr-1"></i> 保存
                                    </button>
                                </div>
                            </form>
                        </div>
                            </div>
                        </div>
                    </div>

                   <!-- 25 机台与模具资源建模 (升级为: 资源能力配置中心) -->
<div id="activity-25" class="activity-section hidden">
    <div class="bg-white rounded-lg shadow mb-6">
        <div class="p-6 border-b border-gray-200">
            <h3 class="text-lg font-medium text-gray-800">25 资源能力配置中心</h3>
            <p class="text-sm text-gray-500 mt-1">基础数据管理、机台与模具资源建模</p>
        </div>
        <div class="p-6">
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                <ul class="list-disc pl-5 text-sm text-gray-600">
                    <li>机台能力映射：维护机台与产品（如翅片规格）的生产能力矩阵。</li>
                    <li>规则引擎：配置“如果孔数>30，则优先分配5#机台”等高级排产策略。</li>
                    <li>资源约束：录入模具物理总数（硬约束）及换型时间矩阵（大模/子模切换耗时）。</li>
                </ul>
            </div>
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-gray-50 p-4 rounded">
                        <p class="text-sm font-medium text-gray-700">输入</p>
                        <p class="text-sm text-gray-600">机台清单、模具库存、产品BOM特征</p>
                    </div>
                    <div class="bg-gray-50 p-4 rounded">
                        <p class="text-sm font-medium text-gray-700">输出</p>
                        <p class="text-sm text-gray-600">排产约束模型（JSON规则集）</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 资源配置 Tab页 -->
    <div class="bg-white rounded-lg shadow">
        <!-- Tab 导航 -->
        <div class="border-b border-gray-200">
            <ul class="flex flex-wrap -mb-px text-sm font-medium text-center text-gray-500">
                <li class="mr-2">
                    <a href="#" class="resource-tab-link inline-block p-4 text-blue-600 border-b-2 border-blue-600 active group rounded-t-lg" data-target="tab-matrix">
                        <i class="fa fa-th mr-2"></i>机台能力矩阵
                    </a>
                </li>
                <li class="mr-2">
                    <a href="#" class="resource-tab-link inline-block p-4 border-b-2 border-transparent hover:text-gray-600 hover:border-gray-300 group rounded-t-lg" data-target="tab-strategy">
                        <i class="fa fa-code-fork mr-2"></i>优先级策略
                    </a>
                </li>
                <li class="mr-2">
                    <a href="#" class="resource-tab-link inline-block p-4 border-b-2 border-transparent hover:text-gray-600 hover:border-gray-300 group rounded-t-lg" data-target="tab-changeover">
                        <i class="fa fa-refresh mr-2"></i>资源与换型
                    </a>
                </li>
            </ul>
        </div>

        <div class="p-6">
            <!-- Tab 1: 机台能力矩阵 -->
            <div id="tab-matrix" class="resource-tab-content">
                <div class="flex justify-between items-center mb-4">
                    <h4 class="text-md font-medium text-gray-700">机台 x 产品能力映射表</h4>
                    <button class="px-3 py-1 bg-blue-50 text-blue-600 border border-blue-200 rounded hover:bg-blue-100 text-sm">
                        <i class="fa fa-upload mr-1"></i> 导入Excel
                    </button>
                </div>
                <div class="overflow-x-auto border border-gray-200 rounded-lg">
                    <table class="min-w-full divide-y divide-gray-200 text-sm">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-3 text-left font-medium text-gray-500">机台编号</th>
                                <th class="px-4 py-3 text-center font-medium text-gray-500">窗片-小</th>
                                <th class="px-4 py-3 text-center font-medium text-gray-500">窗片-中</th>
                                <th class="px-4 py-3 text-center font-medium text-gray-500">窗片-大</th>
                                <th class="px-4 py-3 text-center font-medium text-gray-500">波片-小</th>
                                <th class="px-4 py-3 text-center font-medium text-gray-500">波片-中</th>
                                <th class="px-4 py-3 text-center font-medium text-gray-500">波片-大</th>
                                <th class="px-4 py-3 text-center font-medium text-gray-500">优先级 (1最高)</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 bg-white">
                            <tr>
                                <td class="px-4 py-3 font-medium text-gray-900">M-001 (高速冲)</td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" checked class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" checked class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" checked class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="number" class="w-12 border rounded text-center text-xs" value="1"></td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium text-gray-900">M-002 (大型冲)</td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" checked class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" checked class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" checked class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" checked class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="number" class="w-12 border rounded text-center text-xs" value="2"></td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium text-gray-900">M-003 (通用冲)</td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" checked class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" checked class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" checked class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" checked class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="checkbox" class="text-blue-600 rounded"></td>
                                <td class="px-4 py-3 text-center"><input type="number" class="w-12 border rounded text-center text-xs" value="3"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Tab 2: 优先级策略 -->
            <div id="tab-strategy" class="resource-tab-content hidden">
                <div class="flex justify-between items-center mb-4">
                    <h4 class="text-md font-medium text-gray-700">排产规则引擎配置</h4>
                    <button class="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm">
                        <i class="fa fa-plus mr-1"></i> 新增规则
                    </button>
                </div>
                <div class="space-y-3">
                    <!-- 规则 1 -->
                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 flex items-center justify-between">
                        <div class="flex items-center space-x-2 w-full">
                            <span class="font-bold text-gray-500">IF</span>
                            <select class="border border-gray-300 rounded px-2 py-1 text-sm bg-white">
                                <option>孔数</option>
                                <option>排数</option>
                                <option>订单量</option>
                            </select>
                            <select class="border border-gray-300 rounded px-2 py-1 text-sm bg-white">
                                <option>></option>
                                <option>=</option>
                                <option><</option>
                            </select>
                            <input type="number" class="border border-gray-300 rounded px-2 py-1 text-sm w-20" value="30">
                            
                            <span class="font-bold text-gray-500 ml-4">THEN</span>
                            <span class="text-sm text-gray-700">优先分配给机台：</span>
                            <select class="border border-gray-300 rounded px-2 py-1 text-sm bg-white w-48">
                                <option>M-002 (大型冲)</option>
                                <option>M-001 (高速冲)</option>
                            </select>
                        </div>
                        <button class="text-red-500 hover:text-red-700"><i class="fa fa-trash"></i></button>
                    </div>

                    <!-- 规则 2 -->
                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 flex items-center justify-between">
                        <div class="flex items-center space-x-2 w-full">
                            <span class="font-bold text-gray-500">IF</span>
                            <select class="border border-gray-300 rounded px-2 py-1 text-sm bg-white">
                                <option>订单量</option>
                            </select>
                            <select class="border border-gray-300 rounded px-2 py-1 text-sm bg-white">
                                <option><</option>
                            </select>
                            <input type="number" class="border border-gray-300 rounded px-2 py-1 text-sm w-20" value="100">
                            
                            <span class="font-bold text-gray-500 ml-4">THEN</span>
                            <span class="text-sm text-gray-700">应用并单规则：</span>
                            <select class="border border-gray-300 rounded px-2 py-1 text-sm bg-white w-48">
                                <option>5天内合并生产</option>
                                <option>3天内合并生产</option>
                            </select>
                        </div>
                        <button class="text-red-500 hover:text-red-700"><i class="fa fa-trash"></i></button>
                    </div>
                </div>
            </div>

            <!-- Tab 3: 资源与换型 -->
            <div id="tab-changeover" class="resource-tab-content hidden">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- 左侧：模具资源 -->
                    <div>
                        <h4 class="text-md font-medium text-gray-700 mb-3">模具资源总库 (硬约束)</h4>
                        <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <label class="text-sm text-gray-600">窗翅片模具</label>
                                    <div class="flex items-center"><input type="number" class="w-16 border rounded text-center text-sm" value="15"> <span class="ml-2 text-sm text-gray-500">套</span></div>
                                </div>
                                <div class="flex justify-between items-center">
                                    <label class="text-sm text-gray-600">波翅片模具</label>
                                    <div class="flex items-center"><input type="number" class="w-16 border rounded text-center text-sm" value="12"> <span class="ml-2 text-sm text-gray-500">套</span></div>
                                </div>
                                <div class="flex justify-between items-center">
                                    <label class="text-sm text-gray-600">U型管模具</label>
                                    <div class="flex items-center"><input type="number" class="w-16 border rounded text-center text-sm" value="8"> <span class="ml-2 text-sm text-gray-500">套</span></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 右侧：换型矩阵 -->
                    <div>
                        <h4 class="text-md font-medium text-gray-700 mb-3">换型时间矩阵 (小时)</h4>
                        <div class="overflow-hidden border border-gray-200 rounded-lg">
                            <table class="min-w-full text-sm text-center">
                                <thead class="bg-gray-100">
                                    <tr>
                                        <th class="p-2 text-left">From \ To</th>
                                        <th class="p-2">窗片</th>
                                        <th class="p-2">波片</th>
                                        <th class="p-2">平片</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="p-2 text-left font-medium bg-gray-50">窗片</td>
                                        <td class="p-2 bg-green-50 text-green-700">2h (子模)</td>
                                        <td class="p-2 bg-red-50 text-red-700">14h (大模)</td>
                                        <td class="p-2 bg-red-50 text-red-700">14h (大模)</td>
                                    </tr>
                                    <tr>
                                        <td class="p-2 text-left font-medium bg-gray-50">波片</td>
                                        <td class="p-2 bg-red-50 text-red-700">14h (大模)</td>
                                        <td class="p-2 bg-green-50 text-green-700">2h (子模)</td>
                                        <td class="p-2 bg-red-50 text-red-700">14h (大模)</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <p class="text-xs text-gray-500 mt-2">* 大模切换需换整个模架，子模切换仅换冲头</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="p-4 border-t border-gray-200 flex justify-end bg-gray-50 rounded-b-lg">
            <button id="save-all-config-btn" class="px-6 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all shadow-sm">
                <i class="fa fa-save mr-1"></i> 保存并应用规则
            </button>
        </div>
    </div>
</div>
                    <!-- 26 产能公式配置 -->
                    <div id="activity-26" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">26 产能公式配置</h3>
                                <p class="text-sm text-gray-500 mt-1">产能管理模块、工时公式配置器</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>动态公式定义：提供公式编辑器，支持配置如 T=(冲次*60*OEE)/穴数 的逻辑，变量可灵活引用</li>
                                        <li>OEE 修正审批：系统从 EAM/MES 获取实际 OEE，与设定值对比。生成修正建议，用户可选择"以实际为准"或"以公式为准"更新标准</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">EAM实绩数据</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">标准工时标准</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 产能公式配置页面 -->
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-800">产能公式配置</h3>
                                <div class="flex space-x-2">
                                    <button id="validate-formula-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                        <i class="fa fa-check-circle mr-1"></i> 验证公式
                                    </button>
                                    <button id="save-formula-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all">
                                        <i class="fa fa-save mr-1"></i> 保存公式
                                    </button>
                                    <button id="confirm-correction-btn" class="px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition-all">
                                        <i class="fa fa-check-square mr-1"></i> 确认修正
                                    </button>
                                </div>
                            </div>
                            <div class="p-6">
                                <!-- 公式编辑器 -->
                                <div class="mb-8">
                                    <h4 class="text-md font-medium text-gray-700 mb-4">公式编辑器</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                        <!-- 变量选择器 -->
                                        <div class="border border-gray-200 rounded-lg p-4">
                                            <h5 class="text-sm font-medium text-gray-700 mb-3">可用变量</h5>
                                            <div class="space-y-2">
                                                <div class="flex items-center p-2 bg-gray-50 rounded cursor-pointer hover:bg-blue-50 variable-item" data-variable="冲次">
                                                    <i class="fa fa-variable mr-2 text-blue-600"></i>
                                                    <span>冲次 (strokes)</span>
                                                </div>
                                                <div class="flex items-center p-2 bg-gray-50 rounded cursor-pointer hover:bg-blue-50 variable-item" data-variable="穴数">
                                                    <i class="fa fa-variable mr-2 text-blue-600"></i>
                                                    <span>穴数 (cavities)</span>
                                                </div>
                                                <div class="flex items-center p-2 bg-gray-50 rounded cursor-pointer hover:bg-blue-50 variable-item" data-variable="OEE">
                                                    <i class="fa fa-variable mr-2 text-blue-600"></i>
                                                    <span>OEE (oee)</span>
                                                </div>
                                                <div class="flex items-center p-2 bg-gray-50 rounded cursor-pointer hover:bg-blue-50 variable-item" data-variable="材料厚度">
                                                    <i class="fa fa-variable mr-2 text-blue-600"></i>
                                                    <span>材料厚度 (thickness)</span>
                                                </div>
                                                <div class="flex items-center p-2 bg-gray-50 rounded cursor-pointer hover:bg-blue-50 variable-item" data-variable="材料宽度">
                                                    <i class="fa fa-variable mr-2 text-blue-600"></i>
                                                    <span>材料宽度 (width)</span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- 公式编辑区 -->
                                        <div class="md:col-span-2">
                                            <label class="block text-sm font-medium text-gray-700 mb-2">标准工时计算公式</label>
                                            <div class="relative">
                                                <input type="text" id="formula-input" class="w-full border border-gray-300 rounded px-3 py-3 text-lg font-mono focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" value="T = (冲次 * 60 * OEE) / 穴数" placeholder="输入公式...">
                                                <div class="absolute right-3 top-3 flex space-x-2">
                                                    <button class="text-gray-500 hover:text-gray-700 formula-operator" data-operator="+" title="加">+</button>
                                                    <button class="text-gray-500 hover:text-gray-700 formula-operator" data-operator="-" title="减">-</button>
                                                    <button class="text-gray-500 hover:text-gray-700 formula-operator" data-operator="*" title="乘">×</button>
                                                    <button class="text-gray-500 hover:text-gray-700 formula-operator" data-operator="/" title="除">÷</button>
                                                    <button class="text-gray-500 hover:text-gray-700 formula-operator" data-operator="(" title="左括号">(</button>
                                                    <button class="text-gray-500 hover:text-gray-700 formula-operator" data-operator=")" title="右括号">)</button>
                                                </div>
                                            </div>
                                            <div class="mt-2 text-sm text-gray-500">
                                                <p>公式说明：T 表示标准工时（分钟）</p>
                                            </div>
                                            <div class="mt-4">
                                                <button id="test-formula-btn" class="px-4 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-all">
                                                    <i class="fa fa-play mr-1"></i> 测试计算
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- OEE修正建议 -->
                                <div>
                                    <h4 class="text-md font-medium text-gray-700 mb-4">OEE修正建议</h4>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full border border-gray-200">
                                            <thead>
                                                <tr>
                                                    <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">机台</th>
                                                    <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料</th>
                                                    <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">设定OEE</th>
                                                    <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">实际OEE (EAM)</th>
                                                    <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">偏差</th>
                                                    <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">建议值</th>
                                                    <th class="px-4 py-3 bg-gray-50 border-b border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                                </tr>
                                            </thead>
                                            <tbody class="divide-y divide-gray-200">
                                                <tr>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-900">M001</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">翅片-A001</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">85%</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-green-600 font-medium">88.5%</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-green-600">+3.5%</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">88.5%</td>
                                                    <td class="px-4 py-3">
                                                        <div class="flex items-center space-x-4">
                                                            <label class="inline-flex items-center">
                                                                <input type="radio" name="oee-choice-1" value="actual" class="h-4 w-4 text-blue-600" checked>
                                                                <span class="ml-2 text-sm text-gray-700">采纳实际</span>
                                                            </label>
                                                            <label class="inline-flex items-center">
                                                                <input type="radio" name="oee-choice-1" value="original" class="h-4 w-4 text-blue-600">
                                                                <span class="ml-2 text-sm text-gray-700">维持设定</span>
                                                            </label>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-900">M002</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">翅片-B002</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">82%</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-red-600 font-medium">75.3%</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-red-600">-6.7%</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">75.3%</td>
                                                    <td class="px-4 py-3">
                                                        <div class="flex items-center space-x-4">
                                                            <label class="inline-flex items-center">
                                                                <input type="radio" name="oee-choice-2" value="actual" class="h-4 w-4 text-blue-600">
                                                                <span class="ml-2 text-sm text-gray-700">采纳实际</span>
                                                            </label>
                                                            <label class="inline-flex items-center">
                                                                <input type="radio" name="oee-choice-2" value="original" class="h-4 w-4 text-blue-600" checked>
                                                                <span class="ml-2 text-sm text-gray-700">维持设定</span>
                                                            </label>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-900">M003</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">翅片-C003</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">80%</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-green-600 font-medium">83.2%</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-green-600">+3.2%</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">83.2%</td>
                                                    <td class="px-4 py-3">
                                                        <div class="flex items-center space-x-4">
                                                            <label class="inline-flex items-center">
                                                                <input type="radio" name="oee-choice-3" value="actual" class="h-4 w-4 text-blue-600" checked>
                                                                <span class="ml-2 text-sm text-gray-700">采纳实际</span>
                                                            </label>
                                                            <label class="inline-flex items-center">
                                                                <input type="radio" name="oee-choice-3" value="original" class="h-4 w-4 text-blue-600">
                                                                <span class="ml-2 text-sm text-gray-700">维持设定</span>
                                                            </label>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-900">M004</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">翅片-D004</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">88%</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-red-600 font-medium">81.5%</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-red-600">-6.5%</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">81.5%</td>
                                                    <td class="px-4 py-3">
                                                        <div class="flex items-center space-x-4">
                                                            <label class="inline-flex items-center">
                                                                <input type="radio" name="oee-choice-4" value="actual" class="h-4 w-4 text-blue-600">
                                                                <span class="ml-2 text-sm text-gray-700">采纳实际</span>
                                                            </label>
                                                            <label class="inline-flex items-center">
                                                                <input type="radio" name="oee-choice-4" value="original" class="h-4 w-4 text-blue-600" checked>
                                                                <span class="ml-2 text-sm text-gray-700">维持设定</span>
                                                            </label>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
<!-- 09 匹配工艺参数 -->
                    <div id="activity-09" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">09 工艺参数匹配</h3>
                                <p class="text-sm text-gray-500 mt-1">工艺数据管理、完整性校验看板</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>完整性校验：遍历待排订单物料，关联工艺主数据，筛选参数缺失的物料清单</li>
                                        <li>待办提醒：生成参数补录待办任务，支持跳转至维护页面</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">待排订单BOM数据</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">待办任务清单、参数缺失物料清单</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 工艺完整性看板 -->
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-800">工艺完整性看板</h3>
                                <div class="flex space-x-2">
                                    <button id="refresh-data-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                        <i class="fa fa-refresh mr-1"></i> 刷新数据
                                    </button>
                                </div>
                            </div>
                            <div class="p-6">
                                <!-- 仪表盘区域 -->
                                <div class="mb-8">
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                        <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                                            <h4 class="text-md font-medium text-gray-700 mb-4 text-center">参数完整率</h4>
                                            <div class="flex justify-center">
                                                <div class="relative w-40 h-40">
                                                    <canvas id="completeness-gauge"></canvas>
                                                    <div class="absolute inset-0 flex items-center justify-center">
                                                        <span class="text-3xl font-bold text-blue-600">85%</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <p class="text-sm text-gray-600 mt-4 text-center">总计 120 个物料，18 个参数缺失</p>
                                        </div>
                                        <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                                            <h4 class="text-md font-medium text-gray-700 mb-4">待办任务统计</h4>
                                            <div class="space-y-4">
                                                <div>
                                                    <div class="flex justify-between mb-1">
                                                        <span class="text-sm text-gray-600">待处理</span>
                                                        <span class="text-sm font-medium text-gray-700">12</span>
                                                    </div>
                                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                                        <div class="bg-yellow-500 h-2 rounded-full" style="width: 67%"></div>
                                                    </div>
                                                </div>
                                                <div>
                                                    <div class="flex justify-between mb-1">
                                                        <span class="text-sm text-gray-600">处理中</span>
                                                        <span class="text-sm font-medium text-gray-700">4</span>
                                                    </div>
                                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                                        <div class="bg-blue-500 h-2 rounded-full" style="width: 22%"></div>
                                                    </div>
                                                </div>
                                                <div>
                                                    <div class="flex justify-between mb-1">
                                                        <span class="text-sm text-gray-600">已完成</span>
                                                        <span class="text-sm font-medium text-gray-700">2</span>
                                                    </div>
                                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                                        <div class="bg-green-500 h-2 rounded-full" style="width: 11%"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                                            <h4 class="text-md font-medium text-gray-700 mb-4">订单影响分析</h4>
                                            <div class="space-y-3">
                                                <div class="flex items-center">
                                                    <span class="w-3 h-3 bg-red-500 rounded-full mr-2"></span>
                                                    <span class="text-sm text-gray-600">高风险订单: <span class="font-medium">3</span> 个</span>
                                                </div>
                                                <div class="flex items-center">
                                                    <span class="w-3 h-3 bg-yellow-500 rounded-full mr-2"></span>
                                                    <span class="text-sm text-gray-600">中风险订单: <span class="font-medium">5</span> 个</span>
                                                </div>
                                                <div class="flex items-center">
                                                    <span class="w-3 h-3 bg-green-500 rounded-full mr-2"></span>
                                                    <span class="text-sm text-gray-600">低风险订单: <span class="font-medium">8</span> 个</span>
                                                </div>
                                                <div class="mt-4">
                                                    <button class="w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all text-sm">
                                                        查看详情
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 参数缺失物料列表 -->
                                <div>
                                    <h4 class="text-md font-medium text-gray-700 mb-4">参数缺失物料清单</h4>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full border border-gray-200">
                                            <thead>
                                                <tr>
                                                    <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料号</th>
                                                    <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料名称</th>
                                                    <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">订单号</th>
                                                    <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">缺失项</th>
                                                    <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">风险等级</th>
                                                    <th class="px-4 py-3 bg-gray-50 border-b border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                                </tr>
                                            </thead>
                                            <tbody class="divide-y divide-gray-200">
                                                <tr>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-900">MAT-001</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">翅片-A001</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">ORD-202507-001</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">温度参数、压力参数</td>
                                                    <td class="px-4 py-3 border-r border-gray-200">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                                            高
                                                        </span>
                                                    </td>
                                                    <td class="px-4 py-3 text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 jump-maintenance-btn" data-material="MAT-001">跳转维护</a>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-900">MAT-002</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">翅片-B002</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">ORD-202507-002</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">时间参数</td>
                                                    <td class="px-4 py-3 border-r border-gray-200">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                            中
                                                        </span>
                                                    </td>
                                                    <td class="px-4 py-3 text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 jump-maintenance-btn" data-material="MAT-002">跳转维护</a>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-900">MAT-003</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">弯头-C003</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">ORD-202507-003</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">速度参数</td>
                                                    <td class="px-4 py-3 border-r border-gray-200">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                            中
                                                        </span>
                                                    </td>
                                                    <td class="px-4 py-3 text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 jump-maintenance-btn" data-material="MAT-003">跳转维护</a>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-900">MAT-004</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">U型管-D004</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">ORD-202507-004</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">压力参数、时间参数</td>
                                                    <td class="px-4 py-3 border-r border-gray-200">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                                            高
                                                        </span>
                                                    </td>
                                                    <td class="px-4 py-3 text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 jump-maintenance-btn" data-material="MAT-004">跳转维护</a>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-900">MAT-005</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">法兰-E005</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">ORD-202507-005</td>
                                                    <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">温度参数</td>
                                                    <td class="px-4 py-3 border-r border-gray-200">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            低
                                                        </span>
                                                    </td>
                                                    <td class="px-4 py-3 text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 jump-maintenance-btn" data-material="MAT-005">跳转维护</a>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200 mt-4">
                                        <div class="text-sm text-gray-700">
                                            显示 <span class="font-medium">1</span> 到 <span class="font-medium">5</span> 条，共 <span class="font-medium">18</span> 条
                                        </div>
                                        <div class="flex space-x-2">
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 disabled:opacity-50" disabled>
                                                上一页
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm bg-blue-50 text-blue-600">
                                                1
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                2
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                3
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                4
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                下一页
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 10 下发业务联络书 -->
                    <div id="activity-10" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">10 业务联络书下发</h3>
                                <p class="text-sm text-gray-500 mt-1">协同门户 (Portal)、业务联络书管理页</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>联络书创建：关联订单与物料清单，自动生成业务联络书</li>
                                        <li>状态追踪：跟踪联络书从创建到确认的全流程状态</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">订单信息、物料清单</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">业务联络书</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 业务联络书管理页面 -->
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-800">业务联络书管理</h3>
                                <div class="flex space-x-2">
                                    <button id="create-contact-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                        <i class="fa fa-plus mr-1"></i> 创建联络书
                                    </button>
                                    <button id="export-contact-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all">
                                        <i fa fa-download mr-1"></i> 导出
                                    </button>
                                </div>
                            </div>
                            <div class="p-6">
                                <!-- 搜索栏 -->
                                <div class="mb-6 bg-gray-50 p-4 rounded-lg">
                                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">联络书编号</label>
                                            <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入联络书编号">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">订单号</label>
                                            <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入订单号">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">物料</label>
                                            <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入物料编码或名称">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">状态</label>
                                            <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="">全部状态</option>
                                                <option value="created">已创建</option>
                                                <option value="sent">已发送</option>
                                                <option value="confirmed">已确认</option>
                                                <option value="rejected">已驳回</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mt-4 flex justify-end">
                                        <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all mr-2">
                                            重置
                                        </button>
                                        <button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                            搜索
                                        </button>
                                    </div>
                                </div>

                                <!-- 业务联络书列表 -->
                                <div class="border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                        <h4 class="text-md font-medium text-gray-700">业务联络书列表</h4>
                                        <div class="flex items-center">
                                            <span class="text-sm text-gray-500 mr-2">共 18 条记录</span>
                                        </div>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">联络书编号</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">订单号</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数量</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">创建时间</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MES状态</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">CONT-202507-001</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">ORD-202507-001</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">COMP-100A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">50</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-20 10:30</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            已确认
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看</a>
                                                        <a href="#" class="text-blue-600 hover:text-blue-900">导出</a>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">CONT-202507-002</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">ORD-202507-002</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">COMP-200B</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">30</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-20 14:15</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                            已发送
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看</a>
                                                        <a href="#" class="text-blue-600 hover:text-blue-900">导出</a>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">CONT-202507-003</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">ORD-202507-003</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">COMP-300C</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">20</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-21 09:45</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                                            已驳回
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看</a>
                                                        <a href="#" class="text-blue-600 hover:text-blue-900">导出</a>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200">
                                        <div class="text-sm text-gray-700">
                                            显示 <span class="font-medium">1</span> 到 <span class="font-medium">3</span> 条，共 <span class="font-medium">18</span> 条
                                        </div>
                                        <div class="flex space-x-2">
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 disabled:opacity-50" disabled>
                                                上一页
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm bg-blue-50 text-blue-600">
                                                1
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                2
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                3
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                4
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                5
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                6
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                下一页
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
<!-- 11 产能核算 (V3.0: 智能模拟版) -->
<div id="activity-11" class="activity-section hidden">
    <div class="bg-white rounded-lg shadow mb-6">
        <div class="p-6 border-b border-gray-200">
            <h3 class="text-lg font-medium text-gray-800">11 产能核算</h3>
            <p class="text-sm text-gray-500 mt-1">产能管理模块、纯产能模拟分析工作台</p>
        </div>
        <div class="p-6">
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                <ul class="list-disc pl-5 text-sm text-gray-600">
                    <li><strong>数据自动获取：</strong>自动读取工厂日历（Act 01）的当前开线数、系统标准提前期作为基准。</li>
                    <li><strong>瓶颈识别：</strong>基于“需求孔数 vs 当前配置”自动计算初始负荷率。</li>
                    <li><strong>智能推荐与模拟：</strong>提供AI优化建议方案（追求负荷率接近100%），支持一键应用建议或手动调整参数进行沙盘模拟。</li>
                </ul>
            </div>
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-gray-50 p-4 rounded border border-gray-100">
                        <p class="text-sm font-medium text-gray-700">输入 (自动获取)</p>
                        <p class="text-sm text-gray-600">需求孔数(Act03)、当前开线数(Act01)、标准提前期(Config)</p>
                    </div>
                    <div class="bg-gray-50 p-4 rounded border border-gray-100">
                        <p class="text-sm font-medium text-gray-700">输出</p>
                        <p class="text-sm text-gray-600">模拟后的负荷率、缺口分析报告</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 产能分析工作台 -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        
        <!-- 左侧：系统现状参数 (只读区) -->
        <div class="bg-white rounded-lg shadow lg:col-span-1 flex flex-col border border-gray-200">
            <div class="p-4 border-b border-gray-200 bg-gray-50 rounded-t-lg">
                <h3 class="text-md font-bold text-gray-800"><i class="fa fa-database mr-2"></i>本月系统参数 (现状)</h3>
            </div>
            <div class="p-6 space-y-6 flex-1">
                <!-- 1. 需求端 -->
                <div>
                    <h4 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2">需求端 (Act 03)</h4>
                    <div class="bg-blue-50 p-3 rounded border border-blue-100">
                        <div class="flex justify-between text-sm mb-1">
                            <span class="text-gray-600">预测总量</span>
                            <span class="font-bold text-gray-900">12,500 台</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">折算总孔数</span>
                            <span class="font-bold text-blue-700">125 万孔</span>
                        </div>
                    </div>
                </div>

                <!-- 2. 供给端 (自动获取，不可改) -->
                <div>
                    <h4 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2">供给端 (Act 01 / Config)</h4>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center p-3 bg-gray-50 rounded border border-gray-200">
                            <span class="text-sm text-gray-600">当前开线数</span>
                            <div class="flex items-center">
                                <span class="font-mono font-bold text-gray-800 text-lg mr-2">4</span>
                                <span class="text-xs text-gray-500 bg-gray-200 px-1 rounded">线</span>
                            </div>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-gray-50 rounded border border-gray-200">
                            <span class="text-sm text-gray-600">标准提前期</span>
                            <div class="flex items-center">
                                <span class="font-mono font-bold text-gray-800 text-lg mr-2">2.5</span>
                                <span class="text-xs text-gray-500 bg-gray-200 px-1 rounded">天</span>
                            </div>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-gray-50 rounded border border-gray-200">
                            <span class="text-sm text-gray-600">标准单线产能</span>
                            <div class="flex items-center">
                                <span class="font-mono font-bold text-gray-800 text-lg mr-2">20</span>
                                <span class="text-xs text-gray-500 bg-gray-200 px-1 rounded">万孔/月</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 右侧：分析与模拟 (操作区) -->
        <div class="bg-white rounded-lg shadow lg:col-span-2 flex flex-col border border-gray-200">
            <div class="p-4 border-b border-gray-200 bg-white rounded-t-lg flex justify-between items-center">
                <h3 class="text-md font-bold text-gray-800"><i class="fa fa-sliders mr-2"></i>模拟沙盘 & 缺口分析</h3>
                <span class="px-3 py-1 text-xs font-bold bg-red-100 text-red-700 rounded-full border border-red-200" id="sim-status">当前状态：产能不足 (156%)</span>
            </div>
            
            <div class="p-6 flex-1">
                <!-- 1. 模拟参数调整区 -->
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6 relative">
                    <!-- 智能推荐悬浮按钮 -->
                    <button id="get-ai-suggest-btn" class="absolute top-4 right-4 text-xs bg-purple-600 text-white px-3 py-1.5 rounded-full hover:bg-purple-700 shadow-sm transition-all flex items-center animate-pulse">
                        <i class="fa fa-lightbulb-o mr-1"></i> 获取优化建议
                    </button>

                    <h5 class="text-sm font-bold text-gray-700 mb-3">调整参数进行模拟</h5>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-end">
                        <!-- 调整开线 -->
                        <div>
                            <label class="block text-xs font-medium text-gray-500 mb-1">调整开线数 (线)</label>
                            <div class="flex items-center">
                                <input type="number" id="sim-lines" class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-bold text-gray-800" value="4" min="1" max="20">
                                <span class="ml-2 text-xs text-gray-400 whitespace-nowrap">当前: 4</span>
                            </div>
                        </div>
                        
                        <!-- 调整提前期 -->
                        <div>
                            <label class="block text-xs font-medium text-gray-500 mb-1">调整提前期 (天)</label>
                            <div class="flex items-center">
                                <input type="number" id="sim-leadtime" class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-bold text-gray-800" value="2.5" step="0.1">
                                <span class="ml-2 text-xs text-gray-400 whitespace-nowrap">当前: 2.5</span>
                            </div>
                        </div>

                        <!-- 按钮 -->
                        <div>
                            <button id="run-simulation-btn" class="w-full px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition-all shadow-md text-sm font-medium flex justify-center items-center">
                                <i class="fa fa-calculator mr-2"></i> 计算模拟结果
                            </button>
                        </div>
                    </div>

                    <!-- 建议展示区 (默认隐藏) -->
                    <div id="ai-suggestion-box" class="hidden mt-4 pt-4 border-t border-gray-200">
                        <div class="flex items-start bg-purple-50 p-3 rounded border border-purple-100">
                            <i class="fa fa-magic text-purple-600 mt-1 mr-3"></i>
                            <div class="flex-1">
                                <p class="text-sm font-bold text-gray-800">推荐方案：资源利用率最优</p>
                                <p class="text-xs text-gray-600 mt-1" id="suggestion-text">
                                    <!-- JS填充内容 -->
                                </p>
                            </div>
                            <button id="apply-ai-suggest-btn" class="ml-4 px-3 py-1 bg-white border border-purple-300 text-purple-700 text-xs rounded hover:bg-purple-100 transition-all font-medium">
                                应用此方案
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 2. 分析结果可视化 -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                    <!-- 仪表盘 -->
                    <div class="flex flex-col items-center">
                        <div class="relative w-48 h-48 mx-auto">
                            <canvas id="capacity-sim-gauge"></canvas>
                            <div class="absolute inset-0 flex flex-col items-center justify-center top-4">
                                <span class="text-4xl font-bold text-red-600 transition-colors duration-300" id="gauge-percent">156%</span>
                                <span class="text-xs text-gray-500">模拟负荷率</span>
                            </div>
                        </div>
                    </div>

                    <!-- 文字报告 -->
                    <div class="space-y-4">
                        <div class="p-3 border-l-4 border-blue-500 bg-blue-50 rounded">
                            <p class="text-xs text-gray-500 uppercase">模拟总产能</p>
                            <p class="text-xl font-bold text-gray-800"><span id="res-capacity">80</span> <span class="text-sm font-normal text-gray-600">万孔</span></p>
                        </div>
                        <div class="p-3 border-l-4 border-red-500 bg-red-50 rounded transition-colors duration-300" id="res-gap-box">
                            <p class="text-xs text-gray-500 uppercase">产能缺口</p>
                            <p class="text-xl font-bold text-red-600" id="res-gap">-45 万孔</p>
                        </div>
                        <div class="text-sm text-gray-600 mt-2">
                            <span class="font-bold">分析结论：</span>
                            <span id="res-conclusion">当前配置无法满足需求，请尝试增加开线数或延长提前期。</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
                    

                    <!-- 12 不满足 (判断) -->
                    <div id="activity-12" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">12 未齐套物料管理</h3>
                                <p class="text-sm text-gray-500 mt-1">物料管理中心、齐套性检查页</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>库存比对：根据订单BOM自动比对库存，生成物料齐套性报告</li>
                                        <li>缺料预警：标记缺料物料，提供采购建议</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">订单BOM、库存数据</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">齐套性报告、缺料清单</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 齐套性检查页面 -->
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-800">物料齐套性检查</h3>
                                <div class="flex space-x-2">
                                    <button id="check-material-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                        <i class="fa fa-check-square-o mr-1"></i> 检查齐套性
                                    </button>
                                    <button id="export-material-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all">
                                        <i class="fa fa-download mr-1"></i> 导出报告
                                    </button>
                                </div>
                            </div>
                            <div class="p-6">
                                <!-- 筛选条件 -->
                                <div class="mb-6 bg-gray-50 p-4 rounded-lg">
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">订单号</label>
                                            <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入订单号">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">物料编码</label>
                                            <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入物料编码">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">检查状态</label>
                                            <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="">全部状态</option>
                                                <option value="all">齐套</option>
                                                <option value="partial">部分齐套</option>
                                                <option value="none">不齐套</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mt-4 flex justify-end">
                                        <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all mr-2">
                                            重置
                                        </button>
                                        <button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                            查询
                                        </button>
                                    </div>
                                </div>

                                <!-- 订单列表 -->
                                <div class="mb-6">
                                    <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                        <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                            <h4 class="text-md font-medium text-gray-700">订单列表</h4>
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-500 mr-2">共 12 条记录</span>
                                            </div>
                                        </div>
                                        <div class="overflow-x-auto">
                                            <table class="min-w-full divide-y divide-gray-200">
                                                <thead class="bg-gray-50">
                                                    <tr>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">订单号</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">产品</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数量</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">交期</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">齐套状态</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">缺料项数</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MES状态</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="bg-white divide-y divide-gray-200">
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">ORD-202507-001</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">PROD-100A</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">50</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-25</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                                齐套
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">0</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看详情</a>
                                                            <a href="#" class="text-blue-600 hover:text-blue-900">导出报告</a>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">ORD-202507-002</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">PROD-200B</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">30</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-28</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                                部分齐套
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看详情</a>
                                                            <a href="#" class="text-blue-600 hover:text-blue-900">导出报告</a>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">ORD-202507-003</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">PROD-300C</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">20</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-08-01</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                                                不齐套
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">5</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看详情</a>
                                                            <a href="#" class="text-blue-600 hover:text-blue-900">导出报告</a>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200">
                                            <div class="text-sm text-gray-700">
                                                显示 <span class="font-medium">1</span> 到 <span class="font-medium">3</span> 条，共 <span class="font-medium">12</span> 条
                                            </div>
                                            <div class="flex space-x-2">
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 disabled:opacity-50" disabled>
                                                    上一页
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm bg-blue-50 text-blue-600">
                                                    1
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    2
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    3
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    4
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    下一页
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 物料详情表 -->
                                <div class="border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                        <h4 class="text-md font-medium text-gray-700">物料详情表 - 订单号: ORD-202507-002</h4>
                                        <div class="flex items-center">
                                            <span class="text-sm text-gray-500 mr-2">共 8 项物料</span>
                                            <span class="px-2 py-1 bg-yellow-100 text-yellow-800 rounded text-xs font-medium">
                                                部分齐套 (2项缺料)
                                            </span>
                                        </div>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料编码</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料名称</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">单位</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">BOM用量</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">库存数量</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">可用数量</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">缺口数量</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MAT-100A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">物料A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">个</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">30</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">50</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">45</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">0</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            齐套
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MAT-200B</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">物料B</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">个</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">60</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">40</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">40</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-red-600">20</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                                            缺料
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MAT-300C</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">物料C</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">个</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">30</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">25</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">25</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-red-600">5</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                                            缺料
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MAT-400D</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">物料D</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">个</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">30</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">100</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">90</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">0</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            齐套
                                                        </span>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 13 提供工艺参数 -->
                    <div id="activity-13" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">13 工艺参数维护</h3>
                                <p class="text-sm text-gray-500 mt-1">工艺管理中心、参数维护页</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>参数维护：支持按物料、工序等维度维护工艺参数</li>
                                        <li>版本管理：记录参数变更历史，支持版本对比与回滚</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">工艺参数数据</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">工艺参数库、版本记录</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 工艺参数维护页面 -->
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-800">工艺参数维护</h3>
                                <div class="flex space-x-2">
                                    <button id="add-param-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                        <i class="fa fa-plus mr-1"></i> 添加参数
                                    </button>
                                    <button id="import-param-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all">
                                        <i class="fa fa-upload mr-1"></i> 导入
                                    </button>
                                    <button id="export-param-btn" class="px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700 transition-all">
                                        <i class="fa fa-download mr-1"></i> 导出
                                    </button>
                                </div>
                            </div>
                            <div class="p-6">
                                <!-- 搜索栏 -->
                                <div class="mb-6 bg-gray-50 p-4 rounded-lg">
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">物料编码</label>
                                            <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入物料编码">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">工序</label>
                                            <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="">全部工序</option>
                                                <option value="process1">工序1</option>
                                                <option value="process2">工序2</option>
                                                <option value="process3">工序3</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">参数类型</label>
                                            <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="">全部类型</option>
                                                <option value="temperature">温度</option>
                                                <option value="pressure">压力</option>
                                                <option value="speed">速度</option>
                                                <option value="time">时间</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mt-4 flex justify-end">
                                        <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all mr-2">
                                            重置
                                        </button>
                                        <button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                            搜索
                                        </button>
                                    </div>
                                </div>

                                <!-- 工艺参数列表 -->
                                <div class="border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                        <h4 class="text-md font-medium text-gray-700">工艺参数列表</h4>
                                        <div class="flex items-center">
                                            <span class="text-sm text-gray-500 mr-2">共 25 条记录</span>
                                        </div>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料编码</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料名称</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">工序</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">参数名称</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">参数值</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">单位</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">版本</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">更新时间</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MES状态</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">COMP-100A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">组件A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">工序1</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">温度</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">180</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">℃</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">V1.0</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-15 10:30</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">编辑</a>
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">历史</a>
                                                        <a href="#" class="text-red-600 hover:text-red-900">删除</a>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">COMP-100A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">组件A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">工序1</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">压力</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">5</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">MPa</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">V1.0</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-15 10:30</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">编辑</a>
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">历史</a>
                                                        <a href="#" class="text-red-600 hover:text-red-900">删除</a>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">COMP-200B</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">组件B</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">工序2</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">速度</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">120</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">rpm</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">V2.1</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-18 14:45</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">编辑</a>
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">历史</a>
                                                        <a href="#" class="text-red-600 hover:text-red-900">删除</a>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200">
                                        <div class="text-sm text-gray-700">
                                            显示 <span class="font-medium">1</span> 到 <span class="font-medium">3</span> 条，共 <span class="font-medium">25</span> 条
                                        </div>
                                        <div class="flex space-x-2">
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 disabled:opacity-50" disabled>
                                                上一页
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm bg-blue-50 text-blue-600">
                                                1
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                2
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                3
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                4
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                5
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                下一页
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
<!-- 14 版本发布与变更控制台 -->
<div id="activity-14" class="activity-section hidden">
    <div class="bg-white rounded-lg shadow mb-6">
        <div class="p-6 border-b border-gray-200">
            <h3 class="text-lg font-medium text-gray-800">14 版本发布与变更控制台</h3>
            <p class="text-sm text-gray-500 mt-1">需求分析与协同、计划基线管理</p>
        </div>
        <div class="p-6">
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                <ul class="list-disc pl-5 text-sm text-gray-600 space-y-1">
                    <li><strong>Diff 比对 (Pre-Check)：</strong>在发布前，自动比对“待发草稿”与“上版基线”，高亮显示新增(绿)、删除(红)、变更(黄)。</li>
                    <li><strong>风险阻断：</strong>自动识别 T+3 锁定区内的“取消/减量”订单。若存在未处置的风险变更，禁止发布版本。</li>
                    <li><strong>闭环处置：</strong>计划员需对风险订单点击 [确认中断]，系统触发 MES 停机指令并记录日志后，方可解锁发布权限。</li>
                </ul>
            </div>
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-gray-50 p-4 rounded border border-gray-100">
                        <p class="text-sm font-medium text-gray-700">输入</p>
                        <p class="text-sm text-gray-600">待发计划快照、上版基线数据</p>
                    </div>
                    <div class="bg-gray-50 p-4 rounded border border-gray-100">
                        <p class="text-sm font-medium text-gray-700">输出</p>
                        <p class="text-sm text-gray-600">锁定版本、MES变更/停机指令</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 版本发布控制台 -->
    <div class="space-y-6">
        
        <!-- 上半区：版本列表 (Master) -->
        <div class="bg-white rounded-lg shadow overflow-hidden">
            <div class="p-4 border-b border-gray-200 bg-gray-50 flex justify-between items-center">
                <h4 class="text-md font-bold text-gray-800"><i class="fa fa-list mr-2"></i>版本列表</h4>
                <button id="refresh-version-list" class="text-gray-500 hover:text-blue-600"><i class="fa fa-refresh"></i></button>
            </div>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200 text-sm">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left font-medium text-gray-500">版本号</th>
                            <th class="px-6 py-3 text-left font-medium text-gray-500">计划周期</th>
                            <th class="px-6 py-3 text-center font-medium text-gray-500">工单数</th>
                            <th class="px-6 py-3 text-left font-medium text-gray-500">创建时间</th>
                            <th class="px-6 py-3 text-left font-medium text-gray-500">状态</th>
                            <th class="px-6 py-3 text-right font-medium text-gray-500">操作</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200 bg-white" id="version-table-body">
                        <!-- V1.0 (基线) -->
                        <tr class="hover:bg-gray-50 group">
                            <td class="px-6 py-4 font-medium text-gray-900">V1.0-20250720</td>
                            <td class="px-6 py-4 text-gray-500">07/21 - 07/27</td>
                            <td class="px-6 py-4 text-center">128</td>
                            <td class="px-6 py-4 text-gray-500">07-20 08:00</td>
                            <td class="px-6 py-4"><span class="px-2 py-1 rounded-full bg-gray-100 text-gray-600 text-xs font-medium border border-gray-200"><i class="fa fa-lock mr-1"></i>Locked</span></td>
                            <td class="px-6 py-4 text-right"><span class="text-gray-400 text-xs">当前基线</span></td>
                        </tr>
                        <!-- V1.1 (草稿 - 选中状态) -->
                        <tr class="bg-blue-50 border-l-4 border-blue-500 cursor-pointer" id="active-draft-row">
                            <td class="px-6 py-4 font-medium text-blue-700">
                                V1.1-20250721
                                <span class="ml-2 text-[10px] bg-red-100 text-red-600 px-1 rounded animate-pulse" id="risk-badge">有风险</span>
                            </td>
                            <td class="px-6 py-4 text-gray-700">07/21 - 07/27</td>
                            <td class="px-6 py-4 text-center font-bold">135 <span class="text-green-600 text-xs">(+7)</span></td>
                            <td class="px-6 py-4 text-gray-700">07-21 10:30</td>
                            <td class="px-6 py-4"><span class="px-2 py-1 rounded-full bg-yellow-100 text-yellow-800 text-xs font-medium border border-yellow-200">Draft</span></td>
                            <td class="px-6 py-4 text-right space-x-2">
                                <button class="text-blue-600 hover:text-blue-800 font-medium text-xs" onclick="alert('正在重新计算差异...')"><i class="fa fa-exchange mr-1"></i>执行比对</button>
                                <button id="btn-publish-version" class="px-3 py-1.5 bg-gray-400 text-white rounded text-xs cursor-not-allowed transition-all shadow-sm" disabled title="存在未处置风险，禁止发布">
                                    <i class="fa fa-upload mr-1"></i>锁定并发布
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 下半区：差异明细 (Diff View) -->
        <div class="bg-white rounded-lg shadow flex flex-col h-[500px]">
            <div class="p-4 border-b border-gray-200 flex justify-between items-center bg-gray-50">
                <div class="flex items-center">
                    <h4 class="text-md font-bold text-gray-800 mr-4"><i class="fa fa-columns mr-2"></i>版本差异比对 (Diff)</h4>
                    <div class="flex space-x-3 text-xs">
                        <span class="flex items-center"><span class="w-3 h-3 bg-green-100 border border-green-300 mr-1"></span> 新增</span>
                        <span class="flex items-center"><span class="w-3 h-3 bg-red-100 border border-red-300 mr-1"></span> 取消/删除</span>
                        <span class="flex items-center"><span class="w-3 h-3 bg-yellow-100 border border-yellow-300 mr-1"></span> 变更</span>
                    </div>
                </div>
                <div class="text-sm text-red-600 font-bold" id="risk-alert-text">
                    <i class="fa fa-exclamation-triangle mr-1"></i> 发现 1 个 T+3 锁定区内的删除操作，请立即处置！
                </div>
            </div>
            
            <div class="flex-1 flex overflow-hidden">
                <!-- 左侧：旧基线 -->
                <div class="flex-1 border-r border-gray-200 flex flex-col bg-gray-50/30">
                    <div class="p-2 border-b border-gray-200 text-xs font-bold text-gray-500 text-center bg-gray-100">
                        基线版本 (V1.0)
                    </div>
                    <div class="flex-1 overflow-y-auto p-2 space-y-2">
                        <!-- 正常行 -->
                        <div class="p-2 bg-white border border-gray-200 rounded text-xs flex justify-between opacity-50">
                            <span>MO-1001 (500件)</span> <span>07-25</span>
                        </div>
                        <!-- 被删除的行 (对应右侧红色) -->
                        <div class="p-2 bg-white border border-gray-300 rounded text-xs flex justify-between relative">
                            <span class="font-bold text-gray-700">MO-1005 (200件)</span> 
                            <span>07-22 <span class="text-red-500 font-bold">(T+1)</span></span>
                            <!-- 连接线起点 -->
                            <div class="absolute top-1/2 -right-3 w-3 h-px bg-red-300"></div>
                        </div>
                        <div class="p-2 bg-white border border-gray-200 rounded text-xs flex justify-between opacity-50">
                            <span>MO-1006 (100件)</span> <span>07-26</span>
                        </div>
                    </div>
                </div>

                <!-- 右侧：新草稿 -->
                <div class="flex-1 flex flex-col bg-white">
                    <div class="p-2 border-b border-gray-200 text-xs font-bold text-blue-600 text-center bg-blue-50">
                        待发草稿 (V1.1)
                    </div>
                    <div class="flex-1 overflow-y-auto p-2 space-y-2">
                        <!-- 正常行 -->
                        <div class="p-2 bg-white border border-gray-200 rounded text-xs flex justify-between opacity-50">
                            <span>MO-1001 (500件)</span> <span>07-25</span>
                        </div>
                        
                        <!-- 风险行：删除操作 -->
                        <div class="p-2 bg-red-50 border border-red-300 rounded text-xs flex justify-between items-center group relative risk-row">
                            <div class="flex flex-col">
                                <span class="font-bold text-red-700 line-through">MO-1005 (已移除)</span>
                                <span class="text-[10px] text-red-500">原计划: 07-22 (T+1 锁定区)</span>
                            </div>
                            <!-- 处置按钮 -->
                            <button class="btn-handle-risk px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 shadow-sm transition-all animate-bounce">
                                <i class="fa fa-ban mr-1"></i> 确认中断
                            </button>
                            <!-- 处置后状态 (默认隐藏) -->
                            <span class="hidden risk-handled-tag text-green-600 font-bold border border-green-200 bg-green-50 px-2 py-1 rounded">
                                <i class="fa fa-check"></i> 已停机
                            </span>
                        </div>

                        <!-- 新增行 -->
                        <div class="p-2 bg-green-50 border border-green-300 rounded text-xs flex justify-between">
                            <span class="font-bold text-green-700">MO-1008 (新单)</span>
                            <span>07-27 (T+6)</span>
                        </div>
                        
                        <!-- 变更行 -->
                        <div class="p-2 bg-yellow-50 border border-yellow-300 rounded text-xs flex justify-between">
                            <span class="font-bold text-yellow-700">MO-1006 (改量)</span>
                            <span>100 <i class="fa fa-arrow-right text-gray-400"></i> 120</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
                   
                    <!-- 15 反馈计划 -->
                    <div id="activity-15" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">15 计划执行反馈</h3>
                                <p class="text-sm text-gray-500 mt-1">计划管理中心、计划反馈页</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>计划接收：车间/产线接收并确认下发的计划</li>
                                        <li>反馈问题：对不可执行的计划任务提出异议，说明原因</li>
                                        <li>状态跟踪：跟踪计划反馈状态，记录反馈时间与内容</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">反馈信息、问题描述</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">反馈记录、计划状态更新</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 计划反馈页面 -->
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">计划反馈</h3>
                            </div>
                            <div class="p-6">
                                <!-- 筛选条件 -->
                                <div class="mb-6 bg-gray-50 p-4 rounded-lg">
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">计划编号</label>
                                            <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入计划编号">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">下发时间</label>
                                            <div class="flex items-center space-x-2">
                                                <input type="date" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <span class="text-gray-500">至</span>
                                                <input type="date" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                            </div>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">状态</label>
                                            <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="">全部状态</option>
                                                <option value="pending">待接收</option>
                                                <option value="received">已接收</option>
                                                <option value="rejected">已驳回</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mt-4 flex justify-end">
                                        <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all mr-2">
                                            重置
                                        </button>
                                        <button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                            查询
                                        </button>
                                    </div>
                                </div>

                                <!-- 计划列表 -->
                                <div class="mb-6">
                                    <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                        <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                            <h4 class="text-md font-medium text-gray-700">计划列表</h4>
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-500 mr-2">共 8 条记录</span>
                                            </div>
                                        </div>
                                        <div class="overflow-x-auto">
                                            <table class="min-w-full divide-y divide-gray-200">
                                                <thead class="bg-gray-50">
                                                    <tr>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">计划编号</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">下发编号</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">下发时间</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">下发人</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">计划周期</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">任务数</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MES状态</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="bg-white divide-y divide-gray-200">
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MP-202507-001</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">ISSUE-202507-001</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-20 16:30</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">张三</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-21 至 2025-07-27</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">10</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                                待接收
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看</a>
                                                            <a href="#" class="text-green-600 hover:text-green-900 mr-2">接收</a>
                                                            <a href="#" class="text-red-600 hover:text-red-900">驳回</a>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MP-202507-002</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">ISSUE-202507-002</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-19 14:15</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">李四</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-21 至 2025-07-27</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">5</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                                已接收
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看</a>
                                                            <a href="#" class="text-gray-400 cursor-not-allowed mr-2">接收</a>
                                                            <a href="#" class="text-gray-400 cursor-not-allowed">驳回</a>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MP-202507-003</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">ISSUE-202507-003</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-18 09:45</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">王五</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-14 至 2025-07-20</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">8</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                                                已驳回
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看</a>
                                                            <a href="#" class="text-gray-400 cursor-not-allowed mr-2">接收</a>
                                                            <a href="#" class="text-gray-400 cursor-not-allowed">驳回</a>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200">
                                            <div class="text-sm text-gray-700">
                                                显示 <span class="font-medium">1</span> 到 <span class="font-medium">3</span> 条，共 <span class="font-medium">8</span> 条
                                            </div>
                                            <div class="flex space-x-2">
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 disabled:opacity-50" disabled>
                                                    上一页
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm bg-blue-50 text-blue-600">
                                                    1
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    2
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    3
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    下一页
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 反馈记录 -->
                                <div class="border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="bg-gray-50 p-4 border-b border-gray-200">
                                        <h4 class="text-md font-medium text-gray-700">反馈记录</h4>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">反馈编号</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">计划编号</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">反馈时间</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">反馈人</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">反馈类型</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">反馈内容</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">处理状态</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">FEED-202507-001</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">MP-202507-003</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-18 10:30</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">赵六</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                                            驳回
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 text-sm text-gray-500">设备A维护中，无法按计划生产</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                            处理中
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">FEED-202507-002</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">MP-202507-002</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-19 15:45</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">孙七</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            接收
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 text-sm text-gray-500">确认接收计划，将按计划执行</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            已处理
                                                        </span>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
<!-- ========================================== -->
<!-- 16 编制内控计划 (已修复结构) -->
<!-- ========================================== -->
<div id="activity-16" class="activity-section hidden">
    <div class="bg-white rounded-lg shadow mb-6">
        <div class="p-6 border-b border-gray-200">
            <h3 class="text-lg font-medium text-gray-800">16 MRP需求中心</h3>
            <p class="text-sm text-gray-500 mt-1">MRP 运算中心、净需求计算页</p>
        </div>
        <div class="p-6">
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                <ul class="list-disc pl-5 text-sm text-gray-600">
                    <li>净需求计算：执行MRP逻辑，计算订单需求扣减虚拟储备后的净需求</li>
                    <li>单据拆分：生成对应领料单（抵消量）和生产单（净需求）</li>
                </ul>
            </div>
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-gray-50 p-4 rounded">
                        <p class="text-sm font-medium text-gray-700">输入</p>
                        <p class="text-sm text-gray-600">计划数据、虚拟库存数据</p>
                    </div>
                    <div class="bg-gray-50 p-4 rounded">
                        <p class="text-sm font-medium text-gray-700">输出</p>
                        <p class="text-sm text-gray-600">拆分后的MO（领料单/生产单）</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MRP运算向导 -->
    <div class="bg-white rounded-lg shadow">
        <div class="p-6 border-b border-gray-200 flex justify-between items-center">
            <h3 class="text-lg font-medium text-gray-800">MRP运算向导</h3>
            <div class="flex items-center">
                <span class="text-sm text-gray-600 mr-4">步骤:</span>
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center text-sm font-medium">1</div>
                    <div class="w-12 h-1 bg-gray-300"></div>
                    <div class="w-8 h-8 rounded-full bg-gray-300 text-white flex items-center justify-center text-sm font-medium">2</div>
                    <div class="w-12 h-1 bg-gray-300"></div>
                    <div class="w-8 h-8 rounded-full bg-gray-300 text-white flex items-center justify-center text-sm font-medium">3</div>
                </div>
            </div>
        </div>
        <div class="p-6">
            <!-- Step 1: 库存快照选择 -->
            <div id="mrp-step-1" class="mrp-step active">
                <h4 class="text-lg font-medium text-gray-800 mb-4">Step 1: 选择库存快照</h4>
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 mb-6">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">可用库存快照</label>
                        <select id="inventory-snapshot-select" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">请选择库存快照...</option>
                            <option value="snapshot-20250721-0800">2025-07-21 08:00 (最新)</option>
                            <option value="snapshot-20250720-2000">2025-07-20 20:00</option>
                            <option value="snapshot-20250720-0800">2025-07-20 08:00</option>
                            <option value="snapshot-20250719-2000">2025-07-19 20:00</option>
                        </select>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                        <div class="bg-white p-3 rounded border border-gray-200">
                            <p class="text-xs text-gray-500">快照时间</p>
                            <p class="text-sm font-medium text-gray-900" id="snapshot-time">-</p>
                        </div>
                        <div class="bg-white p-3 rounded border border-gray-200">
                            <p class="text-xs text-gray-500">虚拟库存总量</p>
                            <p class="text-sm font-medium text-gray-900" id="virtual-inventory-total">-</p>
                        </div>
                        <div class="bg-white p-3 rounded border border-gray-200">
                            <p class="text-xs text-gray-500">待处理订单数</p>
                            <p class="text-sm font-medium text-gray-900" id="pending-orders">-</p>
                        </div>
                    </div>
                    <div class="flex justify-end">
                        <button id="create-new-snapshot-btn" class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all mr-2">
                            <i class="fa fa-plus mr-1"></i> 创建新快照
                        </button>
                        <button id="next-to-step-2-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all" disabled>
                            下一步 <i class="fa fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Step 2: 计算按钮 -->
            <div id="mrp-step-2" class="mrp-step hidden">
                <h4 class="text-lg font-medium text-gray-800 mb-4">Step 2: 执行MRP计算</h4>
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 mb-6">
                    <div class="mb-6">
                        <h5 class="text-md font-medium text-gray-700 mb-2">计算参数</h5>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">计算模式</label>
                                <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <option value="full">全量计算</option>
                                    <option value="incremental">增量计算</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">覆盖策略</label>
                                <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <option value="overwrite">覆盖现有结果</option>
                                    <option value="merge">合并到现有结果</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">预留缓冲量</label>
                                <input type="number" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" value="5" min="0" max="100">
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-between">
                        <button id="back-to-step-1-btn" class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all">
                            <i class="fa fa-arrow-left mr-1"></i> 上一步
                        </button>
                        <button id="execute-calculation-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all">
                            <i class="fa fa-calculator mr-1"></i> 执行计算
                        </button>
                    </div>
                </div>
            </div>

            <!-- Step 3: 结果展示 -->
            <div id="mrp-step-3" class="mrp-step hidden">
                <h4 class="text-lg font-medium text-gray-800 mb-4">Step 3: MRP计算结果</h4>
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 mb-6">
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-2">
                            <h5 class="text-md font-medium text-gray-700">计算结果概览</h5>
                            <span class="text-xs text-gray-500">计算完成时间: 2025-07-21 09:15:32</span>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div class="bg-white p-3 rounded border border-gray-200">
                                <p class="text-xs text-gray-500">处理订单数</p>
                                <p class="text-sm font-medium text-gray-900">12</p>
                            </div>
                            <div class="bg-white p-3 rounded border border-gray-200">
                                <p class="text-xs text-gray-500">生成领料单</p>
                                <p class="text-sm font-medium text-gray-900">8</p>
                            </div>
                            <div class="bg-white p-3 rounded border border-gray-200">
                                <p class="text-xs text-gray-500">生成生产单</p>
                                <p class="text-sm font-medium text-gray-900">15</p>
                            </div>
                            <div class="bg-white p-3 rounded border border-gray-200">
                                <p class="text-xs text-gray-500">物料覆盖率</p>
                                <p class="text-sm font-medium text-gray-900">92%</p>
                            </div>
                        </div>
                    </div>

                    <!-- 树状结果图 -->
                    <div class="mb-4">
                        <h5 class="text-md font-medium text-gray-700 mb-2">订单拆分详情</h5>
                        <div class="border border-gray-200 rounded-lg overflow-hidden">
                            <div class="bg-gray-100 p-2 border-b border-gray-200 flex justify-between items-center">
                                <div class="flex items-center">
                                    <input type="checkbox" id="select-all-orders" class="h-4 w-4 text-blue-600 rounded mr-2">
                                    <span class="text-sm font-medium text-gray-700">选择全部</span>
                                </div>
                                <div class="text-sm text-gray-600">共 12 个订单</div>
                            </div>
                            <div class="max-h-96 overflow-y-auto">
                                <!-- 订单1 -->
                                <div class="border-b border-gray-200">
                                    <div class="bg-white p-3 flex justify-between items-center cursor-pointer order-header" data-order="ORD-202507-001">
                                        <div class="flex items-center">
                                            <input type="checkbox" class="order-checkbox h-4 w-4 text-blue-600 rounded mr-2" value="ORD-202507-001">
                                            <span class="font-medium text-gray-800 mr-2">ORD-202507-001</span>
                                            <span class="text-sm text-gray-600">翅片组件</span>
                                            <span class="ml-4 px-2 py-0.5 bg-green-100 text-green-800 text-xs rounded-full">可完全覆盖</span>
                                        </div>
                                        <div class="flex items-center">
                                            <span class="text-sm text-gray-600 mr-4">需求: 1000</span>
                                            <span class="text-sm text-gray-600 mr-4">储备: 800</span>
                                            <i class="fa fa-chevron-down text-gray-500"></i>
                                        </div>
                                    </div>
                                    <div class="bg-gray-50 p-3 border-t border-gray-200 order-details hidden" data-order="ORD-202507-001">
                                        <div class="ml-8">
                                            <div class="flex items-center justify-between mb-2">
                                                <span class="text-sm font-medium text-gray-700">拆分结果:</span>
                                                <span class="text-xs text-gray-500">净需求: 200</span>
                                            </div>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div class="bg-white p-3 rounded border border-gray-200">
                                                    <div class="flex justify-between items-center mb-1">
                                                        <span class="text-sm font-medium text-gray-700">领料单</span>
                                                        <span class="text-xs text-blue-600">MO-202507-001-1</span>
                                                    </div>
                                                    <div class="text-xs text-gray-600">数量: 800 | 状态: 待审核</div>
                                                </div>
                                                <div class="bg-white p-3 rounded border border-gray-200">
                                                    <div class="flex justify-between items-center mb-1">
                                                        <span class="text-sm font-medium text-gray-700">生产单</span>
                                                        <span class="text-xs text-blue-600">MO-202507-001-2</span>
                                                    </div>
                                                    <div class="text-xs text-gray-600">数量: 200 | 状态: 待审核</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- 更多订单项... -->
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-between">
                        <button id="back-to-step-2-btn" class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all">
                            <i class="fa fa-arrow-left mr-1"></i> 上一步
                        </button>
                        <div>
                            <button id="export-results-btn" class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all mr-2">
                                <i class="fa fa-download mr-1"></i> 导出结果
                            </button>
                            <button id="confirm-split-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all">
                                <i class="fa fa-check mr-1"></i> 确认拆分
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- 注意：这里之前有多余的工序代码，已经被清理 -->

<!-- ========================================== -->
<!-- 17 编制物料需求 (已修复结构) -->
<!-- ========================================== -->
<div id="activity-17" class="activity-section hidden">
    <div class="bg-white rounded-lg shadow mb-6">
        <div class="p-6 border-b border-gray-200">
            <h3 class="text-lg font-medium text-gray-800">17 物料需求监控</h3>
            <p class="text-sm text-gray-500 mt-1">物料需求计划、长交期物料算料页</p>
        </div>
        <div class="p-6">
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                <ul class="list-disc pl-5 text-sm text-gray-600">
                    <li>物料分解：基于净生产任务BOM，按物料类型汇总需求</li>
                    <li>数据展示：按"铝箔/铜管"等类别展示原材料总需求量</li>
                </ul>
            </div>
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-gray-50 p-4 rounded">
                        <p class="text-sm font-medium text-gray-700">输入</p>
                        <p class="text-sm text-gray-600">拆分后的MO数据、BOM数据</p>
                    </div>
                    <div class="bg-gray-50 p-4 rounded">
                        <p class="text-sm font-medium text-gray-700">输出</p>
                        <p class="text-sm text-gray-600">物料总需表</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 物料需求汇总页面 -->
    <div class="bg-white rounded-lg shadow">
        <div class="p-6 border-b border-gray-200 flex justify-between items-center">
            <h3 class="text-lg font-medium text-gray-800">物料需求汇总</h3>
            <div class="flex space-x-2">
                <button id="export-material-summary-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                    <i class="fa fa-download mr-1"></i> 导出
                </button>
                <button id="refresh-material-data-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all">
                    <i class="fa fa-refresh mr-1"></i> 刷新数据
                </button>
            </div>
        </div>
        <div class="p-6">
            <!-- 汇总概览 -->
            <div class="mb-8">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="bg-blue-50 p-4 rounded-lg border border-blue-100">
                        <p class="text-sm text-gray-500">总物料种类</p>
                        <p class="text-2xl font-bold text-blue-600">12</p>
                    </div>
                    <div class="bg-green-50 p-4 rounded-lg border border-green-100">
                        <p class="text-sm text-gray-500">原材料总量</p>
                        <p class="text-2xl font-bold text-green-600">5,280</p>
                        <p class="text-xs text-gray-500">单位: kg</p>
                    </div>
                    <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-100">
                        <p class="text-sm text-gray-500">零部件总量</p>
                        <p class="text-2xl font-bold text-yellow-600">1,850</p>
                        <p class="text-xs text-gray-500">单位: 个</p>
                    </div>
                    <div class="bg-purple-50 p-4 rounded-lg border border-purple-100">
                        <p class="text-sm text-gray-500">长交期物料</p>
                        <p class="text-2xl font-bold text-purple-600">3</p>
                    </div>
                </div>
            </div>

            <!-- 物料分组列表 -->
            <div class="space-y-4">
                <!-- 铝箔分组 -->
                <div class="border border-gray-200 rounded-lg overflow-hidden">
                    <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center group-header cursor-pointer" data-group="aluminum">
                        <div class="flex items-center">
                            <i class="fa fa-chevron-down text-gray-500 mr-2 transform transition-transform"></i>
                            <h4 class="text-md font-medium text-gray-700">铝箔</h4>
                            <span class="ml-2 px-2 py-0.5 bg-blue-100 text-blue-800 text-xs rounded-full">原材料</span>
                        </div>
                        <div class="flex items-center">
                            <span class="text-sm text-gray-600 mr-4">总需求量: <span class="font-medium">2,850 kg</span></span>
                            <span class="text-sm text-gray-600">包含: <span class="font-medium">3</span> 项物料</span>
                        </div>
                    </div>
                    <div class="group-details hidden" data-group="aluminum">
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料编码</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料名称</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">规格</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">单位</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">总需求量</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">需求日期</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">交期状态</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                                    <tr>
                                        <td class="px-4 py-3 text-sm text-gray-900">AL-1001</td>
                                        <td class="px-4 py-3 text-sm text-gray-500">铝箔卷</td>
                                        <td class="px-4 py-3 text-sm text-gray-500">0.08mm*1200mm</td>
                                        <td class="px-4 py-3 text-sm text-gray-500">kg</td>
                                        <td class="px-4 py-3 text-sm text-gray-900 font-medium">1,500</td>
                                        <td class="px-4 py-3 text-sm text-gray-500">2025-07-25</td>
                                        <td class="px-4 py-3">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                                长交期
                                            </span>
                                        </td>
                                    </tr>
                                    <!-- 更多数据行 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- 铜管分组 (略，保持代码简洁，逻辑同上) -->
                <div class="border border-gray-200 rounded-lg overflow-hidden">
                    <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center group-header cursor-pointer" data-group="copper">
                        <div class="flex items-center">
                            <i class="fa fa-chevron-down text-gray-500 mr-2 transform transition-transform"></i>
                            <h4 class="text-md font-medium text-gray-700">铜管</h4>
                            <span class="ml-2 px-2 py-0.5 bg-blue-100 text-blue-800 text-xs rounded-full">原材料</span>
                        </div>
                        <div class="flex items-center">
                             <span class="text-sm text-gray-600 mr-4">总需求量: <span class="font-medium">1,200 kg</span></span>
                        </div>
                    </div>
                    <!-- 铜管详情内容... -->
                </div>

                <!-- 其他物料 (保持你的内容不变，只要确保在div内部即可) -->
                
            </div>
        </div>
    </div>
</div>
<!-- 注意：这里之前有多余的 td 标签，已经被清理 -->                    
                    <!-- 18 物料核对 -->
                    <div id="activity-18" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">18 库存核对</h3>
                                <p class="text-sm text-gray-500 mt-1">物料管理中心、物料核对页</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>库存核对：核对实际库存与系统库存，记录差异</li>
                                        <li>物料状态确认：确认物料质量状态，标记可用/不可用</li>
                                        <li>异常处理：记录物料异常情况，提供处理建议</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">实际库存数据、质量检验结果</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">库存差异报告、物料状态更新</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 物料核对页面 -->
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-800">物料核对</h3>
                                <div class="flex space-x-2">
                                    <button id="start-check-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                        <i class="fa fa-check-square-o mr-1"></i> 开始核对
                                    </button>
                                    <button id="save-check-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all">
                                        <i class="fa fa-save mr-1"></i> 保存结果
                                    </button>
                                </div>
                            </div>
                            <div class="p-6">
                                <!-- 筛选条件 -->
                                <div class="mb-6 bg-gray-50 p-4 rounded-lg">
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">物料编码</label>
                                            <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入物料编码">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">物料名称</label>
                                            <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入物料名称">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">核对状态</label>
                                            <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="">全部状态</option>
                                                <option value="pending">待核对</option>
                                                <option value="completed">已核对</option>
                                                <option value="abnormal">异常</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mt-4 flex justify-end">
                                        <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all mr-2">
                                            重置
                                        </button>
                                        <button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                            查询
                                        </button>
                                    </div>
                                </div>

                                <!-- 物料核对列表 -->
                                <div class="border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                        <h4 class="text-md font-medium text-gray-700">物料核对列表</h4>
                                        <div class="flex items-center">
                                            <span class="text-sm text-gray-500 mr-2">共 15 项物料</span>
                                        </div>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料编码</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料名称</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">规格</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">单位</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">系统库存</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">实际库存</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">差异</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">质量状态</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">核对状态</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MES状态</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MAT-100A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">物料A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">规格A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">个</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">80</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <input type="number" class="border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" value="80">
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">0</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <select class="border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                            <option value="good" selected>良好</option>
                                                            <option value="bad">不良</option>
                                                            <option value="pending">待检验</option>
                                                        </select>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            已核对
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <button class="text-blue-600 hover:text-blue-900">确认</button>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MAT-200B</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">物料B</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">规格B</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">个</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">60</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <input type="number" class="border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" value="55">
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-red-600">-5</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <select class="border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                            <option value="good" selected>良好</option>
                                                            <option value="bad">不良</option>
                                                            <option value="pending">待检验</option>
                                                        </select>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                                            异常
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <button class="text-blue-600 hover:text-blue-900">确认</button>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MAT-300C</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">物料C</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">规格C</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">个</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">70</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <input type="number" class="border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">-</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <select class="border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                            <option value="good">良好</option>
                                                            <option value="bad">不良</option>
                                                            <option value="pending" selected>待检验</option>
                                                        </select>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                            待核对
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <button class="text-blue-600 hover:text-blue-900">确认</button>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200">
                                        <div class="text-sm text-gray-700">
                                            显示 <span class="font-medium">1</span> 到 <span class="font-medium">3</span> 条，共 <span class="font-medium">15</span> 条
                                        </div>
                                        <div class="flex space-x-2">
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 disabled:opacity-50" disabled>
                                                上一页
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm bg-blue-50 text-blue-600">
                                                1
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                2
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                3
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                4
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                5
                                            </button>
                                            <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                下一页
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 19 反馈物料状态 -->
                    <div id="activity-19" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">19 物料状态反馈</h3>
                                <p class="text-sm text-gray-500 mt-1">物料管理中心、物料状态反馈页</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>状态反馈：反馈物料准备状态，包括可用、短缺、质量问题等</li>
                                        <li>影响评估：评估物料状态对生产计划的影响</li>
                                        <li>处理建议：提供物料问题的处理建议</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">物料状态、问题描述</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">物料状态报告、影响评估</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 物料状态反馈页面 -->
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-800">物料状态反馈</h3>
                                <div class="flex space-x-2">
                                    <button id="submit-status-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                        <i class="fa fa-paper-plane mr-1"></i> 提交反馈
                                    </button>
                                    <button id="export-status-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all">
                                        <i fa fa-download mr-1"></i> 导出报告
                                    </button>
                                </div>
                            </div>
                            <div class="p-6">
                                <!-- 筛选条件 -->
                                <div class="mb-6 bg-gray-50 p-4 rounded-lg">
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">计划编号</label>
                                            <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="MP-202507-001" selected>MP-202507-001</option>
                                                <option value="MP-202507-002">MP-202507-002</option>
                                                <option value="MP-202507-003">MP-202507-003</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">物料编码</label>
                                            <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入物料编码">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">物料状态</label>
                                            <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="">全部状态</option>
                                                <option value="available">可用</option>
                                                <option value="shortage">短缺</option>
                                                <option value="quality">质量问题</option>
                                                <option value="pending">待确认</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mt-4 flex justify-end">
                                        <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all mr-2">
                                            重置
                                        </button>
                                        <button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                            查询
                                        </button>
                                    </div>
                                </div>

                                <!-- 物料状态列表 -->
                                <div class="mb-6">
                                    <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                        <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                            <h4 class="text-md font-medium text-gray-700">物料状态列表</h4>
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-500 mr-2">共 10 项物料</span>
                                            </div>
                                        </div>
                                        <div class="overflow-x-auto">
                                            <table class="min-w-full divide-y divide-gray-200">
                                                <thead class="bg-gray-50">
                                                    <tr>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料编码</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料名称</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">规格</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">单位</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">需求数量</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">可用数量</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料状态</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">问题描述</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">处理建议</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MES状态</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="bg-white divide-y divide-gray-200">
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MAT-100A</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">物料A</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">规格A</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">个</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">150</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">150</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                                可用
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 text-sm text-gray-500">-</td>
                                                        <td class="px-6 py-4 text-sm text-gray-500">-</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <button class="text-blue-600 hover:text-blue-900">编辑</button>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MAT-200B</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">物料B</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">规格B</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">个</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">90</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">55</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                                                短缺
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 text-sm text-gray-500">库存不足，短缺35个</td>
                                                        <td class="px-6 py-4 text-sm text-gray-500">紧急采购</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <button class="text-blue-600 hover:text-blue-900">编辑</button>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MAT-300C</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">物料C</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">规格C</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">个</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">60</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">60</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                                质量问题
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 text-sm text-gray-500">部分物料存在质量问题，约10个</td>
                                                        <td class="px-6 py-4 text-sm text-gray-500">挑选使用，同时安排退换货</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <button class="text-blue-600 hover:text-blue-900">编辑</button>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200">
                                            <div class="text-sm text-gray-700">
                                                显示 <span class="font-medium">1</span> 到 <span class="font-medium">3</span> 条，共 <span class="font-medium">10</span> 条
                                            </div>
                                            <div class="flex space-x-2">
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 disabled:opacity-50" disabled>
                                                    上一页
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm bg-blue-50 text-blue-600">
                                                    1
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    2
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    3
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    4
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    下一页
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 影响评估 -->
                                <div class="border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="bg-gray-50 p-4 border-b border-gray-200">
                                        <h4 class="text-md font-medium text-gray-700">物料状态对生产计划的影响评估</h4>
                                    </div>
                                    <div class="p-6">
                                        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4">
                                            <div class="flex">
                                                <div class="flex-shrink-0">
                                                    <i class="fa fa-exclamation-triangle text-yellow-400"></i>
                                                </div>
                                                <div class="ml-3">
                                                    <p class="text-sm text-yellow-700">
                                                        有 2 项物料存在问题，可能影响生产计划的正常执行。
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="mb-4">
                                            <h5 class="text-sm font-medium text-gray-700 mb-2">受影响的生产任务</h5>
                                            <ul class="list-disc pl-5 text-sm text-gray-600 space-y-1">
                                                <li>任务1-1（组件A）：可能延期1-2天</li>
                                                <li>任务2-1（组件B）：可能延期2-3天</li>
                                            </ul>
                                        </div>
                                        <div>
                                            <h5 class="text-sm font-medium text-gray-700 mb-2">建议措施</h5>
                                            <ul class="list-disc pl-5 text-sm text-gray-600 space-y-1">
                                                <li>对物料B启动紧急采购流程，争取在7月22日前到货</li>
                                                <li>对物料C进行质量挑选，确保可用数量满足生产需求</li>
                                                <li>考虑调整生产计划，优先生产不受影响的任务</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 20 内控计划下发 (升级为: 任务释放页) -->
<div id="activity-20" class="activity-section hidden">
    <div class="bg-white rounded-lg shadow mb-6">
        <div class="p-6 border-b border-gray-200">
            <h3 class="text-lg font-medium text-gray-800">20 内控计划下发</h3>
            <p class="text-sm text-gray-500 mt-1">任务释放控制台</p>
        </div>
        <div class="p-6">
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                <ul class="list-disc pl-5 text-sm text-gray-600">
                    <li>任务筛选：支持按上线时间、齐套状态筛选合格的待排任务。</li>
                    <li>任务释放：批量释放工艺完整、物料齐套的净需求任务至排产系统。</li>
                    <li>约束控制：缺料或工艺缺失的任务自动锁定，不可释放。</li>
                </ul>
            </div>
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-gray-50 p-4 rounded">
                        <p class="text-sm font-medium text-gray-700">输入</p>
                        <p class="text-sm text-gray-600">处理后的 MO (净需求) 数据</p>
                    </div>
                    <div class="bg-gray-50 p-4 rounded">
                        <p class="text-sm font-medium text-gray-700">输出</p>
                        <p class="text-sm text-gray-600">排产池待排数据</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 任务释放控制台 -->
    <div class="bg-white rounded-lg shadow">
        <div class="p-6 border-b border-gray-200 flex justify-between items-center">
            <h3 class="text-lg font-medium text-gray-800">待释放任务池</h3>
            <div class="flex space-x-2">
                <button id="select-all-tasks-btn" class="px-4 py-2 bg-gray-100 text-gray-700 border border-gray-300 rounded hover:bg-gray-200 transition-all text-sm">
                    <i class="fa fa-check-square-o mr-1"></i> 全选合格
                </button>
                <button id="release-to-aps-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all shadow-sm">
                    <i class="fa fa-paper-plane mr-1"></i> 释放至排程
                </button>
            </div>
        </div>
        
        <div class="p-6">
            <!-- 筛选区 -->
            <div class="mb-6 bg-gray-50 p-4 rounded-lg border border-gray-200">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">上线日期 (Start)</label>
                        <input type="date" id="filter-start-date" class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" value="2025-07-21">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">上线日期 (End)</label>
                        <input type="date" id="filter-end-date" class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" value="2025-07-27">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">齐套状态</label>
                        <select id="filter-kit-status" class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="all">全部</option>
                            <option value="ready" selected>已齐套</option>
                            <option value="short">缺料</option>
                        </select>
                    </div>
                    <div>
                        <button id="filter-tasks-btn" class="w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all text-sm">
                            <i class="fa fa-filter mr-1"></i> 筛选任务
                        </button>
                    </div>
                </div>
            </div>

            <!-- 任务列表 -->
            <div class="overflow-x-auto border border-gray-200 rounded-lg">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-10">
                                <input type="checkbox" id="header-checkbox" class="h-4 w-4 text-blue-600 rounded cursor-pointer">
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MO编号</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料编码</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料名称</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">计划上线日期</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数量</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">齐套状态</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">工艺完整性</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200" id="release-task-tbody">
                        <!-- 任务 1: 合格 -->
                        <tr class="hover:bg-gray-50">
                            <td class="px-6 py-4 whitespace-nowrap">
                                <input type="checkbox" class="task-checkbox h-4 w-4 text-blue-600 rounded cursor-pointer" value="MO-202507-001">
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600">MO-202507-001</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">COMP-100A</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">蒸发器组件</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2025-07-22</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">200</td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 border border-green-200">
                                    <i class="fa fa-check mr-1 mt-0.5"></i> 已齐套
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                <i class="fa fa-check-circle text-green-500"></i> 完整
                            </td>
                        </tr>

                        <!-- 任务 2: 缺料 (不可选) -->
                        <tr class="bg-red-50/30">
                            <td class="px-6 py-4 whitespace-nowrap">
                                <input type="checkbox" class="task-checkbox h-4 w-4 text-gray-300 rounded cursor-not-allowed" disabled title="缺料不可释放">
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-500">MO-202507-002</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">COMP-200B</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">冷凝器组件</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-23</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">150</td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800 border border-red-200">
                                    <i class="fa fa-warning mr-1 mt-0.5"></i> 缺料
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                <i class="fa fa-check-circle text-green-500"></i> 完整
                            </td>
                        </tr>

                        <!-- 任务 3: 合格 -->
                        <tr class="hover:bg-gray-50">
                            <td class="px-6 py-4 whitespace-nowrap">
                                <input type="checkbox" class="task-checkbox h-4 w-4 text-blue-600 rounded cursor-pointer" value="MO-202507-003">
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600">MO-202507-003</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">COMP-300C</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">连接管组件</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2025-07-24</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">500</td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 border border-green-200">
                                    <i class="fa fa-check mr-1 mt-0.5"></i> 已齐套
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                <i class="fa fa-check-circle text-green-500"></i> 完整
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="mt-4 flex justify-between items-center text-sm text-gray-500">
                <div id="selection-count-text">已选择 0 项任务</div>
                <div class="flex space-x-1">
                    <button class="px-2 py-1 border rounded hover:bg-gray-50">上一页</button>
                    <button class="px-2 py-1 border rounded hover:bg-gray-50">下一页</button>
                </div>
            </div>
        </div>
    </div>
</div>

                    <!-- 21 下发外购+自制 -->
                    <div id="activity-21" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">21 外购订单下发</h3>
                                <p class="text-sm text-gray-500 mt-1">采购管理中心、采购计划下发页</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>采购计划生成：根据物料需求计划生成采购计划</li>
                                        <li>供应商分配：自动或手动为采购项分配供应商</li>
                                        <li>采购订单下发：向供应商下发采购订单</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">物料需求计划、供应商信息</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">采购计划、采购订单</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 采购计划下发页面 -->
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-800">采购计划下发</h3>
                                <div class="flex space-x-2">
                                    <button id="generate-po-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                        <i class="fa fa-file-text-o mr-1"></i> 生成采购订单
                                    </button>
                                    <button id="issue-po-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all">
                                        <i class="fa fa-paper-plane mr-1"></i> 下发采购订单
                                    </button>
                                </div>
                            </div>
                            <div class="p-6">
                                <!-- 筛选条件 -->
                                <div class="mb-6 bg-gray-50 p-4 rounded-lg">
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">采购计划编号</label>
                                            <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="PP-202507-001" selected>PP-202507-001</option>
                                                <option value="PP-202507-002">PP-202507-002</option>
                                                <option value="PP-202507-003">PP-202507-003</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">物料编码</label>
                                            <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入物料编码">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">供应商</label>
                                            <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="">全部供应商</option>
                                                <option value="supplier1">供应商A</option>
                                                <option value="supplier2">供应商B</option>
                                                <option value="supplier3">供应商C</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mt-4 flex justify-end">
                                        <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all mr-2">
                                            重置
                                        </button>
                                        <button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                            查询
                                        </button>
                                    </div>
                                </div>

                                <!-- 采购计划列表 -->
                                <div class="mb-6">
                                    <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                        <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                            <h4 class="text-md font-medium text-gray-700">采购计划列表</h4>
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-500 mr-2">共 8 项物料</span>
                                            </div>
                                        </div>
                                        <div class="overflow-x-auto">
                                            <table class="min-w-full divide-y divide-gray-200">
                                                <thead class="bg-gray-50">
                                                    <tr>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料编码</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料名称</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">规格</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">单位</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">采购数量</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">供应商</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">预计到货日期</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">采购订单号</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MES状态</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="bg-white divide-y divide-gray-200">
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MAT-100A</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">物料A</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">规格A</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">个</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">100</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <select class="border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                                <option value="supplier1" selected>供应商A</option>
                                                                <option value="supplier2">供应商B</option>
                                                                <option value="supplier3">供应商C</option>
                                                            </select>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <input type="date" class="border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" value="2025-07-15">
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">PO-202507-001</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                                已下发
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看</a>
                                                            <a href="#" class="text-blue-600 hover:text-blue-900">导出</a>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MAT-200B</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">物料B</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">规格B</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">个</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">50</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <select class="border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                                <option value="supplier1">供应商A</option>
                                                                <option value="supplier2" selected>供应商B</option>
                                                                <option value="supplier3">供应商C</option>
                                                            </select>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <input type="date" class="border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" value="2025-07-16">
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">PO-202507-002</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                                待下发
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看</a>
                                                            <a href="#" class="text-blue-600 hover:text-blue-900">导出</a>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MAT-300C</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">物料C</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">规格C</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">个</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">5</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <select class="border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                                <option value="supplier1">供应商A</option>
                                                                <option value="supplier2">供应商B</option>
                                                                <option value="supplier3" selected>供应商C</option>
                                                            </select>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <input type="date" class="border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" value="2025-07-17">
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">PO-202507-003</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                                待下发
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看</a>
                                                            <a href="#" class="text-blue-600 hover:text-blue-900">导出</a>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200">
                                            <div class="text-sm text-gray-700">
                                                显示 <span class="font-medium">1</span> 到 <span class="font-medium">3</span> 条，共 <span class="font-medium">8</span> 条
                                            </div>
                                            <div class="flex space-x-2">
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 disabled:opacity-50" disabled>
                                                    上一页
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm bg-blue-50 text-blue-600">
                                                    1
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    2
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    3
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    下一页
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 采购订单下发历史 -->
                                <div class="border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="bg-gray-50 p-4 border-b border-gray-200">
                                        <h4 class="text-md font-medium text-gray-700">采购订单下发历史</h4>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">采购订单号</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">供应商</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">下发时间</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">下发人</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料项数</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">总金额</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MES状态</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">PO-202507-001</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">供应商A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-10 14:30</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">张三</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">1</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">¥10,000.00</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            已确认
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看</a>
                                                        <a href="#" class="text-blue-600 hover:text-blue-900">导出</a>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">PO-202507-002</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">供应商B</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-10 14:30</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">张三</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">1</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">¥5,000.00</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                            待确认
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看</a>
                                                        <a href="#" class="text-blue-600 hover:text-blue-900">导出</a>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

    <!-- 22 智能排程工作台 (完整文档 + 深度交互版) -->
<div id="activity-22" class="activity-section hidden">
    <div class="bg-white rounded-lg shadow mb-6">
        <div class="p-6 border-b border-gray-200">
            <h3 class="text-lg font-medium text-gray-800">22 智能排产台</h3>
            <p class="text-sm text-gray-500 mt-1">APS 智能排程模块、智能排程工作台</p>
        </div>
        <div class="p-6">
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                <ul class="list-disc pl-5 text-sm text-gray-600 space-y-1">
                    <li><strong>预处理-自动并单：</strong>排产前，先执行 Act 25 定义的并单规则（如：数量&lt;100且在5天内），生成合并MO票，减少碎片化换产。</li>
                    <li><strong>有限能力排程 ：</strong>
                        <ul class="list-circle pl-5 mt-1 text-gray-500">
                            <li>优先级逻辑：读取 Act 25 的属性优先级矩阵（如：30孔以上优先5#）。</li>
                            <li>聚类优化：在 T+3 窗口内，优先聚合同排数/同孔数/同颜色的订单。</li>
                            <li>换型计算：读取 Act 25 的换型矩阵，自动识别大模（14h）与子模（2h）差异，插入对应耗时。</li>
                        </ul>
                    </li>
                    <li><strong>自动拆单 (Split)：</strong>当首选机台产能不足以满足交期时，自动按 Min_Split_Qty 拆分任务至备选机台。</li>
                    <li><strong>工序，模具联动校验：</strong>
                        <ul class="list-circle pl-5 mt-1 text-gray-500">
                            <li>工序联动：冲床排定后，自动焊任务自动跟随（特定机台生产跟随特定工序）。</li>
                            <li>模具冲突：实时校验模具总数，若耗尽，禁止并行拆单，强制错开时间。</li>
                        </ul>
                    </li>
                </ul>
            </div>
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-gray-50 p-4 rounded border border-gray-100">
                        <p class="text-sm font-medium text-gray-700">输入</p>
                        <p class="text-sm text-gray-600 mt-1">待排任务池、Act 25 资源模型（机台/模具）、Act 26 产能公式</p>
                    </div>
                    <div class="bg-gray-50 p-4 rounded border border-gray-100">
                        <p class="text-sm font-medium text-gray-700">输出</p>
                        <p class="text-sm text-gray-600 mt-1">联动甘特图方案、排产结果表（锁定版）</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 智能排程工作台界面 -->
    <div class="flex h-[850px] gap-4">
        <!-- 左侧：排程策略配置区 -->
        <div class="w-80 bg-white rounded-lg shadow flex flex-col border border-gray-200">
            <div class="p-4 border-b border-gray-200 bg-gray-50 rounded-t-lg">
                <h4 class="text-md font-bold text-gray-800"><i class="fa fa-sliders mr-2"></i>排程策略配置</h4>
            </div>
            <div class="p-4 flex-1 overflow-y-auto space-y-6">
                <!-- 1. 预处理：并单规则 -->
                <div class="border-b border-dashed border-gray-200 pb-4">
                    <h5 class="text-sm font-bold text-gray-700 mb-3 flex items-center">
                        <span class="w-1.5 h-1.5 bg-blue-600 rounded-full mr-2"></span>1. 自动并单规则
                    </h5>
                    <div class="bg-blue-50 p-3 rounded text-xs space-y-3">
                        <label class="flex items-center cursor-pointer">
                            <input type="checkbox" checked class="form-checkbox h-3 w-3 text-blue-600 rounded">
                            <span class="ml-2 font-medium">启用小单合并</span>
                        </label>
                        <div class="flex items-center justify-between">
                            <span class="text-gray-600">数量阈值 <</span>
                            <div class="flex items-center">
                                <input type="number" class="w-14 h-7 text-center border rounded border-gray-300 focus:border-blue-500" value="100">
                                <span class="ml-1 text-gray-500">台</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-gray-600">合并时间窗</span>
                            <div class="flex items-center">
                                <input type="number" class="w-14 h-7 text-center border rounded border-gray-300 focus:border-blue-500" value="5">
                                <span class="ml-1 text-gray-500">天</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 2. 排序逻辑：优先级权重 -->
                <div class="border-b border-dashed border-gray-200 pb-4">
                    <h5 class="text-sm font-bold text-gray-700 mb-3 flex items-center">
                        <span class="w-1.5 h-1.5 bg-blue-600 rounded-full mr-2"></span>2. 优先级权重
                    </h5>
                    <div class="space-y-4 text-xs">
                        <div>
                            <div class="flex justify-between mb-1">
                                <span class="text-gray-600">交期紧迫度 (DDate)</span>
                                <span class="font-bold text-blue-600">80%</span>
                            </div>
                            <input type="range" class="w-full h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600" min="0" max="100" value="80">
                        </div>
                        <div>
                            <div class="flex justify-between mb-1">
                                <span class="text-gray-600">属性聚类 (同模/同色)</span>
                                <span class="font-bold text-blue-600">60%</span>
                            </div>
                            <input type="range" class="w-full h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600" min="0" max="100" value="60">
                        </div>
                        <div>
                            <div class="flex justify-between mb-1">
                                <span class="text-gray-600">换型最小化 (Setup)</span>
                                <span class="font-bold text-blue-600">90%</span>
                            </div>
                            <input type="range" class="w-full h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600" min="0" max="100" value="90">
                        </div>
                    </div>
                </div>

                <!-- 3. 约束控制 -->
                <div>
                    <h5 class="text-sm font-bold text-gray-700 mb-3 flex items-center">
                        <span class="w-1.5 h-1.5 bg-blue-600 rounded-full mr-2"></span>3. 资源约束
                    </h5>
                    <div class="space-y-2 text-xs">
                        <div class="flex items-center justify-between p-2 bg-gray-50 rounded border border-gray-200">
                            <span class="text-gray-600">模具硬约束</span>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" checked class="sr-only peer">
                                <div class="w-9 h-5 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-green-600"></div>
                            </label>
                        </div>
                        <div class="flex items-center justify-between p-2 bg-gray-50 rounded border border-gray-200">
                            <span class="text-gray-600">允许自动拆单</span>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" checked class="sr-only peer">
                                <div class="w-9 h-5 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"></div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="p-4 border-t border-gray-200 bg-gray-50 rounded-b-lg">
                <button id="apply-strategy-btn" class="w-full py-2.5 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition-all shadow-md text-sm font-bold flex items-center justify-center">
                    <i class="fa fa-magic mr-2"></i> 应用策略并重排
                </button>
            </div>
        </div>

        <!-- 右侧：智能甘特图 -->
        <div class="flex-1 bg-white rounded-lg shadow flex flex-col overflow-hidden border border-gray-200">
            <!-- 顶部操作栏 -->
            <div class="px-4 py-3 border-b border-gray-200 flex justify-between items-center bg-white shadow-sm z-20">
                <div class="flex space-x-6 text-xs font-medium text-gray-600">
                    <span class="flex items-center"><span class="w-3 h-3 bg-blue-500 mr-1.5 rounded shadow-sm"></span> 冲床任务</span>
                    <span class="flex items-center"><span class="w-3 h-3 bg-green-100 border border-green-400 mr-1.5 rounded shadow-sm"></span> 自动焊 (联动)</span>
                    <span class="flex items-center"><span class="w-3 h-3 bg-red-500 mr-1.5 rounded shadow-sm animate-pulse"></span> 资源冲突</span>
                    <span class="flex items-center"><i class="fa fa-link text-purple-500 mr-1.5"></i> 并单任务</span>
                </div>
                <div class="flex space-x-2">
                    <div class="flex border border-gray-300 rounded overflow-hidden">
                        <button class="px-3 py-1.5 hover:bg-gray-50 border-r border-gray-300" title="缩小"><i class="fa fa-search-minus text-gray-500"></i></button>
                        <button class="px-3 py-1.5 hover:bg-gray-50" title="放大"><i class="fa fa-search-plus text-gray-500"></i></button>
                    </div>
                    <button id="lock-plan-btn" class="px-4 py-1.5 bg-green-600 text-white rounded hover:bg-green-700 text-xs font-bold shadow-sm transition-all">
                        <i class="fa fa-lock mr-1"></i> 锁定结果
                    </button>
                </div>
            </div>

            <!-- 甘特图绘图区 -->
            <div class="flex-1 overflow-auto relative bg-gray-50" id="gantt-chart-area">
                <!-- 时间刻度 (Header) -->
                <div class="flex sticky top-0 z-10 bg-white border-b border-gray-300 shadow-sm h-9">
                    <div class="w-36 flex-shrink-0 border-r border-gray-200 bg-gray-100 flex items-center justify-center text-xs font-bold text-gray-700">资源 \ 时间</div>
                    <div class="flex-1 flex" id="gantt-timeline-days">
                        <div class="flex-1 border-r text-center text-xs text-gray-500 py-2.5 font-medium">07/21 (一)</div>
                        <div class="flex-1 border-r text-center text-xs text-gray-500 py-2.5 font-medium">07/22 (二)</div>
                        <div class="flex-1 border-r text-center text-xs text-gray-500 py-2.5 font-medium">07/23 (三)</div>
                        <div class="flex-1 border-r text-center text-xs text-gray-500 py-2.5 font-medium">07/24 (四)</div>
                        <div class="flex-1 border-r text-center text-xs text-gray-500 py-2.5 font-medium">07/25 (五)</div>
                        <div class="flex-1 border-r text-center text-xs text-gray-500 py-2.5 font-medium">07/26 (六)</div>
                        <div class="flex-1 border-r text-center text-xs text-gray-500 py-2.5 font-medium">07/27 (日)</div>
                    </div>
                </div>

                <!-- 资源泳道 (Body) -->
                <div class="relative">
                    <!-- 背景网格 -->
                    <div class="absolute inset-0 flex pl-36 pointer-events-none">
                        <div class="flex-1 border-r border-dashed border-gray-200"></div>
                        <div class="flex-1 border-r border-dashed border-gray-200"></div>
                        <div class="flex-1 border-r border-dashed border-gray-200"></div>
                        <div class="flex-1 border-r border-dashed border-gray-200"></div>
                        <div class="flex-1 border-r border-dashed border-gray-200"></div>
                        <div class="flex-1 border-r border-dashed border-gray-200"></div>
                        <div class="flex-1"></div>
                    </div>

                    <!-- 泳道 1: 5# 冲床 (优先机台) -->
                    <div class="flex h-32 border-b border-gray-200 relative group hover:bg-gray-50 transition-colors">
                        <div class="w-36 flex-shrink-0 border-r border-gray-200 p-3 flex flex-col justify-center bg-white z-10">
                            <span class="text-sm font-bold text-gray-800">5# 冲床</span>
                            <span class="text-xs text-green-600 bg-green-50 px-1.5 py-0.5 rounded mt-1 inline-block w-fit">状态: 正常</span>
                            <span class="text-[10px] text-gray-400 mt-1">能力: 窗片/小</span>
                        </div>
                        <div class="flex-1 relative py-2">
                            <!-- 任务 A: 并单任务 -->
                            <div class="absolute h-10 bg-blue-600 rounded shadow-md cursor-move flex items-center px-2 text-white text-xs border-l-4 border-blue-800 task-item group/task hover:brightness-110 transition-all"
                                 style="left: 2%; width: 25%; top: 12px;"
                                 data-id="GRP-001"
                                 title="并单任务 (3个子单合并)">
                                <div class="flex flex-col w-full overflow-hidden">
                                    <span class="font-bold flex items-center"><i class="fa fa-link mr-1 text-purple-200"></i> GRP-001</span>
                                    <span class="opacity-80 scale-90 origin-left truncate">合并: 3单</span>
                                </div>
                            </div>
                            
                            <!-- 联动任务: 自动焊 (半透明虚线连接) -->
                            <div class="absolute h-8 bg-green-50 border border-green-400 border-dashed rounded flex items-center px-2 text-green-700 text-xs opacity-70"
                                 style="left: 15%; width: 25%; top: 60px;"
                                 title="联动工序: 自动焊">
                                <i class="fa fa-chain mr-1"></i> 自动焊 (跟随)
                            </div>
                            
                            <!-- 联动连接线 (示意) -->
                            <div class="absolute border-l border-b border-gray-400 opacity-30 pointer-events-none" 
                                 style="left: 14%; top: 32px; width: 1%; height: 28px; border-bottom-left-radius: 8px;"></div>
                        </div>
                    </div>

                    <!-- 泳道 2: 6# 冲床 -->
                    <div class="flex h-32 border-b border-gray-200 relative group hover:bg-gray-50 transition-colors">
                        <div class="w-36 flex-shrink-0 border-r border-gray-200 p-3 flex flex-col justify-center bg-white z-10">
                            <span class="text-sm font-bold text-gray-800">6# 冲床</span>
                            <span class="text-xs text-gray-500 bg-gray-100 px-1.5 py-0.5 rounded mt-1 inline-block w-fit">状态: 备选</span>
                            <span class="text-[10px] text-gray-400 mt-1">能力: 波片/大</span>
                        </div>
                        <div class="flex-1 relative py-2">
                            <!-- 任务 B: 冲突任务 -->
                            <div class="absolute h-10 bg-red-500 rounded shadow-md cursor-pointer flex items-center px-2 text-white text-xs border-l-4 border-red-800 animate-pulse task-conflict hover:scale-105 transition-transform"
                                 style="left: 5%; width: 20%; top: 12px;"
                                 data-msg="模具 [M-Window-01] 资源耗尽！\n该时段模具总数: 1套\n当前需求: 2套">
                                <div class="flex flex-col w-full">
                                    <span class="font-bold flex items-center"><i class="fa fa-warning mr-1 text-yellow-300"></i> MO-2005</span>
                                    <span class="opacity-90 scale-90 origin-left">模具冲突</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 底部：待排任务池 (缩小版) -->
            <div class="h-44 border-t-4 border-gray-200 bg-white flex flex-col shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] z-20">
                <div class="p-2 bg-gray-50 border-b border-gray-200 flex justify-between items-center px-4">
                    <span class="text-xs font-bold text-gray-700 flex items-center">
                        <i class="fa fa-inbox mr-2"></i> 未排任务池 (Total: 12)
                    </span>
                    <div class="flex space-x-2">
                        <span class="text-xs text-gray-400">按交期排序</span>
                        <i class="fa fa-sort-amount-asc text-gray-400 cursor-pointer hover:text-blue-600"></i>
                    </div>
                </div>
                <div class="flex-1 overflow-x-auto p-3 flex space-x-3 items-center bg-gray-50/50">
                    <div class="w-40 bg-white border border-gray-200 rounded p-2 shadow-sm cursor-grab hover:border-blue-500 hover:shadow-md transition-all group">
                        <div class="flex justify-between text-xs mb-1">
                            <span class="font-bold text-gray-800">MO-3001</span>
                            <span class="bg-yellow-100 text-yellow-800 px-1.5 py-0.5 rounded text-[10px]">高优</span>
                        </div>
                        <div class="text-xs text-gray-500">冷凝器 / 500件</div>
                        <div class="mt-2 text-[10px] text-gray-400 flex items-center">
                            <i class="fa fa-clock-o mr-1"></i> 07-28
                        </div>
                    </div>
                    <div class="w-40 bg-white border border-gray-200 rounded p-2 shadow-sm cursor-grab hover:border-blue-500 hover:shadow-md transition-all group">
                        <div class="flex justify-between text-xs mb-1">
                            <span class="font-bold text-gray-800">MO-3002</span>
                            <span class="bg-gray-100 text-gray-600 px-1.5 py-0.5 rounded text-[10px]">普通</span>
                        </div>
                        <div class="text-xs text-gray-500">蒸发器 / 1200件</div>
                        <div class="mt-2 text-[10px] text-gray-400 flex items-center">
                            <i class="fa fa-clock-o mr-1"></i> 07-30
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 右键菜单 -->
    <div id="gantt-context-menu" class="hidden absolute bg-white border border-gray-200 shadow-xl rounded-lg w-40 py-1 z-50 text-sm overflow-hidden ring-1 ring-black ring-opacity-5">
        <a href="#" class="block px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors" id="ctx-split">
            <i class="fa fa-scissors mr-2 text-gray-400"></i>拆分任务
        </a>
        <a href="#" class="block px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors" id="ctx-detail">
            <i class="fa fa-list-ul mr-2 text-gray-400"></i>查看并单详情
        </a>
        <div class="border-t border-gray-100 my-1"></div>
        <a href="#" class="block px-4 py-2 text-red-600 hover:bg-red-50 transition-colors">
            <i class="fa fa-undo mr-2"></i>退回任务池
        </a>
    </div>
</div>
                    <!-- 23 下发两器T+3计划 -->
                    <div id="activity-23" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">23 两器T+3计划下发</h3>
                                <p class="text-sm text-gray-500 mt-1">计划管理中心、两器计划下发页</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>计划确认：审核两器T+3计划内容，确认计划可行性</li>
                                        <li>多级下发：按车间、产线、工序等层级下发计划</li>
                                        <li>状态追踪：跟踪计划下发状态，记录下发时间与接收确认</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">两器T+3计划数据</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">下发记录、计划状态</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 两器T+3计划下发页面 -->
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-800">两器T+3计划下发</h3>
                                <div class="flex space-x-2">
                                    <button id="confirm-t3-plan-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                        <i class="fa fa-check-circle mr-1"></i> 确认计划
                                    </button>
                                    <button id="issue-t3-plan-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all">
                                        <i class="fa fa-paper-plane mr-1"></i> 下发计划
                                    </button>
                                    <button id="push-to-mes-btn" class="px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition-all" disabled>
                                        <i class="fa fa-cloud-upload mr-1"></i> 推送MES
                                    </button>
                                </div>
                            </div>
                            <div class="p-6">
                                <!-- 计划信息 -->
                                <div class="mb-6 bg-gray-50 p-4 rounded-lg">
                                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">两器T+3计划编号</label>
                                            <p class="text-sm text-gray-600">T3-202507-001</p>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">主计划编号</label>
                                            <p class="text-sm text-gray-600">MP-202507-001</p>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">计划周期</label>
                                            <p class="text-sm text-gray-600">2025-07-21 至 2025-07-23</p>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">状态</label>
                                            <p class="text-sm text-gray-600">
                                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                    待确认
                                                </span>
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <!-- 计划详情 -->
                                <div class="mb-6">
                                    <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                        <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                            <h4 class="text-md font-medium text-gray-700">计划详情</h4>
                                            <div class="flex items-center">
                                                <span class="text-sm text-gray-500 mr-2">共 8 道工序</span>
                                            </div>
                                        </div>
                                        <div class="overflow-x-auto">
                                            <table class="min-w-full divide-y divide-gray-200">
                                                <thead class="bg-gray-50">
                                                    <tr>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">工序编号</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">工序名称</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数量</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">开始时间</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">结束时间</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">设备</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">负责人</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="bg-white divide-y divide-gray-200">
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">T3-OP-001</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">冲压</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">压缩机-100A</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">50</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-21 08:00</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-21 12:00</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">冲压机1</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">张三</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                                待下发
                                                            </span>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">T3-OP-002</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">焊接</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">压缩机-100A</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">50</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-21 13:00</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-21 17:00</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">焊接机1</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">李四</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                                待下发
                                                            </span>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">T3-OP-003</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">装配</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">压缩机-100A</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">50</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-22 08:00</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-22 16:00</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">装配线1</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">王五</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                                待下发
                                                            </span>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>

                                <!-- 下发历史 -->
                                <div class="border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="bg-gray-50 p-4 border-b border-gray-200">
                                        <h4 class="text-md font-medium text-gray-700">下发历史</h4>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">下发编号</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">计划编号</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">下发时间</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">下发人</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">接收工序</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MES状态</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">IT3-202507-001</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">T3-202507-001</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-20 16:30</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">张三</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">冲压</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                            已接收
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900">查看详情</a>
                                                        <button class="push-mes-btn ml-2 px-2 py-1 bg-purple-600 text-white text-xs rounded hover:bg-purple-700 transition-all" data-id="IT3-202507-001">
                                                            <i class="fa fa-cloud-upload mr-1"></i> 推送MES
                                                        </button>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">
                                                            未推送
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">IT3-202507-002</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">T3-202507-001</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-20 16:30</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">张三</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">焊接</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                            待接收
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                        <a href="#" class="text-blue-600 hover:text-blue-900">查看详情</a>
                                                        <button class="push-mes-btn ml-2 px-2 py-1 bg-gray-300 text-gray-500 text-xs rounded cursor-not-allowed" data-id="IT3-202507-002" disabled>
                                                            <i class="fa fa-cloud-upload mr-1"></i> 推送MES
                                                        </button>
                                                    </td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">
                                                            未推送
                                                        </span>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- 24 执行监控中心、实绩反馈看板 -->
                    <div id="activity-24" class="activity-section hidden">
                        <div class="bg-white rounded-lg shadow mb-6">
                            <div class="p-6 border-b border-gray-200">
                                <h3 class="text-lg font-medium text-gray-800">24 执行监控中心</h3>
                                <p class="text-sm text-gray-500 mt-1">生产管理中心、执行监控中心</p>
                            </div>
                            <div class="p-6">
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                                    <ul class="list-disc pl-5 text-sm text-gray-600">
                                        <li>进度获取：实时获取MES完工数据、WMS入库数据</li>
                                        <li>人工修正：支持异常数据调整，记录调整原因</li>
                                        <li>基准关联：选择扣减基准，自动关联生产计划</li>
                                    </ul>
                                </div>
                                <div class="mb-6">
                                    <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输入</p>
                                            <p class="text-sm text-gray-600">MES完工数据、WMS入库数据、人工修正数据</p>
                                        </div>
                                        <div class="bg-gray-50 p-4 rounded">
                                            <p class="text-sm font-medium text-gray-700">输出</p>
                                            <p class="text-sm text-gray-600">生产实绩数据、进度报告、异常记录</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 执行监控中心页面 -->
                        <div class="bg-white rounded-lg shadow">
                            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-800">执行监控中心</h3>
                                <div class="flex space-x-2">
                                    <button id="refresh-data-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                        <i class="fa fa-refresh mr-1"></i> 刷新数据
                                    </button>
                                    <button id="export-report-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all">
                                        <i class="fa fa-download mr-1"></i> 导出报告
                                    </button>
                                </div>
                            </div>
                            <div class="p-6">
                                <!-- 数据来源选择 -->
                                <div class="mb-6 bg-gray-50 p-4 rounded-lg">
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">数据来源</label>
                                            <div class="flex space-x-4">
                                                <label class="inline-flex items-center">
                                                    <input type="checkbox" class="form-checkbox h-4 w-4 text-blue-600" checked>
                                                    <span class="ml-2 text-sm text-gray-700">MES系统</span>
                                                </label>
                                                <label class="inline-flex items-center">
                                                    <input type="checkbox" class="form-checkbox h-4 w-4 text-blue-600" checked>
                                                    <span class="ml-2 text-sm text-gray-700">WMS系统</span>
                                                </label>
                                                <label class="inline-flex items-center">
                                                    <input type="checkbox" class="form-checkbox h-4 w-4 text-blue-600">
                                                    <span class="ml-2 text-sm text-gray-700">人工录入</span>
                                                </label>
                                            </div>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">时间范围</label>
                                            <div class="flex items-center space-x-2">
                                                <input type="date" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" value="2025-07-21">
                                                <span class="text-gray-500">至</span>
                                                <input type="date" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" value="2025-07-27">
                                            </div>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">生产订单</label>
                                            <select class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="">全部订单</option>
                                                <option value="ORD-202507-001">ORD-202507-001</option>
                                                <option value="ORD-202507-002">ORD-202507-002</option>
                                                <option value="ORD-202507-003">ORD-202507-003</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mt-4 flex justify-end">
                                        <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-all mr-2">
                                            重置
                                        </button>
                                        <button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                                            查询
                                        </button>
                                    </div>
                                </div>

                                <!-- 生产进度概览 -->
                                <div class="mb-6 grid grid-cols-1 md:grid-cols-4 gap-4">
                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                        <div class="flex items-center justify-between">
                                            <h4 class="text-sm font-medium text-gray-500">计划完成率</h4>
                                            <span class="text-2xl font-bold text-blue-600">85%</span>
                                        </div>
                                        <div class="mt-2">
                                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                                <div class="bg-blue-600 h-2.5 rounded-full" style="width: 85%"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                        <div class="flex items-center justify-between">
                                            <h4 class="text-sm font-medium text-gray-500">生产效率</h4>
                                            <span class="text-2xl font-bold text-green-600">92%</span>
                                        </div>
                                        <div class="mt-2">
                                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                                <div class="bg-green-600 h-2.5 rounded-full" style="width: 92%"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                        <div class="flex items-center justify-between">
                                            <h4 class="text-sm font-medium text-gray-500">质量合格率</h4>
                                            <span class="text-2xl font-bold text-yellow-600">97%</span>
                                        </div>
                                        <div class="mt-2">
                                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                                <div class="bg-yellow-600 h-2.5 rounded-full" style="width: 97%"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                        <div class="flex items-center justify-between">
                                            <h4 class="text-sm font-medium text-gray-500">异常发生率</h4>
                                            <span class="text-2xl font-bold text-red-600">3%</span>
                                        </div>
                                        <div class="mt-2">
                                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                                <div class="bg-red-600 h-2.5 rounded-full" style="width: 3%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 实绩数据图表 -->
                                <div class="mb-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <!-- 生产进度趋势图 -->
                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                        <div class="flex justify-between items-center mb-4">
                                            <h4 class="text-md font-medium text-gray-700">生产进度趋势</h4>
                                            <select class="border border-gray-300 rounded px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="day">按日</option>
                                                <option value="week" selected>按周</option>
                                                <option value="month">按月</option>
                                            </select>
                                        </div>
                                        <div class="h-64">
                                            <canvas id="productionTrendChart"></canvas>
                                        </div>
                                    </div>
                                    
                                    <!-- 订单完成情况 -->
                                    <div class="bg-white border border-gray-200 rounded-lg p-4">
                                        <div class="flex justify-between items-center mb-4">
                                            <h4 class="text-md font-medium text-gray-700">订单完成情况</h4>
                                            <select class="border border-gray-300 rounded px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                                <option value="all" selected>全部订单</option>
                                                <option value="critical">关键订单</option>
                                            </select>
                                        </div>
                                        <div class="h-64">
                                            <canvas id="orderCompletionChart"></canvas>
                                        </div>
                                    </div>
                                </div>

                                <!-- 实绩数据列表 -->
                                <div class="mb-6">
                                    <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                        <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                            <h4 class="text-md font-medium text-gray-700">实绩数据列表</h4>
                                            <div class="flex items-center space-x-2">
                                                <button id="manual-adjust-btn" class="px-3 py-1 bg-yellow-600 text-white rounded hover:bg-yellow-700 text-sm transition-all">
                                                    <i class="fa fa-pencil mr-1"></i> 人工修正
                                                </button>
                                                <span class="text-sm text-gray-500">共 15 条记录</span>
                                            </div>
                                        </div>
                                        <div class="overflow-x-auto">
                                            <table class="min-w-full divide-y divide-gray-200">
                                                <thead class="bg-gray-50">
                                                    <tr>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">订单号</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料编码</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料名称</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">计划数量</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MES完工数</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">WMS入库数</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">修正数量</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数据来源</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">扣减基准</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MES状态</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="bg-white divide-y divide-gray-200">
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">ORD-202507-001</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">COMP-100A</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">组件A</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">50</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">48</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">48</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">48</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
                                                                MES
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">MES完工数</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                                已确认
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看</a>
                                                            <a href="#" class="text-yellow-600 hover:text-yellow-900">修正</a>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">ORD-202507-002</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">COMP-200B</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">组件B</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">30</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">30</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">-</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">30</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
                                                                MES
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">MES完工数</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                                待确认
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看</a>
                                                            <a href="#" class="text-yellow-600 hover:text-yellow-900">修正</a>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">ORD-202507-003</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">COMP-300C</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">组件C</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">20</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">18</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">18</td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">17</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                                人工修正
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">WMS入库数</td>
                                                        <td class="px-6 py-4 whitespace-nowrap">
                                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                                                已确认
                                                            </span>
                                                        </td>
                                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            <a href="#" class="text-blue-600 hover:text-blue-900 mr-2">查看</a>
                                                            <a href="#" class="text-yellow-600 hover:text-yellow-900">修正</a>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200">
                                            <div class="text-sm text-gray-700">
                                                显示 <span class="font-medium">1</span> 到 <span class="font-medium">3</span> 条，共 <span class="font-medium">15</span> 条
                                            </div>
                                            <div class="flex space-x-2">
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 disabled:opacity-50" disabled>
                                                    上一页
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm bg-blue-50 text-blue-600">
                                                    1
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    2
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    3
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    4
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    5
                                                </button>
                                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                                    下一页
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 异常记录 -->
                                <div class="border border-gray-200 rounded-lg overflow-hidden">
                                    <div class="bg-gray-50 p-4 border-b border-gray-200">
                                        <h4 class="text-md font-medium text-gray-700">异常记录</h4>
                                    </div>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">异常编号</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">订单号</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料编码</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">异常类型</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">异常描述</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">修正前数量</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">修正后数量</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">修正人</th>
                                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">修正时间</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200">
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">ERR-202507-001</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">ORD-202507-003</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">COMP-300C</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                                            质量问题
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 text-sm text-gray-500">1个组件存在质量缺陷，无法入库</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">18</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">17</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">张三</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-25 10:30</td>
                                                </tr>
                                                <tr>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">ERR-202507-002</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">ORD-202507-001</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">COMP-100A</td>
                                                    <td class="px-6 py-4 whitespace-nowrap">
                                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                            数据不一致
                                                        </span>
                                                    </td>
                                                    <td class="px-6 py-4 text-sm text-gray-500">MES与WMS数据不一致，经核实以WMS为准</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">49</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">48</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">李四</td>
                                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-07-22 14:15</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
<!-- 29 综合计划查询 (全景计划追溯大厅 - 完整版) -->
<div id="activity-29" class="activity-section hidden">
    <div class="bg-white rounded-lg shadow mb-6">
        <div class="p-6 border-b border-gray-200">
            <h3 class="text-lg font-medium text-gray-800">29 综合计划查询</h3>
            <p class="text-sm text-gray-500 mt-1">计划管理模块、全景计划追溯大厅</p>
        </div>
        <div class="p-6">
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                <ul class="list-disc pl-5 text-sm text-gray-600">
                    <li><strong>多维全息视图：</strong>聚合展示排产维度（机台/时间）、需求维度（总装/出口）、工艺维度（孔排数/用量）的全量信息。</li>
                    <li><strong>版本穿透：</strong>支持点击计划版本号，钻取查看该工单的历史变更快照及调整履历。</li>
                    <li><strong>智能追溯：</strong>针对变更计划，显性展示调整原因（如：延期、减量、插单）。</li>
                </ul>
            </div>
            <div class="mb-6">
                <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-gray-50 p-4 rounded border border-gray-100">
                        <p class="text-sm font-medium text-gray-700">输入</p>
                        <p class="text-sm text-gray-600">排产结果表、工艺参数表、订单属性表</p>
                    </div>
                    <div class="bg-gray-50 p-4 rounded border border-gray-100">
                        <p class="text-sm font-medium text-gray-700">输出</p>
                        <p class="text-sm text-gray-600">综合查询报表、导出文件 (Excel/CSV)</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 全景追溯大厅 -->
    <div class="bg-white rounded-lg shadow flex flex-col h-[800px] relative">
        <!-- 顶部工具栏 & 筛选区 -->
        <div class="p-4 border-b border-gray-200 bg-gray-50">
            <div class="flex flex-wrap gap-4 items-end mb-4">
                <!-- 筛选条件 -->
                <div class="w-48">
                    <label class="block text-xs font-medium text-gray-500 mb-1">排产日期范围</label>
                    <input type="date" class="w-full border border-gray-300 rounded px-2 py-1.5 text-sm" value="2025-07-21">
                </div>
                <div class="w-40">
                    <label class="block text-xs font-medium text-gray-500 mb-1">机台 / 线体</label>
                    <select class="w-full border border-gray-300 rounded px-2 py-1.5 text-sm">
                        <option>全部</option>
                        <option>5# 冲床</option>
                        <option>6# 冲床</option>
                    </select>
                </div>
                <div class="w-40">
                    <label class="block text-xs font-medium text-gray-500 mb-1">物料编码</label>
                    <input type="text" class="w-full border border-gray-300 rounded px-2 py-1.5 text-sm" placeholder="输入物料号">
                </div>
                <div class="w-40">
                    <label class="block text-xs font-medium text-gray-500 mb-1">计划版本</label>
                    <input type="text" class="w-full border border-gray-300 rounded px-2 py-1.5 text-sm" placeholder="如: V1.0">
                </div>
                
                <!-- 复选框组 -->
                <div class="flex items-center space-x-4 pb-2">
                    <label class="flex items-center cursor-pointer">
                        <input type="checkbox" class="form-checkbox h-4 w-4 text-blue-600 rounded">
                        <span class="ml-2 text-sm text-gray-700">仅显示变更计划</span>
                    </label>
                    <label class="flex items-center cursor-pointer">
                        <input type="checkbox" checked class="form-checkbox h-4 w-4 text-blue-600 rounded">
                        <span class="ml-2 text-sm text-gray-700">仅显示未完工</span>
                    </label>
                </div>

                <!-- 按钮组 -->
                <div class="flex-1 flex justify-end space-x-2 pb-0.5">
                    <button class="px-4 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all text-sm shadow-sm">
                        <i class="fa fa-search mr-1"></i> 查询
                    </button>
                    <button id="export-excel-btn" class="px-4 py-1.5 bg-green-600 text-white rounded hover:bg-green-700 transition-all text-sm shadow-sm flex items-center">
                        <i class="fa fa-file-excel-o mr-1"></i> 导出Excel
                    </button>
                    <button id="customize-columns-btn" class="px-3 py-1.5 bg-white border border-gray-300 text-gray-700 rounded hover:bg-gray-50 transition-all text-sm" title="自定义列">
                        <i class="fa fa-columns mr-1"></i> 列配置
                    </button>
                </div>
            </div>
        </div>

        <!-- 超宽表区域 -->
        <div class="flex-1 overflow-auto relative">
                     <table class="min-w-[2800px] divide-y divide-gray-200 text-sm" id="traceability-table">
                <thead class="bg-gray-100 sticky top-0 z-10 shadow-sm">
                    <tr>
                        <!-- 锁定列 -->
                        <th class="px-4 py-3 text-left font-bold text-gray-700 bg-gray-100 sticky left-0 z-20 border-r border-gray-300 w-36 shadow-lg">计划工单号</th>
                        
                        <!-- 排产维度 (增加宽度) -->
                        <th colspan="6" class="px-4 py-2 text-center font-bold text-blue-700 bg-blue-50 border-r border-gray-300 col-group-schedule">排产信息</th>
                        
                        <!-- 需求维度 -->
                        <th colspan="7" class="px-4 py-2 text-center font-bold text-green-700 bg-green-50 border-r border-gray-300 col-group-demand">需求溯源</th>
                        
                        <!-- 工艺维度 -->
                        <th colspan="10" class="px-4 py-2 text-center font-bold text-purple-700 bg-purple-50 col-group-process">产品特征与工艺</th>
                    </tr>
                    <tr class="bg-gray-50 border-b border-gray-300" id="table-header-row">
                        <!-- 锁定列 -->
                        <th class="px-4 py-2 text-left font-medium text-gray-600 bg-gray-50 sticky left-0 z-20 border-r border-gray-300"></th>
                        
                        <!-- 排产细分 (新增：排产时段) -->
                        <th class="px-4 py-2 text-left font-medium text-gray-500 w-24 col-schedule" data-col="plan-ver">计划版本</th>
                        <th class="px-4 py-2 text-left font-medium text-gray-500 w-28 col-schedule" data-col="plan-date">排产日期</th>
                        <th class="px-4 py-2 text-left font-medium text-blue-600 w-32 col-schedule bg-blue-50/20" data-col="plan-time">排产时段</th>
                        <th class="px-4 py-2 text-right font-medium text-gray-500 w-20 col-schedule" data-col="duration">耗时(h)</th>
                        <th class="px-4 py-2 text-left font-medium text-gray-500 w-32 col-schedule" data-col="machine">机台/线体</th>
                        <th class="px-4 py-2 text-right font-medium text-gray-500 w-24 col-schedule" data-col="qty">计划产量</th>
                        
                        <!-- 需求细分 -->
                        <th class="px-4 py-2 text-left font-medium text-gray-500 w-32 col-demand" data-col="assy-date">总装上线日</th>
                        <th class="px-4 py-2 text-left font-medium text-gray-500 w-32 col-demand" data-col="assy-line">总装线体</th>
                        <th class="px-4 py-2 text-left font-medium text-gray-500 w-32 col-demand" data-col="batch-no">批号</th>
                        <th class="px-4 py-2 text-left font-medium text-gray-500 w-32 col-demand" data-col="src-no">来源单号</th>
                        <th class="px-4 py-2 text-left font-medium text-gray-500 w-24 col-demand" data-col="src-type">来源类型</th>
                        <th class="px-4 py-2 text-left font-medium text-gray-500 w-24 col-demand" data-col="country">出口国家</th>
                        <th class="px-4 py-2 text-left font-medium text-gray-500 w-48 col-demand" data-col="remark">调整说明</th>
                        
                        <!-- 产品特征 (去掉原耗时列) -->
                        <th class="px-4 py-2 text-left font-medium text-gray-500 w-48 col-process" data-col="mat-desc">物料描述</th>
                        <th class="px-4 py-2 text-left font-medium text-gray-500 w-32 col-process" data-col="spec">两器规格</th>
                        <th class="px-4 py-2 text-left font-medium text-gray-500 w-24 col-process" data-col="shape">片形</th>
                        <th class="px-4 py-2 text-center font-medium text-gray-500 w-20 col-process" data-col="slices">片数</th>
                        <th class="px-4 py-2 text-center font-medium text-gray-500 w-20 col-process" data-col="u-tubes">U管数</th>
                        <th class="px-4 py-2 text-center font-medium text-gray-500 w-20 col-process" data-col="holes">孔数</th>
                        <th class="px-4 py-2 text-center font-medium text-gray-500 w-20 col-process" data-col="rows">排数</th>
                        <th class="px-4 py-2 text-left font-medium text-gray-500 w-32 col-process" data-col="al-model">铝箔型号</th>
                        <th class="px-4 py-2 text-right font-medium text-gray-500 w-24 col-process" data-col="al-cost">铝箔单耗</th>
                        <th class="px-4 py-2 text-left font-medium text-gray-500 w-24 col-process" data-col="cu-type">铜管类型</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200 hover:bg-gray-50" id="trace-table-body">
                    <!-- 数据行 1 -->
                    <tr class="hover:bg-blue-50 transition-colors">
                        <td class="px-4 py-3 font-medium text-blue-600 bg-white sticky left-0 z-10 border-r border-gray-200 group-hover:bg-blue-50">WO-202507-001</td>
                        
                        <!-- 排产 (更新) -->
                        <td class="px-4 py-3 col-schedule" data-col="plan-ver"><span class="cursor-pointer text-blue-600 hover:underline version-link" data-id="WO-001">V1.2</span></td>
                        <td class="px-4 py-3 col-schedule" data-col="plan-date">2025-07-21</td>
                        <td class="px-4 py-3 col-schedule font-mono text-xs bg-blue-50/30" data-col="plan-time">08:00 - 12:30</td>
                        <td class="px-4 py-3 text-right col-schedule" data-col="duration">4.5</td>
                        <td class="px-4 py-3 col-schedule" data-col="machine">5# 冲床</td>
                        <td class="px-4 py-3 text-right font-bold col-schedule" data-col="qty">500</td>
                        
                        <!-- 需求 (保持) -->
                        <td class="px-4 py-3 col-demand" data-col="assy-date">2025-07-25</td>
                        <td class="px-4 py-3 col-demand" data-col="assy-line">Line-A</td>
                        <td class="px-4 py-3 col-demand" data-col="batch-no">B250721-01</td>
                        <td class="px-4 py-3 col-demand" data-col="src-no">SO-9001</td>
                        <td class="px-4 py-3 col-demand" data-col="src-type"><span class="bg-green-100 text-green-700 px-2 py-0.5 rounded text-xs">APS自动</span></td>
                        <td class="px-4 py-3 col-demand" data-col="country">美国</td>
                        <td class="px-4 py-3 text-gray-400 col-demand" data-col="remark">-</td>
                        
                        <!-- 工艺 (保持) -->
                        <td class="px-4 py-3 truncate max-w-xs col-process" data-col="mat-desc" title="冷凝器组件-双排-0.095">冷凝器组件-双排</td>
                        <td class="px-4 py-3 col-process" data-col="spec">7x210</td>
                        <td class="px-4 py-3 col-process" data-col="shape">波纹片</td>
                        <td class="px-4 py-3 text-center col-process" data-col="slices">45</td>
                        <td class="px-4 py-3 text-center col-process" data-col="u-tubes">12</td>
                        <td class="px-4 py-3 text-center col-process" data-col="holes">24</td>
                        <td class="px-4 py-3 text-center col-process" data-col="rows">2</td>
                        <td class="px-4 py-3 col-process" data-col="al-model">AL-3003</td>
                        <td class="px-4 py-3 text-right col-process" data-col="al-cost">0.45</td>
                        <td class="px-4 py-3 col-process" data-col="cu-type">内螺纹</td>
                    </tr>

                    <!-- 数据行 2 -->
                    <tr class="hover:bg-blue-50 transition-colors bg-yellow-50/30">
                        <td class="px-4 py-3 font-medium text-blue-600 bg-white sticky left-0 z-10 border-r border-gray-200 group-hover:bg-blue-50">WO-202507-002</td>
                        
                        <!-- 排产 (更新) -->
                        <td class="px-4 py-3 col-schedule" data-col="plan-ver"><span class="cursor-pointer text-blue-600 hover:underline version-link" data-id="WO-002">V1.3</span></td>
                        <td class="px-4 py-3 text-red-600 font-medium col-schedule" data-col="plan-date">2025-07-23</td>
                        <td class="px-4 py-3 col-schedule font-mono text-xs bg-blue-50/30" data-col="plan-time">13:30 - 21:42</td>
                        <td class="px-4 py-3 text-right col-schedule" data-col="duration">8.2</td>
                        <td class="px-4 py-3 col-schedule" data-col="machine">6# 冲床</td>
                        <td class="px-4 py-3 text-right font-bold col-schedule" data-col="qty">1200</td>
                        
                        <!-- 需求 (保持) -->
                        <td class="px-4 py-3 col-demand" data-col="assy-date">2025-07-27</td>
                        <td class="px-4 py-3 col-demand" data-col="assy-line">Line-B</td>
                        <td class="px-4 py-3 col-demand" data-col="batch-no">B250723-05</td>
                        <td class="px-4 py-3 col-demand" data-col="src-no">SO-9005</td>
                        <td class="px-4 py-3 col-demand" data-col="src-type"><span class="bg-purple-100 text-purple-700 px-2 py-0.5 rounded text-xs">手工插单</span></td>
                        <td class="px-4 py-3 col-demand" data-col="country">国内</td>
                        <td class="px-4 py-3 text-red-600 text-xs font-medium col-demand" data-col="remark"><i class="fa fa-pencil mr-1"></i>机台变更: 5#->6#</td>
                        
                        <!-- 工艺 (保持) -->
                        <td class="px-4 py-3 truncate max-w-xs col-process" data-col="mat-desc">蒸发器组件-三排</td>
                        <td class="px-4 py-3 col-process" data-col="spec">9x320</td>
                        <td class="px-4 py-3 col-process" data-col="shape">开窗片</td>
                        <td class="px-4 py-3 text-center col-process" data-col="slices">60</td>
                        <td class="px-4 py-3 text-center col-process" data-col="u-tubes">18</td>
                        <td class="px-4 py-3 text-center col-process" data-col="holes">36</td>
                        <td class="px-4 py-3 text-center col-process" data-col="rows">3</td>
                        <td class="px-4 py-3 col-process" data-col="al-model">AL-1100</td>
                        <td class="px-4 py-3 text-right col-process" data-col="al-cost">0.68</td>
                        <td class="px-4 py-3 col-process" data-col="cu-type">光管</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- 底部状态栏 -->
        <div class="p-3 border-t border-gray-200 bg-gray-50 flex justify-between items-center text-xs text-gray-500">
            <span>共查询到 125 条记录 (加载时间: 0.8s)</span>
            <span><i class="fa fa-info-circle mr-1"></i> 默认仅加载近 3 个月数据，历史数据需通过归档库查询。</span>
        </div>
    </div>

    <!-- 自定义列模态框 (默认隐藏) -->
    <div id="column-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl w-96 p-6">
            <h4 class="text-lg font-bold text-gray-800 mb-4">自定义显示列</h4>
            <div class="max-h-60 overflow-y-auto space-y-2 mb-6 custom-scrollbar" id="column-list-container">
                <!-- JS 动态生成 -->
            </div>
            <div class="flex justify-end space-x-2">
                <button id="cancel-column-btn" class="px-4 py-2 border border-gray-300 rounded text-gray-600 hover:bg-gray-50">取消</button>
                <button id="apply-column-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">应用</button>
            </div>
        </div>
    </div>

    <!-- 右侧滑出抽屉：版本追溯 (默认隐藏) -->
    <div id="version-drawer" class="fixed inset-y-0 right-0 w-[480px] bg-white shadow-2xl z-50 transform translate-x-full transition-transform duration-300 flex flex-col">
        <div class="p-4 border-b border-gray-200 bg-blue-50 flex justify-between items-center">
            <div>
                <h4 class="text-md font-bold text-gray-800">工单版本追溯</h4>
                <p class="text-xs text-blue-600 mt-1">WO-ID</p>
            </div>
            <button id="close-drawer-btn" class="text-gray-500 hover:text-gray-800"><i class="fa fa-times text-lg"></i></button>
        </div>
        
        <div class="flex-1 overflow-y-auto p-6 space-y-8">
            <!-- V1.3 (最新) -->
            <div class="relative pl-6 border-l-2 border-blue-500">
                <div class="absolute -left-[9px] top-0 w-4 h-4 bg-blue-500 rounded-full border-2 border-white shadow"></div>
                <div class="mb-1 flex justify-between items-baseline">
                    <span class="font-bold text-gray-800 text-sm">V1.3 (Current)</span>
                    <span class="text-xs text-gray-400">2025-07-20 16:30</span>
                </div>
                <div class="bg-blue-50 p-3 rounded text-xs space-y-1">
                    <p><span class="text-gray-500 w-16 inline-block">机台:</span> <span class="font-medium">6# 冲床</span></p>
                    <p><span class="text-gray-500 w-16 inline-block">排产日:</span> <span class="font-medium text-red-600">2025-07-23</span></p>
                    <p><span class="text-gray-500 w-16 inline-block">数量:</span> 1200</p>
                    <p class="mt-2 pt-2 border-t border-blue-100 text-blue-700"><i class="fa fa-user mr-1"></i> 张三 (手动调整)</p>
                </div>
            </div>

            <!-- V1.2 -->
            <div class="relative pl-6 border-l-2 border-gray-200">
                <div class="absolute -left-[9px] top-0 w-4 h-4 bg-gray-300 rounded-full border-2 border-white"></div>
                <div class="mb-1 flex justify-between items-baseline">
                    <span class="font-bold text-gray-600 text-sm">V1.2</span>
                    <span class="text-xs text-gray-400">2025-07-20 14:00</span>
                </div>
                <div class="bg-gray-50 p-3 rounded text-xs space-y-1 opacity-75">
                    <p><span class="text-gray-500 w-16 inline-block">机台:</span> <span class="line-through text-red-400">5# 冲床</span></p>
                    <p><span class="text-gray-500 w-16 inline-block">排产日:</span> <span>2025-07-22</span></p>
                    <p><span class="text-gray-500 w-16 inline-block">数量:</span> 1200</p>
                    <p class="mt-2 pt-2 border-t border-gray-200 text-gray-500"><i class="fa fa-cogs mr-1"></i> 系统自动排程</p>
                </div>
            </div>
        </div>
    </div>
</div>


          <!-- 28 系统集成全景图 (V2.0: 完整接口清单) -->
<div id="activity-28" class="activity-section hidden">
    <div class="bg-white rounded-lg shadow mb-6">
        <div class="p-6 border-b border-gray-200">
            <h3 class="text-lg font-medium text-gray-800">28 系统集成全景图</h3>
            <p class="text-sm text-gray-500 mt-1">系统运维中心、接口交互监控与详细清单</p>
        </div>
        <div class="p-6">
            <div class="mb-4">
                <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                <ul class="list-disc pl-5 text-sm text-gray-600">
                    <li>全景监控：可视化展示 APS 与周边系统 (SAP, MES, WMS, EAM, 总装APS) 的数据流向。</li>
                    <li>接口清单：详细管理输入/输出接口的字段定义、触发频率及业务场景。</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- 核心内容区 -->
    <div class="space-y-6">
        
        <!-- 1. 系统集成拓扑图 (增加 EAM 节点) -->
        <div class="bg-white rounded-lg shadow p-6 relative overflow-hidden h-[360px] bg-slate-50 border border-gray-200">
            <h4 class="text-md font-bold text-gray-800 absolute top-4 left-4">系统集成拓扑</h4>
            <div class="absolute top-4 right-4 flex space-x-2 text-xs">
                <span class="flex items-center"><span class="w-2 h-2 bg-blue-500 rounded-full mr-1"></span>输入流</span>
                <span class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-1"></span>输出流</span>
            </div>

            <!-- 中心 APS -->
            <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-28 h-28 bg-blue-600 rounded-full flex flex-col items-center justify-center shadow-xl border-4 border-white z-30">
                <span class="text-white font-bold text-xl">两器APS</span>
                <span class="text-blue-200 text-xs">核心引擎</span>
            </div>

            <!-- 左上: 总装APS -->
            <div class="absolute top-[10%] left-[15%] w-24 h-14 bg-white border border-gray-300 rounded shadow flex flex-col items-center justify-center z-10">
                <span class="font-bold text-gray-700 text-xs">总装APS</span>
                <span class="text-[9px] text-gray-500">需求/反馈</span>
            </div>
            <div class="absolute top-[22%] left-[22%] w-[20%] h-[1px] bg-gray-400 transform rotate-[30deg]"></div>

            <!-- 右上: SAP (ERP) -->
            <div class="absolute top-[10%] right-[15%] w-24 h-14 bg-white border border-gray-300 rounded shadow flex flex-col items-center justify-center z-10">
                <span class="font-bold text-gray-700 text-xs">SAP (ERP)</span>
                <span class="text-[9px] text-gray-500">BOM/订单</span>
            </div>
            <div class="absolute top-[22%] right-[22%] w-[20%] h-[1px] bg-gray-400 transform -rotate-[30deg]"></div>

            <!-- 左下: WMS -->
            <div class="absolute bottom-[10%] left-[15%] w-24 h-14 bg-white border border-gray-300 rounded shadow flex flex-col items-center justify-center z-10">
                <span class="font-bold text-gray-700 text-xs">WMS</span>
                <span class="text-[9px] text-gray-500">库存/领料</span>
            </div>
            <div class="absolute bottom-[22%] left-[22%] w-[20%] h-[1px] bg-gray-400 transform -rotate-[30deg]"></div>

            <!-- 右下: MES -->
            <div class="absolute bottom-[10%] right-[15%] w-24 h-14 bg-white border border-gray-300 rounded shadow flex flex-col items-center justify-center z-10">
                <span class="font-bold text-gray-700 text-xs">MES</span>
                <span class="text-[9px] text-gray-500">执行/报工</span>
            </div>
            <div class="absolute bottom-[22%] right-[22%] w-[20%] h-[1px] bg-gray-400 transform rotate-[30deg]"></div>

            <!-- 顶部中间: PLM -->
            <div class="absolute top-[5%] left-1/2 transform -translate-x-1/2 w-20 h-12 bg-white border border-gray-300 rounded shadow flex flex-col items-center justify-center z-10">
                <span class="font-bold text-gray-700 text-xs">PLM</span>
                <span class="text-[9px] text-gray-500">工艺/属性</span>
            </div>
            <div class="absolute top-[15%] left-1/2 w-[1px] h-[15%] bg-gray-400"></div>

            <!-- 底部中间: EAM (新增) -->
            <div class="absolute bottom-[5%] left-1/2 transform -translate-x-1/2 w-20 h-12 bg-white border border-gray-300 rounded shadow flex flex-col items-center justify-center z-10">
                <span class="font-bold text-gray-700 text-xs">EAM</span>
                <span class="text-[9px] text-gray-500">设备效能</span>
            </div>
            <div class="absolute bottom-[15%] left-1/2 w-[1px] h-[15%] bg-gray-400"></div>
        </div>

        <!-- 2. 详细接口清单 (Tab页) -->
        <div class="bg-white rounded-lg shadow">
            <div class="border-b border-gray-200">
                <ul class="flex flex-wrap -mb-px text-sm font-medium text-center">
                    <li class="mr-2">
                        <a href="#" class="interface-tab-link inline-block p-4 text-blue-600 border-b-2 border-blue-600 active rounded-t-lg" data-target="tab-inbound">
                            <i class="fa fa-arrow-circle-down mr-2"></i>输入接口 (Inbound)
                        </a>
                    </li>
                    <li class="mr-2">
                        <a href="#" class="interface-tab-link inline-block p-4 border-b-2 border-transparent hover:text-gray-600 hover:border-gray-300 rounded-t-lg text-gray-500" data-target="tab-outbound">
                            <i class="fa fa-arrow-circle-up mr-2"></i>输出接口 (Outbound)
                        </a>
                    </li>
                </ul>
            </div>

            <div class="p-6">
                <!-- Tab 1: 输入接口 -->
                <div id="tab-inbound" class="interface-tab-content">
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200 border border-gray-200 text-sm">
                            <thead class="bg-blue-50">
                                <tr>
                                    <th class="px-4 py-3 text-left font-medium text-gray-600 w-16">活动</th>
                                    <th class="px-4 py-3 text-left font-medium text-gray-600 w-24">来源系统</th>
                                    <th class="px-4 py-3 text-left font-medium text-gray-600">接口内容 / 关键字段</th>
                                    <th class="px-4 py-3 text-left font-medium text-gray-600 w-48">触发频率 / 场景</th>
                                    <th class="px-4 py-3 text-center font-medium text-gray-600 w-20">状态</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 bg-white">
                                <!-- Act 26: EAM (新增) -->
                                <tr>
                                    <td class="px-4 py-3 text-center font-bold text-gray-500 bg-gray-50">26</td>
                                    <td class="px-4 py-3"><span class="px-2 py-1 bg-cyan-100 text-cyan-800 rounded text-xs">EAM</span></td>
                                    <td class="px-4 py-3">
                                        <div class="font-medium text-gray-900">设备运行效能</div>
                                        <div class="text-xs text-gray-500 mt-1">机台号, 实际OEE, 故障停机时间, 有效运行时间</div>
                                    </td>
                                    <td class="px-4 py-3 text-gray-600">定时任务：每日/每周同步，修正产能公式</td>
                                    <td class="px-4 py-3 text-center"><i class="fa fa-check-circle text-green-500"></i></td>
                                </tr>
                                <!-- Act 18: WMS (更新：两器库存) -->
                                <tr>
                                    <td class="px-4 py-3 text-center font-bold text-gray-500 bg-gray-50">18</td>
                                    <td class="px-4 py-3"><span class="px-2 py-1 bg-orange-100 text-orange-800 rounded text-xs">WMS</span></td>
                                    <td class="px-4 py-3">
                                        <div class="font-medium text-gray-900">全量库存查询</div>
                                        <div class="text-xs text-gray-500 mt-1">原材料(铝箔/铜管), <span class="font-bold text-orange-600">两器成品/半成品库存</span>, 库位, 批次</div>
                                    </td>
                                    <td class="px-4 py-3 text-gray-600">实时调用：齐套分析或排产运算时</td>
                                    <td class="px-4 py-3 text-center"><i class="fa fa-check-circle text-green-500"></i></td>
                                </tr>
                                <!-- Act 08: SAP (更新：备件计划) -->
                                <tr>
                                    <td class="px-4 py-3 text-center font-bold text-gray-500 bg-gray-50">08</td>
                                    <td class="px-4 py-3"><span class="px-2 py-1 bg-purple-100 text-purple-800 rounded text-xs">SAP</span></td>
                                    <td class="px-4 py-3">
                                        <div class="font-medium text-gray-900">备件计划导入 (BOM展开)</div>
                                        <div class="text-xs text-gray-500 mt-1">父件物料, 合同号 -> 子件用量, 组件单位 (区分手工焊/直接打包)</div>
                                    </td>
                                    <td class="px-4 py-3 text-gray-600">实时调用：无本地映射时触发</td>
                                    <td class="px-4 py-3 text-center"><i class="fa fa-check-circle text-green-500"></i></td>
                                </tr>
                                <!-- Act 12: SRM/SAP (新增：采购在途) -->
                                <tr>
                                    <td class="px-4 py-3 text-center font-bold text-gray-500 bg-gray-50">12</td>
                                    <td class="px-4 py-3"><span class="px-2 py-1 bg-indigo-100 text-indigo-800 rounded text-xs">SRM</span></td>
                                    <td class="px-4 py-3">
                                        <div class="font-medium text-gray-900">采购在途数据</div>
                                        <div class="text-xs text-gray-500 mt-1">PO号, 物料, 预计到货日期, 在途数量</div>
                                    </td>
                                    <td class="px-4 py-3 text-gray-600">实时/定时：辅助齐套判断</td>
                                    <td class="px-4 py-3 text-center"><i class="fa fa-check-circle text-green-500"></i></td>
                                </tr>
                                <!-- Act 07: PLM/SAP (新增：主数据) -->
                                <tr>
                                    <td class="px-4 py-3 text-center font-bold text-gray-500 bg-gray-50">07</td>
                                    <td class="px-4 py-3"><span class="px-2 py-1 bg-gray-100 text-gray-800 rounded text-xs">PLM</span></td>
                                    <td class="px-4 py-3">
                                        <div class="font-medium text-gray-900">物料主数据属性</div>
                                        <div class="text-xs text-gray-500 mt-1">物料编码, 属性(E自制/F外购), 采购周期, 最小包装</div>
                                    </td>
                                    <td class="px-4 py-3 text-gray-600">定时同步：每日夜间增量同步</td>
                                    <td class="px-4 py-3 text-center"><i class="fa fa-check-circle text-green-500"></i></td>
                                </tr>
                                <!-- 原有 Act 2/3/6/24 保留... -->
                                <tr>
                                    <td class="px-4 py-3 text-center font-bold text-gray-500 bg-gray-50">02</td>
                                    <td class="px-4 py-3"><span class="px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs">总装APS</span></td>
                                    <td class="px-4 py-3"><div class="font-medium text-gray-900">总装排产锁定工单</div></td>
                                    <td class="px-4 py-3 text-gray-600">手动/定时同步</td>
                                    <td class="px-4 py-3 text-center"><i class="fa fa-check-circle text-green-500"></i></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Tab 2: 输出接口 -->
                <div id="tab-outbound" class="interface-tab-content hidden">
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200 border border-gray-200 text-sm">
                            <thead class="bg-green-50">
                                <tr>
                                    <th class="px-4 py-3 text-left font-medium text-gray-600 w-16">活动</th>
                                    <th class="px-4 py-3 text-left font-medium text-gray-600 w-24">接收系统</th>
                                    <th class="px-4 py-3 text-left font-medium text-gray-600">接口内容 / Data Payload</th>
                                    <th class="px-4 py-3 text-left font-medium text-gray-600 w-48">触发频率 / 场景</th>
                                    <th class="px-4 py-3 text-center font-medium text-gray-600 w-20">状态</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 bg-white">
                                <!-- Act 23 -> 总装APS (新增) -->
                                <tr>
                                    <td class="px-4 py-3 text-center font-bold text-gray-500 bg-gray-50">23</td>
                                    <td class="px-4 py-3"><span class="px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs">总装APS</span></td>
                                    <td class="px-4 py-3">
                                        <div class="font-medium text-gray-900">已有计划回馈</div>
                                        <div class="text-xs text-gray-500 mt-1">排产顺序, 生产时间, 数量 (供总装调整参考)</div>
                                    </td>
                                    <td class="px-4 py-3 text-gray-600">实时推送：排产结果锁定后</td>
                                    <td class="px-4 py-3 text-center"><i class="fa fa-check-circle text-green-500"></i></td>
                                </tr>
                                <!-- Act 12 -> 总装APS (原有预警) -->
                                <tr>
                                    <td class="px-4 py-3 text-center font-bold text-gray-500 bg-gray-50">12</td>
                                    <td class="px-4 py-3"><span class="px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs">总装APS</span></td>
                                    <td class="px-4 py-3">
                                        <div class="font-medium text-gray-900">产能影响反馈 (预警)</div>
                                        <div class="text-xs text-gray-500 mt-1">影响工单号, 预计延期天数, 瓶颈机台</div>
                                    </td>
                                    <td class="px-4 py-3 text-gray-600">实时调用：发现缺口时</td>
                                    <td class="px-4 py-3 text-center"><i class="fa fa-check-circle text-green-500"></i></td>
                                </tr>
                                <!-- Act 23 -> MES -->
                                <tr>
                                    <td class="px-4 py-3 text-center font-bold text-gray-500 bg-gray-50">23</td>
                                    <td class="px-4 py-3"><span class="px-2 py-1 bg-green-100 text-green-800 rounded text-xs">MES</span></td>
                                    <td class="px-4 py-3">
                                        <div class="font-medium text-gray-900">排产指令下发</div>
                                        <div class="text-xs text-gray-500 mt-1">MO号, 机台, 模具, 时间窗</div>
                                    </td>
                                    <td class="px-4 py-3 text-gray-600">手动触发：点击下发按钮</td>
                                    <td class="px-4 py-3 text-center"><i class="fa fa-check-circle text-green-500"></i></td>
                                </tr>
                                <!-- Act 23 -> WMS -->
                                <tr>
                                    <td class="px-4 py-3 text-center font-bold text-gray-500 bg-gray-50">23</td>
                                    <td class="px-4 py-3"><span class="px-2 py-1 bg-orange-100 text-orange-800 rounded text-xs">WMS</span></td>
                                    <td class="px-4 py-3">
                                        <div class="font-medium text-gray-900">领料需求单</div>
                                        <div class="text-xs text-gray-500 mt-1">源仓库, 目标产线, 物料, 数量</div>
                                    </td>
                                    <td class="px-4 py-3 text-gray-600">联动触发：与生产指令同步</td>
                                    <td class="px-4 py-3 text-center"><i class="fa fa-check-circle text-green-500"></i></td>
                                </tr>
                                <!-- Act 13 -> SAP -->
                                <tr>
                                    <td class="px-4 py-3 text-center font-bold text-gray-500 bg-gray-50">13</td>
                                    <td class="px-4 py-3"><span class="px-2 py-1 bg-purple-100 text-purple-800 rounded text-xs">SAP</span></td>
                                    <td class="px-4 py-3">
                                        <div class="font-medium text-gray-900">生产订单回写</div>
                                        <div class="text-xs text-gray-500 mt-1">创建 Production Order 核算成本</div>
                                    </td>
                                    <td class="px-4 py-3 text-gray-600">定时/手动回写</td>
                                    <td class="px-4 py-3 text-center"><i class="fa fa-check-circle text-green-500"></i></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>  




<!-- 27 滚动储备管理 -->
        <div id="activity-27" class="activity-section hidden">
            <div class="bg-white rounded-lg shadow mb-6">
                <div class="p-6 border-b border-gray-200">
                    <h3 class="text-lg font-medium text-gray-800">27 滚动储备管理</h3>
                    <p class="text-sm text-gray-500 mt-1">库存与MRP模块、虚拟储备订单管理页</p>
                </div>
                <div class="p-6">
                    <div class="mb-6">
                        <h4 class="text-md font-medium text-gray-700 mb-2">功能描述</h4>
                        <ul class="list-disc pl-5 text-sm text-gray-600">
                            <li>独立储备台账：APS 独立维护"储备订单"的生命周期，区别于普通生产订单</li>
                            <li>机会推荐算法：基于下月预测量与当前机台空闲率，自动计算并推荐"高频储备件"生产任务</li>
                            <li>双向同步：接收 MES 完工增加储备，接收 WMS 入库校验储备准确性</li>
                        </ul>
                    </div>
                    <div class="mb-6">
                        <h4 class="text-md font-medium text-gray-700 mb-2">数据交互 (I/O)</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-gray-50 p-4 rounded">
                                <p class="text-sm font-medium text-gray-700">输入</p>
                                <p class="text-sm text-gray-600">MES/WMS 数据</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded">
                                <p class="text-sm font-medium text-gray-700">输出</p>
                                <p class="text-sm text-gray-600">可用储备量</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 虚拟储备订单管理页面 -->
            <div class="bg-white rounded-lg shadow">
                <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                    <h3 class="text-lg font-medium text-gray-800">虚拟储备订单管理</h3>
                    <div class="flex space-x-2">
                        <button id="create-reserve-order-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-all">
                            <i class="fa fa-plus mr-1"></i> 创建储备单
                        </button>
                        <button id="batch-production-btn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all">
                            <i class="fa fa-industry mr-1"></i> 批量转生产
                        </button>
                        <button id="sync-wms-btn" class="px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition-all">
                            <i class="fa fa-refresh mr-1"></i> 同步WMS
                        </button>
                    </div>
                </div>
                <div class="p-6">
                    <!-- 机会推荐区域 -->
                    <div class="mb-8">
                        <h4 class="text-md font-medium text-gray-700 mb-4">储备机会推荐</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="border border-blue-200 rounded-lg p-4 bg-blue-50">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h5 class="font-medium text-gray-900">翅片-A001</h5>
                                        <p class="text-sm text-gray-600 mt-1">下月预测: 1,200件</p>
                                        <p class="text-sm text-gray-600">当前库存: 350件</p>
                                        <p class="text-sm text-gray-600">建议储备: 400件</p>
                                    </div>
                                    <span class="px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full">下月急缺</span>
                                </div>
                                <div class="mt-4 flex justify-end">
                                    <button class="px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 quick-produce-btn" data-item="翅片-A001" data-qty="400">
                                        一键转生产
                                    </button>
                                </div>
                            </div>
                            <div class="border border-blue-200 rounded-lg p-4 bg-blue-50">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h5 class="font-medium text-gray-900">翅片-B002</h5>
                                        <p class="text-sm text-gray-600 mt-1">下月预测: 800件</p>
                                        <p class="text-sm text-gray-600">当前库存: 200件</p>
                                        <p class="text-sm text-gray-600">建议储备: 300件</p>
                                    </div>
                                    <span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full">库存偏低</span>
                                </div>
                                <div class="mt-4 flex justify-end">
                                    <button class="px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 quick-produce-btn" data-item="翅片-B002" data-qty="300">
                                        一键转生产
                                    </button>
                                </div>
                            </div>
                            <div class="border border-blue-200 rounded-lg p-4 bg-blue-50">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h5 class="font-medium text-gray-900">弯头-C003</h5>
                                        <p class="text-sm text-gray-600 mt-1">下月预测: 1,500件</p>
                                        <p class="text-sm text-gray-600">当前库存: 600件</p>
                                        <p class="text-sm text-gray-600">建议储备: 500件</p>
                                    </div>
                                    <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">机台空闲</span>
                                </div>
                                <div class="mt-4 flex justify-end">
                                    <button class="px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 quick-produce-btn" data-item="弯头-C003" data-qty="500">
                                        一键转生产
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 储备订单列表 -->
                    <div>
                        <h4 class="text-md font-medium text-gray-700 mb-4">储备订单台账</h4>
                        <div class="overflow-x-auto">
                            <table class="min-w-full border border-gray-200">
                                <thead>
                                    <tr>
                                        <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            <input type="checkbox" id="select-all-reserve-orders" class="h-4 w-4 text-blue-600 rounded">
                                        </th>
                                        <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">储备单号</th>
                                        <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">物料</th>
                                        <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">目标库存</th>
                                        <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">当前APS库存</th>
                                        <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">WMS实物库存</th>
                                        <th class="px-4 py-3 bg-gray-50 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">差异</th>
                                        <th class="px-4 py-3 bg-gray-50 border-b border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                                        <th class="px-4 py-3 bg-gray-50 border-b border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-gray-200">
                                    <tr>
                                        <td class="px-4 py-3 border-r border-gray-200">
                                            <input type="checkbox" class="reserve-order-checkbox h-4 w-4 text-blue-600 rounded" value="R-202507-001">
                                        </td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-900">R-202507-001</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">翅片-A001</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">1,000</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">350</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">345</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-green-600">+5</td>
                                        <td class="px-4 py-3 border-r border-gray-200">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
                                                已入库
                                            </span>
                                        </td>
                                        <td class="px-4 py-3 text-sm text-gray-500">
                                            <button class="text-blue-600 hover:text-blue-900 mr-2 view-reserve-btn" data-id="R-202507-001">查看</button>
                                            <button class="text-green-600 hover:text-green-900 to-production-btn" data-id="R-202507-001">转生产</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3 border-r border-gray-200">
                                            <input type="checkbox" class="reserve-order-checkbox h-4 w-4 text-blue-600 rounded" value="R-202507-002">
                                        </td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-900">R-202507-002</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">翅片-B002</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">800</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">200</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">200</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-green-600">0</td>
                                        <td class="px-4 py-3 border-r border-gray-200">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
                                                已入库
                                            </span>
                                        </td>
                                        <td class="px-4 py-3 text-sm text-gray-500">
                                            <button class="text-blue-600 hover:text-blue-900 mr-2 view-reserve-btn" data-id="R-202507-002">查看</button>
                                            <button class="text-green-600 hover:text-green-900 to-production-btn" data-id="R-202507-002">转生产</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3 border-r border-gray-200">
                                            <input type="checkbox" class="reserve-order-checkbox h-4 w-4 text-blue-600 rounded" value="R-202507-003">
                                        </td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-900">R-202507-003</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">弯头-C003</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">1,200</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">600</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">580</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-red-600">-20</td>
                                        <td class="px-4 py-3 border-r border-gray-200">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                生产中
                                            </span>
                                        </td>
                                        <td class="px-4 py-3 text-sm text-gray-500">
                                            <button class="text-blue-600 hover:text-blue-900 mr-2 view-reserve-btn" data-id="R-202507-003">查看</button>
                                            <button class="text-green-600 hover:text-green-900 to-production-btn" data-id="R-202507-003" disabled>转生产</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3 border-r border-gray-200">
                                            <input type="checkbox" class="reserve-order-checkbox h-4 w-4 text-blue-600 rounded" value="R-202507-004">
                                        </td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-900">R-202507-004</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">U型管-D004</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">600</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">0</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-gray-500">0</td>
                                        <td class="px-4 py-3 border-r border-gray-200 text-sm text-green-600">0</td>
                                        <td class="px-4 py-3 border-r border-gray-200">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">
                                                待生产
                                            </span>
                                        </td>
                                        <td class="px-4 py-3 text-sm text-gray-500">
                                            <button class="text-blue-600 hover:text-blue-900 mr-2 view-reserve-btn" data-id="R-202507-004">查看</button>
                                            <button class="text-green-600 hover:text-green-900 to-production-btn" data-id="R-202507-004">转生产</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200 mt-4">
                            <div class="text-sm text-gray-700">
                                显示 <span class="font-medium">1</span> 到 <span class="font-medium">4</span> 条，共 <span class="font-medium">12</span> 条
                            </div>
                            <div class="flex space-x-2">
                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50 disabled:opacity-50" disabled>
                                    上一页
                                </button>
                                <button class="px-3 py-1 border border-gray-300 rounded text-sm bg-blue-50 text-blue-600">
                                    1
                                </button>
                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                    2
                                </button>
                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                    3
                                </button>
                                <button class="px-3 py-1 border border-gray-300 rounded text-sm text-gray-700 hover:bg-gray-50">
                                    下一页
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
    </div>
            </div>
        </main>
    </div>

    <!-- JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化图表
            initCharts();
            
            // 导航切换
            setupNavigation();
            
            // 初始化活动01的交互
            setupActivity01();
            
            // 初始化活动02的交互
            setupActivity02();
            
            // 初始化活动22的交互
            setupActivity22();
            
            // 初始化活动23的交互
            setupActivity23();
            
            // 初始化活动24的交互
            setupActivity24();
         setupActivity17(); // 物料需求17
         setupActivity09(); // 需求分析09
            
            // 默认显示仪表盘
            document.getElementById('dashboard').classList.remove('hidden');
        });
        setupActivity11();
        // Activity 11: 产能分析 (精准推荐版) - 交互逻辑
        // ==========================================
        function setupActivity11() {
            console.log('Initializing Activity 11 (Smart Optimization)...');

            const ctx = document.getElementById('capacity-sim-gauge');
            let chart = null;

            // 基础常量 (模拟从 Act01/03/13 获取)
            const DEMAND = 125; // 需求 125w
            const UNIT_CAPACITY = 20; // 单线产能 20w
            const STD_LEADTIME = 2.5; // 标准提前期

            // 修正后的推荐方案 (追求负荷率接近 100% 但不超标)
            const SUGGEST_LINES = 5; // 只增加 1 条线，而不是 3 条
            const SUGGEST_LT = 3.2;  // 提前期微调至 3.2 天
            
            // 预计算：5 * 20 * (3.2/2.5) = 128w -> 125/128 = 97.6% (完美!)
            const suggestCapacity = SUGGEST_LINES * UNIT_CAPACITY * (SUGGEST_LT / STD_LEADTIME);
            const suggestRate = Math.round((DEMAND / suggestCapacity) * 100); 

            // 更新 HTML 建议文案
            const suggestTextEl = document.getElementById('suggestion-text');
            if (suggestTextEl) {
                suggestTextEl.innerHTML = `
                    建议微调开线数至 <span class="font-bold text-purple-700">${SUGGEST_LINES}线</span>，
                    并配合提前期至 <span class="font-bold text-purple-700">${SUGGEST_LT.toFixed(1)}天</span>。
                    <br>预计负荷率将优化至 <span class="font-bold text-green-600">${suggestRate}%</span> (资源利用率最优)。
                `;
            }

            // 初始化图表
            if (ctx) {
                chart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        datasets: [{
                            data: [100, 56], // 初始 156%
                            backgroundColor: ['#ef4444', '#e5e7eb'],
                            borderWidth: 0,
                            cutout: '75%',
                            circumference: 240,
                            rotation: 240
                        }]
                    },
                    options: { responsive: true, plugins: { tooltip: { enabled: false } } }
                });
            }

            // 1. 获取建议按钮
            const getSuggestBtn = document.getElementById('get-ai-suggest-btn');
            const suggestBox = document.getElementById('ai-suggestion-box');
            
            if (getSuggestBtn) {
                getSuggestBtn.addEventListener('click', function() {
                    const btn = this;
                    const icon = btn.querySelector('i');
                    
                    // 按钮动画
                    icon.className = 'fa fa-spinner fa-spin mr-1';
                    btn.classList.remove('animate-pulse');
                    
                    setTimeout(() => {
                        icon.className = 'fa fa-lightbulb-o mr-1';
                        suggestBox.classList.remove('hidden');
                        suggestBox.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }, 500);
                });
            }

            // 2. 应用建议按钮
            const applySuggestBtn = document.getElementById('apply-ai-suggest-btn');
            if (applySuggestBtn) {
                applySuggestBtn.addEventListener('click', function() {
                    // 填入推荐值
                    document.getElementById('sim-lines').value = SUGGEST_LINES;
                    document.getElementById('sim-leadtime').value = SUGGEST_LT;
                    
                    // 触发计算
                    document.getElementById('run-simulation-btn').click();
                    
                    // 隐藏建议框
                    suggestBox.classList.add('hidden');
                });
            }

            // 3. 模拟运算按钮
            const runBtn = document.getElementById('run-simulation-btn');
            if (runBtn) {
                runBtn.addEventListener('click', function() {
                    const btn = this;
                    const originalHtml = btn.innerHTML;
                    btn.innerHTML = '<i class="fa fa-spinner fa-spin mr-2"></i> 正在核算...';
                    btn.disabled = true;

                    setTimeout(() => {
                        // 获取输入值
                        const simLines = parseFloat(document.getElementById('sim-lines').value) || 0;
                        const simLt = parseFloat(document.getElementById('sim-leadtime').value) || 0;

                        // 核心公式：产能 = 线数 * 单线产能 * (模拟提前期 / 标准提前期)
                        const leadtimeFactor = simLt / STD_LEADTIME;
                        const totalCapacity = simLines * UNIT_CAPACITY * leadtimeFactor;
                        
                        const gap = totalCapacity - DEMAND;
                        const loadRate = Math.round((DEMAND / totalCapacity) * 100);

                        // 更新 UI
                        updateUI(loadRate, gap, totalCapacity);

                        btn.innerHTML = originalHtml;
                        btn.disabled = false;
                    }, 600);
                });
            }

            function updateUI(rate, gap, capacity) {
                const color = rate > 100 ? '#ef4444' : (rate > 85 ? '#f59e0b' : '#10b981');
                const isSafe = rate <= 100;

                // 更新仪表盘
                if (chart) {
                    chart.data.datasets[0].data = [Math.min(rate, 100), Math.max(0, 100-rate)];
                    chart.data.datasets[0].backgroundColor[0] = color;
                    chart.update();
                }

                // 更新数值
                const percentEl = document.getElementById('gauge-percent');
                percentEl.innerText = rate + '%';
                percentEl.style.color = color;

                document.getElementById('res-capacity').innerText = Math.round(capacity * 10) / 10;
                
                const gapEl = document.getElementById('res-gap');
                gapEl.innerText = (gap >= 0 ? '+' : '') + (Math.round(gap * 10) / 10) + ' 万孔';
                gapEl.className = `text-xl font-bold ${isSafe ? 'text-green-600' : 'text-red-600'}`;

                // 更新状态条
                const badge = document.getElementById('sim-status');
                badge.className = `px-3 py-1 text-xs font-bold rounded-full border ${isSafe ? 'bg-green-100 text-green-700 border-green-200' : 'bg-red-100 text-red-700 border-red-200'}`;
                badge.innerText = isSafe ? '模拟通过：产能满足' : `产能不足 (${rate}%)`;

                // 更新结论
                const conclusionEl = document.getElementById('res-conclusion');
                const box = document.getElementById('res-gap-box');
                
                if (isSafe) {
                    conclusionEl.innerHTML = `<span class="text-green-600 font-bold"><i class="fa fa-check-circle"></i> 方案可行！</span> 模拟配置下，产能已覆盖需求且资源利用率合理。`;
                    box.className = "p-3 border-l-4 border-green-500 bg-green-50 rounded transition-colors duration-300";
                } else {
                    conclusionEl.innerHTML = `<span class="text-red-600 font-bold"><i class="fa fa-times-circle"></i> 仍有缺口。</span> 请继续增加开线数或延长提前期。`;
                    box.className = "p-3 border-l-4 border-red-500 bg-red-50 rounded transition-colors duration-300";
                }
            }
        }          setupActivity20();

        // ==========================================
        // Activity 20: 任务释放 - 交互逻辑
        // ==========================================
        function setupActivity20() {
            console.log('Initializing Activity 20...');

            const selectAllBtn = document.getElementById('select-all-tasks-btn');
            const releaseBtn = document.getElementById('release-to-aps-btn');
            const filterBtn = document.getElementById('filter-tasks-btn');
            const headerCheckbox = document.getElementById('header-checkbox');
            const tbody = document.getElementById('release-task-tbody');
            const countText = document.getElementById('selection-count-text');

            // 1. 全选合格任务 (跳过 disabled 的)
            if (selectAllBtn) {
                selectAllBtn.addEventListener('click', function() {
                    const checkboxes = tbody.querySelectorAll('.task-checkbox:not(:disabled)');
                    const allChecked = Array.from(checkboxes).every(cb => cb.checked);
                    
                    checkboxes.forEach(cb => cb.checked = !allChecked);
                    updateSelectionCount();
                });
            }

            // 2. 表头 checkbox 联动
            if (headerCheckbox) {
                headerCheckbox.addEventListener('change', function() {
                    const checkboxes = tbody.querySelectorAll('.task-checkbox:not(:disabled)');
                    checkboxes.forEach(cb => cb.checked = this.checked);
                    updateSelectionCount();
                });
            }

            // 3. 单个 checkbox 变化监听
            if (tbody) {
                tbody.addEventListener('change', function(e) {
                    if (e.target.classList.contains('task-checkbox')) {
                        updateSelectionCount();
                    }
                });
            }

            // 更新选择计数辅助函数
            function updateSelectionCount() {
                const count = tbody.querySelectorAll('.task-checkbox:checked').length;
                if (countText) {
                    countText.textContent = `已选择 ${count} 项任务`;
                }
            }

            // 4. 释放至排程
            if (releaseBtn) {
                releaseBtn.addEventListener('click', function() {
                    const checkedBoxes = tbody.querySelectorAll('.task-checkbox:checked');
                    if (checkedBoxes.length === 0) {
                        alert('请至少选择一项合格任务！');
                        return;
                    }

                    if (confirm(`确定释放选中的 ${checkedBoxes.length} 个任务到排程系统吗？\n释放后任务将从当前列表中移除。`)) {
                        const originalText = this.innerHTML;
                        this.innerHTML = '<i class="fa fa-spinner fa-spin"></i> 处理中...';
                        this.disabled = true;

                        setTimeout(() => {
                            // 模拟移除行
                            checkedBoxes.forEach(cb => {
                                const row = cb.closest('tr');
                                row.style.transition = 'all 0.5s';
                                row.style.opacity = '0';
                                setTimeout(() => row.remove(), 500);
                            });

                            this.innerHTML = originalText;
                            this.disabled = false;
                            alert('任务释放成功！数据已流转至排产子系统。');
                            
                            // 重置计数
                            if (countText) countText.textContent = '已选择 0 项任务';
                            if (headerCheckbox) headerCheckbox.checked = false;
                        }, 1000);
                    }
                });
            }

            // 5. 筛选按钮模拟
            if (filterBtn) {
                filterBtn.addEventListener('click', function() {
                    const originalText = this.innerHTML;
                    this.innerHTML = '<i class="fa fa-circle-o-notch fa-spin"></i>';
                    setTimeout(() => {
                        this.innerHTML = originalText;
                        alert('列表已根据条件刷新（模拟）。');
                    }, 500);
                });
            }
        }
    
setupActivity04(); 
        
        // ==========================================
        // Activity 04: 编制战略主计划 - 交互逻辑
        // ==========================================
        function setupActivity04() {
            console.log('Initializing Activity 04...');

            // 1. 滚动拉动模式开关逻辑
            // ------------------------------------------
            const rollingSwitch = document.getElementById('rolling-mode-switch');
            const thresholdInput = document.getElementById('rolling-threshold');
            const leadTimeInput = document.getElementById('rolling-lead-time');

            if (rollingSwitch) {
                rollingSwitch.addEventListener('change', function() {
                    const isEnabled = this.checked;
                    // 禁用/启用输入框
                    thresholdInput.disabled = !isEnabled;
                    leadTimeInput.disabled = !isEnabled;
                    
                    // 视觉上的禁用效果
                    if (!isEnabled) {
                        thresholdInput.classList.add('bg-gray-100', 'text-gray-400');
                        leadTimeInput.classList.add('bg-gray-100', 'text-gray-400');
                    } else {
                        thresholdInput.classList.remove('bg-gray-100', 'text-gray-400');
                        leadTimeInput.classList.remove('bg-gray-100', 'text-gray-400');
                    }
                });
            }

            // 2. 运营储备录入 (添加行)
            // ------------------------------------------
            const addOpsBtn = document.getElementById('add-ops-demand-btn');
            const opsTableBody = document.querySelector('#ops-list-table tbody');

            if (addOpsBtn) {
                addOpsBtn.addEventListener('click', function() {
                    const material = document.getElementById('ops-material').value;
                    const qty = document.getElementById('ops-qty').value;
                    const deadline = document.getElementById('ops-deadline').value;

                    // 简单校验
                    if (!material || !qty || !deadline) {
                        alert('请填写完整信息，特别是截止日期！');
                        return;
                    }

                    // 动态添加一行到小表格
                    const newRow = document.createElement('tr');
                    newRow.innerHTML = `
                        <td class="py-1 text-blue-600 font-medium">${material}</td>
                        <td>${qty}</td>
                        <td>${deadline}</td>
                        <td><a href="#" class="text-red-600 hover:underline" onclick="this.closest('tr').remove()">删除</a></td>
                    `;
                    opsTableBody.appendChild(newRow); // 加到末尾
                    // opsTableBody.insertBefore(newRow, opsTableBody.firstChild); // 或者加到开头

                    // 清空输入框
                    document.getElementById('ops-material').value = '';
                    document.getElementById('ops-qty').value = '';
                    document.getElementById('ops-deadline').value = '';
                });
            }

            // 3. 生成主计划按钮
            // ------------------------------------------
            const generateBtn = document.getElementById('generate-master-plan-btn');
            if (generateBtn) {
                generateBtn.addEventListener('click', function() {
                    const originalText = this.innerHTML;
                    this.innerHTML = '<i class="fa fa-spinner fa-spin mr-2"></i> 合成运算中...';
                    this.disabled = true;

                    setTimeout(() => {
                        this.innerHTML = originalText;
                        this.disabled = false;
                        alert('战略主计划生成成功！\n已合并总装需求与运营储备需求。');
                        
                        // 这里可以写逻辑往下面的大表格里追加一行“刚刚录入的数据”来模拟效果
                    }, 1500);
                });
            }

            // 4. ETL 异常清洗弹窗控制
            // ------------------------------------------
            const etlModal = document.getElementById('etl-modal');
            const openEtlBtn = document.getElementById('open-etl-modal-btn');
            const closeEtlBtns = [
                document.getElementById('close-etl-modal-btn'),
                document.getElementById('close-etl-modal-bottom-btn')
            ];

            if (openEtlBtn && etlModal) {
                openEtlBtn.addEventListener('click', function() {
                    etlModal.classList.remove('hidden');
                });
            }

            closeEtlBtns.forEach(btn => {
                if (btn) {
                    btn.addEventListener('click', function() {
                        etlModal.classList.add('hidden');
                    });
                }
            });

            // 点击背景关闭弹窗
            if (etlModal) {
                etlModal.addEventListener('click', function(e) {
                    if (e.target === etlModal) {
                        etlModal.classList.add('hidden');
                    }
                });
            }
        }
function setupActivity09() {
            console.log('Initializing Activity 09...');

            // 1. 绘制"参数完整率"仪表盘 (环形图)
            // ------------------------------------------
            const gaugeCtx = document.getElementById('completeness-gauge');
            if (gaugeCtx) {
                // 检查是否已经存在图表实例，避免重复创建
                const existingChart = Chart.getChart(gaugeCtx);
                if (existingChart) {
                    existingChart.destroy();
                }

                new Chart(gaugeCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['已完整', '参数缺失'],
                        datasets: [{
                            data: [85, 15],
                            backgroundColor: [
                                '#2563eb', // blue-600
                                '#e5e7eb'  // gray-200
                            ],
                            borderWidth: 0,
                            cutout: '75%' // 设置空心圆的大小，让它看起来像圆环
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: { enabled: false } // 关闭提示框，保持简洁
                        },
                        rotation: -90, // 从顶部开始画
                        circumference: 360 // 画一个整圆
                    }
                });
            }

            // 2. 刷新数据按钮
            // ------------------------------------------
            const refreshBtn = document.getElementById('refresh-data-btn');
            if (refreshBtn) {
                refreshBtn.addEventListener('click', function() {
                    const originalHtml = this.innerHTML;
                    // 变成加载状态
                    this.innerHTML = '<i class="fa fa-circle-o-notch fa-spin mr-1"></i> 检查中...';
                    this.classList.add('opacity-75', 'cursor-wait');
                    
                    // 模拟 1.5秒 后完成
                    setTimeout(() => {
                        this.innerHTML = originalHtml;
                        this.classList.remove('opacity-75', 'cursor-wait');
                        alert('工艺数据完整性校验已完成！\n发现 0 个新增缺失项。');
                    }, 1500);
                });
            }

            // 3. 表格中的"跳转维护"点击事件
            // ------------------------------------------
            const jumpBtns = document.querySelectorAll('.jump-maintenance-btn');
            jumpBtns.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault(); // 阻止默认的链接跳转行为
                    const materialCode = this.getAttribute('data-material');
                    
                    // 模拟跳转反馈
                    if(confirm(`即将离开当前页面，前往 [${materialCode}] 的工艺参数维护界面。\n是否继续？`)) {
                        console.log(`Navigating to maintenance page for ${materialCode}`);
                        // 这里可以写实际的跳转逻辑，比如 window.location.href = ...
                    }
                });
            });
            
            // 4. 分页按钮简单反馈
            // ------------------------------------------
            // 这里只给"下一页"等按钮加个简单的点击反馈，显得有反应
            const pageBtns = document.querySelectorAll('#activity-09 button:not(#refresh-data-btn)');
            pageBtns.forEach(btn => {
                if(!btn.disabled) {
                    btn.addEventListener('click', function() {
                        // 简单的视觉反馈，如果是真实分页需要写数据加载逻辑
                        console.log('Pagination clicked');
                    });
                }
            });
        }
function setupActivity17() {
            console.log('Initializing Activity 17...');

            // 1. 物料分组折叠/展开 (手风琴效果)
            // ------------------------------------------
            const groupHeaders = document.querySelectorAll('#activity-17 .group-header');
            
            groupHeaders.forEach(header => {
                header.addEventListener('click', function() {
                    const groupId = this.getAttribute('data-group');
                    const details = document.querySelector(`.group-details[data-group="${groupId}"]`);
                    const icon = this.querySelector('.fa-chevron-down');
                    
                    if (details) {
                        // 切换显示/隐藏
                        details.classList.toggle('hidden');
                        
                        // 旋转箭头图标
                        if (icon) {
                            if (details.classList.contains('hidden')) {
                                icon.style.transform = 'rotate(0deg)';
                            } else {
                                icon.style.transform = 'rotate(180deg)';
                            }
                        }
                    }
                });
            });

            // 2. 刷新数据按钮模拟
            // ------------------------------------------
            const refreshBtn = document.getElementById('refresh-material-data-btn');
            if (refreshBtn) {
                refreshBtn.addEventListener('click', function() {
                    const originalText = this.innerHTML;
                    this.innerHTML = '<i class="fa fa-refresh fa-spin mr-1"></i> 刷新中...';
                    this.disabled = true;
                    
                    setTimeout(() => {
                        this.innerHTML = originalText;
                        this.disabled = false;
                        
                        // 模拟数据变化（这里只是简单的视觉反馈）
                        alert('WMS 最新库存数据已同步，物料缺口已更新。');
                    }, 1000);
                });
            }

            // 3. 导出按钮
            // ------------------------------------------
            const exportBtn = document.getElementById('export-material-summary-btn');
            if (exportBtn) {
                exportBtn.addEventListener('click', function() {
                    alert('正在生成 Excel 物料需求总表，请稍候...');
                });
            }
        }
      setupActivity20();

        // ==========================================
        // Activity 20: 任务释放 - 交互逻辑
        // ==========================================
        function setupActivity20() {
            console.log('Initializing Activity 20...');

            const selectAllBtn = document.getElementById('select-all-tasks-btn');
            const releaseBtn = document.getElementById('release-to-aps-btn');
            const filterBtn = document.getElementById('filter-tasks-btn');
            const headerCheckbox = document.getElementById('header-checkbox');
            const tbody = document.getElementById('release-task-tbody');
            const countText = document.getElementById('selection-count-text');

            // 1. 全选合格任务 (跳过 disabled 的)
            if (selectAllBtn) {
                selectAllBtn.addEventListener('click', function() {
                    const checkboxes = tbody.querySelectorAll('.task-checkbox:not(:disabled)');
                    const allChecked = Array.from(checkboxes).every(cb => cb.checked);
                    
                    checkboxes.forEach(cb => cb.checked = !allChecked);
                    updateSelectionCount();
                });
            }

            // 2. 表头 checkbox 联动
            if (headerCheckbox) {
                headerCheckbox.addEventListener('change', function() {
                    const checkboxes = tbody.querySelectorAll('.task-checkbox:not(:disabled)');
                    checkboxes.forEach(cb => cb.checked = this.checked);
                    updateSelectionCount();
                });
            }

            // 3. 单个 checkbox 变化监听
            if (tbody) {
                tbody.addEventListener('change', function(e) {
                    if (e.target.classList.contains('task-checkbox')) {
                        updateSelectionCount();
                    }
                });
            }

            // 更新选择计数辅助函数
            function updateSelectionCount() {
                const count = tbody.querySelectorAll('.task-checkbox:checked').length;
                if (countText) {
                    countText.textContent = `已选择 ${count} 项任务`;
                }
            }

            // 4. 释放至排程
            if (releaseBtn) {
                releaseBtn.addEventListener('click', function() {
                    const checkedBoxes = tbody.querySelectorAll('.task-checkbox:checked');
                    if (checkedBoxes.length === 0) {
                        alert('请至少选择一项合格任务！');
                        return;
                    }

                    if (confirm(`确定释放选中的 ${checkedBoxes.length} 个任务到排程系统吗？\n释放后任务将从当前列表中移除。`)) {
                        const originalText = this.innerHTML;
                        this.innerHTML = '<i class="fa fa-spinner fa-spin"></i> 处理中...';
                        this.disabled = true;

                        setTimeout(() => {
                            // 模拟移除行
                            checkedBoxes.forEach(cb => {
                                const row = cb.closest('tr');
                                row.style.transition = 'all 0.5s';
                                row.style.opacity = '0';
                                setTimeout(() => row.remove(), 500);
                            });

                            this.innerHTML = originalText;
                            this.disabled = false;
                            alert('任务释放成功！数据已流转至排产子系统。');
                            
                            // 重置计数
                            if (countText) countText.textContent = '已选择 0 项任务';
                            if (headerCheckbox) headerCheckbox.checked = false;
                        }, 1000);
                    }
                });
            }

            // 5. 筛选按钮模拟
            if (filterBtn) {
                filterBtn.addEventListener('click', function() {
                    const originalText = this.innerHTML;
                    this.innerHTML = '<i class="fa fa-circle-o-notch fa-spin"></i>';
                    setTimeout(() => {
                        this.innerHTML = originalText;
                        alert('列表已根据条件刷新（模拟）。');
                    }, 500);
                });
            }
        }
        setupActivity28();

        // ==========================================
        // Activity 28: 系统集成 - Tab 交互逻辑
        // ==========================================
        function setupActivity28() {
            console.log('Initializing Activity 28...');

            const tabs = document.querySelectorAll('.interface-tab-link');
            const contents = document.querySelectorAll('.interface-tab-content');

            tabs.forEach(tab => {
                tab.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // 1. 重置所有 Tab 样式
                    tabs.forEach(t => {
                        t.classList.remove('text-blue-600', 'border-blue-600', 'active');
                        t.classList.add('border-transparent', 'text-gray-500', 'hover:text-gray-600', 'hover:border-gray-300');
                    });
                    
                    // 2. 激活当前 Tab
                    this.classList.remove('border-transparent', 'text-gray-500', 'hover:text-gray-600', 'hover:border-gray-300');
                    this.classList.add('text-blue-600', 'border-blue-600', 'active');
                    
                    // 3. 切换内容显示
                    const targetId = this.getAttribute('data-target');
                    contents.forEach(c => c.classList.add('hidden'));
                    document.getElementById(targetId).classList.remove('hidden');
                });
            });
        }
 setupActivity14();

        // ==========================================
        // Activity 14: 版本发布与变更 - 交互逻辑
        // ==========================================
        function setupActivity14() {
            console.log('Initializing Activity 14...');

            const handleBtn = document.querySelector('.btn-handle-risk');
            const handledTag = document.querySelector('.risk-handled-tag');
            const publishBtn = document.getElementById('btn-publish-version');
            const riskBadge = document.getElementById('risk-badge');
            const riskAlert = document.getElementById('risk-alert-text');
            const riskRow = document.querySelector('.risk-row');

            // 1. 风险处置逻辑
            if (handleBtn) {
                handleBtn.addEventListener('click', function() {
                    if (confirm('⚠️ 高风险操作确认\n\n该订单 [MO-1005] 处于 T+1 锁定区，取消将导致现场停机。\n\n系统将自动调用 MES 接口下发停机指令。\n是否继续？')) {
                        const originalText = this.innerHTML;
                        this.innerHTML = '<i class="fa fa-spinner fa-spin"></i> MES通讯中...';
                        this.classList.remove('animate-bounce');
                        this.disabled = true;

                        // 模拟接口调用
                        setTimeout(() => {
                            // UI 状态变更：处置成功
                            this.classList.add('hidden'); // 隐藏按钮
                            handledTag.classList.remove('hidden'); // 显示已停机标签
                            riskRow.classList.remove('bg-red-50', 'border-red-300'); // 移除红色警报样式
                            riskRow.classList.add('bg-gray-100', 'border-gray-300', 'opacity-70'); // 变灰

                            // 解锁发布按钮
                            publishBtn.disabled = false;
                            publishBtn.classList.remove('bg-gray-400', 'cursor-not-allowed');
                            publishBtn.classList.add('bg-blue-600', 'hover:bg-blue-700');
                            publishBtn.title = "所有风险已处置，可以发布";
                            
                            // 移除顶部警报
                            riskBadge.classList.add('hidden');
                            riskAlert.innerHTML = '<i class="fa fa-check-circle text-green-500"></i> 风险已清零，就绪。';
                            riskAlert.classList.remove('text-red-600');
                            riskAlert.classList.add('text-green-600');

                            alert('MES 指令下发成功！\n产线已收到 [MO-1005] 停机通知。\n现在可以发布新版本了。');
                        }, 1500);
                    }
                });
            }

            // 2. 版本发布逻辑
            if (publishBtn) {
                publishBtn.addEventListener('click', function() {
                    // 再次确认
                    if (confirm('确定要锁定当前草稿 [V1.1] 并发布为正式基线吗？\n\n发布后：\n1. 版本状态变为 Locked\n2. 数据将同步至各个下游系统')) {
                        this.innerHTML = '<i class="fa fa-spinner fa-spin"></i> 发布中...';
                        
                        setTimeout(() => {
                            // 更新列表状态
                            const row = document.getElementById('active-draft-row');
                            row.classList.remove('bg-blue-50', 'border-blue-500');
                            row.classList.add('hover:bg-gray-50');
                            
                            // 更新 Badge
                            const badge = row.querySelector('.bg-yellow-100');
                            badge.className = 'px-2 py-1 rounded-full bg-gray-100 text-gray-600 text-xs font-medium border border-gray-200';
                            badge.innerHTML = '<i class="fa fa-lock mr-1"></i> Locked';
                            
                            // 更新按钮
                            this.parentNode.innerHTML = '<span class="text-xs text-blue-600 font-bold">新基线 (Current)</span>';
                            
                            alert('版本 V1.1 发布成功！');
                        }, 1000);
                    }
                });
            }
        }
    setupActivity25();

        // ==========================================
        // Activity 25: 资源能力配置 - 交互逻辑
        // ==========================================
        function setupActivity25() {
            console.log('Initializing Activity 25...');

            // 1. Tab 切换逻辑
            // ------------------------------------------
            const tabs = document.querySelectorAll('.resource-tab-link');
            const contents = document.querySelectorAll('.resource-tab-content');

            tabs.forEach(tab => {
                tab.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // 1. 移除所有 active 样式
                    tabs.forEach(t => {
                        t.classList.remove('text-blue-600', 'border-blue-600', 'active');
                        t.classList.add('border-transparent', 'hover:text-gray-600', 'hover:border-gray-300');
                    });
                    contents.forEach(c => c.classList.add('hidden'));

                    // 2. 激活当前 Tab
                    this.classList.remove('border-transparent', 'hover:text-gray-600', 'hover:border-gray-300');
                    this.classList.add('text-blue-600', 'border-blue-600', 'active');
                    
                    const targetId = this.getAttribute('data-target');
                    document.getElementById(targetId).classList.remove('hidden');
                });
            });

            // 2. 保存并应用按钮
            // ------------------------------------------
            const saveBtn = document.getElementById('save-all-config-btn');
            if (saveBtn) {
                saveBtn.addEventListener('click', function() {
                    const originalText = this.innerHTML;
                    this.innerHTML = '<i class="fa fa-spinner fa-spin"></i> 正在同步排产引擎...';
                    this.disabled = true;

                    // 模拟保存延迟
                    setTimeout(() => {
                        this.innerHTML = '<i class="fa fa-check"></i> 配置已生效';
                        this.className = 'px-6 py-2 bg-gray-600 text-white rounded cursor-not-allowed shadow-sm';
                        
                        alert('资源能力模型保存成功！\nActivity 22 (排产引擎) 已自动读取最新规则：\n1. 机台能力矩阵更新\n2. 换型时间参数更新\n3. 并单规则已启用');
                        
                        // 2秒后恢复按钮
                        setTimeout(() => {
                            this.innerHTML = originalText;
                            this.className = 'px-6 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-all shadow-sm';
                            this.disabled = false;
                        }, 2000);
                    }, 1200);
                });
            }
        }
   setupActivity16(); 

        // ==========================================
        // Activity 16: 编制内控计划 - 交互逻辑
        // ==========================================
        function setupActivity16() {
            console.log('Initializing Activity 16...');

            // 1. MRP 向导步骤切换逻辑
            // ------------------------------------------
            const step1 = document.getElementById('mrp-step-1');
            const step2 = document.getElementById('mrp-step-2');
            const step3 = document.getElementById('mrp-step-3');
            
            const nextToStep2Btn = document.getElementById('next-to-step-2-btn');
            const backToStep1Btn = document.getElementById('back-to-step-1-btn');
            const executeCalcBtn = document.getElementById('execute-calculation-btn');
            const backToStep2Btn = document.getElementById('back-to-step-2-btn');

            // 跳转到步骤 2
            if (nextToStep2Btn) {
                nextToStep2Btn.addEventListener('click', function() {
                    step1.classList.add('hidden');
                    step1.classList.remove('active');
                    step2.classList.remove('hidden');
                    step2.classList.add('active');
                    updateStepIndicator(2);
                });
            }

            // 返回步骤 1
            if (backToStep1Btn) {
                backToStep1Btn.addEventListener('click', function() {
                    step2.classList.add('hidden');
                    step2.classList.remove('active');
                    step1.classList.remove('hidden');
                    step1.classList.add('active');
                    updateStepIndicator(1);
                });
            }

            // 执行计算（模拟）并跳转到步骤 3
            if (executeCalcBtn) {
                executeCalcBtn.addEventListener('click', function() {
                    // 更改按钮状态提示正在计算
                    const originalText = this.innerHTML;
                    this.innerHTML = '<i class="fa fa-spinner fa-spin mr-1"></i> 计算中...';
                    this.disabled = true;

                    // 模拟 1.5秒 计算延迟
                    setTimeout(() => {
                        this.innerHTML = originalText;
                        this.disabled = false;
                        
                        step2.classList.add('hidden');
                        step2.classList.remove('active');
                        step3.classList.remove('hidden');
                        step3.classList.add('active');
                        updateStepIndicator(3);
                        alert('MRP 运算完成！已生成净需求清单。');
                    }, 1500);
                });
            }

            // 返回步骤 2
            if (backToStep2Btn) {
                backToStep2Btn.addEventListener('click', function() {
                    step3.classList.add('hidden');
                    step3.classList.remove('active');
                    step2.classList.remove('hidden');
                    step2.classList.add('active');
                    updateStepIndicator(2);
                });
            }

            // 更新顶部步骤条样式的辅助函数
            function updateStepIndicator(currentStep) {
                // 这里简单处理，实际项目中可以通过 ID 操作具体的圆圈样式
                // 这是一个简化的视觉反馈逻辑
                const steps = document.querySelectorAll('#activity-16 .rounded-full');
                // 这里的逻辑取决于你的 HTML 结构，简单起见略过复杂样式变更
            }

            // 2. Step 1: 库存快照选择逻辑
            // ------------------------------------------
            const snapshotSelect = document.getElementById('inventory-snapshot-select');
            if (snapshotSelect) {
                snapshotSelect.addEventListener('change', function() {
                    const snapshotTime = document.getElementById('snapshot-time');
                    const virtualTotal = document.getElementById('virtual-inventory-total');
                    const pendingOrders = document.getElementById('pending-orders');
                    
                    if (this.value) {
                        // 模拟数据回显
                        const date = new Date();
                        snapshotTime.textContent = this.options[this.selectedIndex].text.split('(')[0];
                        virtualTotal.textContent = Math.floor(Math.random() * 5000 + 1000) + ' 件';
                        pendingOrders.textContent = Math.floor(Math.random() * 20 + 5) + ' 单';
                        
                        // 启用下一步按钮
                        if (nextToStep2Btn) nextToStep2Btn.disabled = false;
                        if (nextToStep2Btn) nextToStep2Btn.classList.remove('bg-gray-400', 'cursor-not-allowed');
                        if (nextToStep2Btn) nextToStep2Btn.classList.add('bg-blue-600', 'hover:bg-blue-700');
                    } else {
                        // 重置
                        snapshotTime.textContent = '-';
                        virtualTotal.textContent = '-';
                        pendingOrders.textContent = '-';
                        if (nextToStep2Btn) nextToStep2Btn.disabled = true;
                    }
                });
            }

            // 3. Step 3: 订单折叠/展开 (手风琴效果)
            // ------------------------------------------
            const orderHeaders = document.querySelectorAll('.order-header');
            orderHeaders.forEach(header => {
                header.addEventListener('click', function(e) {
                    // 如果点击的是复选框，不触发折叠
                    if (e.target.type === 'checkbox') return;

                    const orderId = this.getAttribute('data-order');
                    const details = document.querySelector(`.order-details[data-order="${orderId}"]`);
                    const icon = this.querySelector('.fa-chevron-down');
                    
                    if (details) {
                        details.classList.toggle('hidden');
                        // 旋转图标
                        if (icon) {
                            if (details.classList.contains('hidden')) {
                                icon.style.transform = 'rotate(0deg)';
                            } else {
                                icon.style.transform = 'rotate(180deg)';
                            }
                        }
                    }
                });
            });

            // 4. 全选功能
            // ------------------------------------------
            const selectAllCheckbox = document.getElementById('select-all-orders');
            if (selectAllCheckbox) {
                selectAllCheckbox.addEventListener('change', function() {
                    const checkboxes = document.querySelectorAll('.order-checkbox');
                    checkboxes.forEach(cb => {
                        cb.checked = this.checked;
                    });
                });
            }

            // 5. 确认拆分按钮
            // ------------------------------------------
            const confirmSplitBtn = document.getElementById('confirm-split-btn');
            if (confirmSplitBtn) {
                confirmSplitBtn.addEventListener('click', function() {
                    const selectedCount = document.querySelectorAll('.order-checkbox:checked').length;
                    if (selectedCount === 0) {
                        alert('请至少选择一个订单进行拆分！');
                    } else {
                        alert(`成功拆分 ${selectedCount} 个订单！MO 单据已生成。`);
                    }
                });
            }
            
            // 6. 创建新快照按钮
            const createSnapshotBtn = document.getElementById('create-new-snapshot-btn');
            if (createSnapshotBtn) {
                createSnapshotBtn.addEventListener('click', function() {
                    alert('正在连接 WMS 获取实时库存数据... \n快照创建成功！');
                });
            }
        }
        function initCharts() {
            // 产能负荷趋势图
            const capacityCtx = document.getElementById('capacityChart').getContext('2d');
            new Chart(capacityCtx, {
                type: 'line',
                data: {
                    labels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],
                    datasets: [
                        {
                            label: '产能',
                            data: [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000],
                            borderColor: '#4299e1',
                            backgroundColor: 'rgba(66, 153, 225, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: '负荷',
                            data: [800, 850, 900, 950, 1050, 1100, 1150, 1100, 1050, 1000, 950, 900],
                            borderColor: '#ed8936',
                            backgroundColor: 'rgba(237, 137, 54, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '工时'
                            }
                        }
                    }
                }
            });

            // 订单状态分布图
            const orderStatusCtx = document.getElementById('orderStatusChart').getContext('2d');
            new Chart(orderStatusCtx, {
                type: 'doughnut',
                data: {
                    labels: ['待排产', '生产中', '已完成', '异常'],
                    datasets: [{
                        data: [42, 75, 128, 7],
                        backgroundColor: [
                            '#4299e1',
                            '#48bb78',
                            '#9f7aea',
                            '#e53e3e'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    }
                }
            });
        }

        function setupNavigation() {
            // 导航链接点击事件
            const navLinks = document.querySelectorAll('.nav-link, .mobile-nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // 获取目标活动ID
                    const targetId = this.getAttribute('data-target');
                    
                    // 隐藏所有活动和仪表盘
                    document.getElementById('dashboard').classList.add('hidden');
                    document.querySelectorAll('.activity-section').forEach(section => {
                        section.classList.add('hidden');
                    });
                    
                    // 显示目标活动
                    document.getElementById(targetId).classList.remove('hidden');
                    
                    // 更新页面标题
                    document.getElementById('page-title').textContent = this.querySelector('span').textContent;
                    
                    // 关闭移动端导航
                    document.getElementById('mobile-nav').classList.add('translate-x-full');
                });
            });
            
            // 移动端导航切换
            document.getElementById('mobile-nav-toggle').addEventListener('click', function() {
                document.getElementById('mobile-nav').classList.toggle('translate-x-full');
            });
            
            document.getElementById('mobile-nav-close').addEventListener('click', function() {
                document.getElementById('mobile-nav').classList.add('translate-x-full');
            });
            
            // 初始化菜单折叠/展开功能
            setupMenuToggle();
        }
        
        // 设置菜单折叠/展开功能
        function setupMenuToggle() {
            // 桌面端菜单切换
            document.querySelectorAll('.plan-demand-toggle, .demand-analysis-toggle, .process-capacity-toggle, .inventory-mrp-toggle, .advanced-scheduling-toggle').forEach(toggle => {
                // 默认隐藏子菜单
                const submenu = toggle.nextElementSibling;
                if (submenu) {
                    submenu.classList.add('hidden');
                }
                
                toggle.addEventListener('click', function() {
                    const submenu = this.nextElementSibling;
                    const icon = this.querySelector('i');
                    
                    if (submenu && icon) {
                        submenu.classList.toggle('hidden');
                        icon.classList.toggle('rotate-180');
                    }
                });
            });
            
            // 移动端菜单切换
            document.querySelectorAll('.mobile-plan-demand-toggle, .mobile-demand-analysis-toggle, .mobile-process-capacity-toggle, .mobile-inventory-mrp-toggle, .mobile-advanced-scheduling-toggle').forEach(toggle => {
                toggle.addEventListener('click', function() {
                    const type = this.classList[0]; // 获取类型（如mobile-plan-demand-toggle）
                    const submenuType = type.replace('-toggle', '-submenu'); // 转换为子菜单类型（如mobile-plan-demand-submenu）
                    const submenu = this.nextElementSibling;
                    const icon = this.querySelector('i');
                    
                    if (submenu && icon) {
                        submenu.classList.toggle('hidden');
                        icon.classList.toggle('rotate-180');
                    }
                });
            });
        }

        function setupActivity01() {
            // 初始化年度按钮点击事件
            const initYearBtn = document.getElementById('init-year-btn');
            const initYearWizard = document.getElementById('init-year-wizard');
            const closeInitWizard = document.getElementById('close-init-wizard');
            const cancelInitWizard = document.getElementById('cancel-init-wizard');
            const confirmInitWizard = document.getElementById('confirm-init-wizard');
            
            if (initYearBtn && initYearWizard) {
                initYearBtn.addEventListener('click', function() {
                    initYearWizard.classList.remove('hidden');
                });
                
                if (closeInitWizard) {
                    closeInitWizard.addEventListener('click', function() {
                        initYearWizard.classList.add('hidden');
                    });
                }
                
                if (cancelInitWizard) {
                    cancelInitWizard.addEventListener('click', function() {
                        initYearWizard.classList.add('hidden');
                    });
                }
                
                if (confirmInitWizard) {
                    confirmInitWizard.addEventListener('click', function() {
                        // 模拟初始化过程
                        alert('年度初始化成功！');
                        initYearWizard.classList.add('hidden');
                    });
                }
            }
            
            // 日历日期点击事件
            const calendarDays = document.querySelectorAll('.calendar-day');
            const shiftDetailPanel = document.getElementById('shift-detail-panel');
            const closeShiftDetail = document.getElementById('close-shift-detail');
            const detailDate = document.getElementById('detail-date');
            const saveShiftDetail = document.getElementById('save-shift-detail');
            
            calendarDays.forEach(day => {
                day.addEventListener('click', function() {
                    if (shiftDetailPanel && detailDate) {
                        const date = this.getAttribute('data-date');
                        detailDate.textContent = date;
                        shiftDetailPanel.classList.remove('translate-x-full');
                    }
                });
            });
            
            if (closeShiftDetail && shiftDetailPanel) {
                closeShiftDetail.addEventListener('click', function() {
                    shiftDetailPanel.classList.add('translate-x-full');
                });
            }
            
            if (saveShiftDetail) {
                saveShiftDetail.addEventListener('click', function() {
                    // 模拟保存过程
                    alert('班次详情保存成功！');
                    if (shiftDetailPanel) {
                        shiftDetailPanel.classList.add('translate-x-full');
                    }
                });
            }
            
            // 保存日历按钮点击事件
            const saveCalendarBtn = document.getElementById('save-calendar-btn');
            if (saveCalendarBtn) {
                saveCalendarBtn.addEventListener('click', function() {
                    // 模拟保存过程
                    alert('日历配置保存成功！');
                });
            }
        }

        function setupActivity02() {
            // 执行同步按钮点击事件
            const executeSyncBtn = document.getElementById('execute-sync');
            const syncProgressModal = document.getElementById('sync-progress-modal');
            const syncProgressBar = document.getElementById('sync-progress-bar');
            const syncProgressText = document.getElementById('sync-progress-text');
            const syncStatusText = document.getElementById('sync-status-text');
            
            if (executeSyncBtn && syncProgressModal) {
                executeSyncBtn.addEventListener('click', function() {
                    // 显示进度弹窗
                    syncProgressModal.classList.remove('hidden');
                    
                    // 禁用同步按钮
                    executeSyncBtn.disabled = true;
                    executeSyncBtn.classList.add('opacity-50', 'cursor-not-allowed');
                    
                    // 模拟同步进度
                    let progress = 0;
                    const interval = setInterval(() => {
                        progress += 5;
                        syncProgressBar.style.width = `${progress}%`;
                        syncProgressText.textContent = `${progress}%`;
                        
                        if (progress < 20) {
                            syncStatusText.textContent = '正在连接数据源...';
                        } else if (progress < 50) {
                            syncStatusText.textContent = '正在获取数据...';
                        } else if (progress < 80) {
                            syncStatusText.textContent = '正在处理数据...';
                        } else {
                            syncStatusText.textContent = '正在生成快照...';
                        }
                        
                        if (progress >= 100) {
                            clearInterval(interval);
                            
                            // 延迟关闭弹窗，显示完成状态
                            setTimeout(() => {
                                syncStatusText.textContent = '同步完成！';
                                
                                // 延迟后关闭弹窗
                                setTimeout(() => {
                                    syncProgressModal.classList.add('hidden');
                                    
                                    // 恢复按钮状态
                                    executeSyncBtn.disabled = false;
                                    executeSyncBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                                    
                                    // 显示成功消息
                                    alert('数据同步成功！');
                                    
                                    // 重置进度
                                    syncProgressBar.style.width = '0%';
                                    syncProgressText.textContent = '0%';
                                }, 1000);
                            }, 500);
                        }
                    }, 100);
                });
            }
        }

          
        // Activity 22: 智能排程 - 交互逻辑
        // ==========================================
        function setupActivity22() {
            console.log('Initializing Activity 22...');

            // 1. 应用策略按钮 (模拟重新排程)
            // ------------------------------------------
            const applyBtn = document.getElementById('apply-strategy-btn');
            const ganttBody = document.querySelector('.resource-lane'); // 简单指向第一个泳道演示

            if (applyBtn) {
                applyBtn.addEventListener('click', function() {
                    const originalText = this.innerHTML;
                    this.innerHTML = '<i class="fa fa-spinner fa-spin"></i> 算法运算中...';
                    this.disabled = true;

                    setTimeout(() => {
                        this.innerHTML = originalText;
                        this.disabled = false;
                        
                        // 模拟界面变化：比如并单任务颜色变了，或者位置变了
                        alert('排程策略已应用！\n1. 已按新规则重新合并小单\n2. 已根据优先级权重重新排序\n3. 换型时间已最小化优化');
                    }, 1200);
                });
            }

            // 2. 冲突任务点击提示
            // ------------------------------------------
            const conflictTasks = document.querySelectorAll('.task-conflict');
            conflictTasks.forEach(task => {
                task.addEventListener('click', function() {
                    const msg = this.getAttribute('data-msg');
                    alert(`⚠️ 资源冲突警告：\n${msg}\n\n建议操作：\n1. 将任务拖拽至其他时间段\n2. 拆分任务至其他机台`);
                });
            });

            // 3. 右键菜单与交互
            // ------------------------------------------
            const tasks = document.querySelectorAll('.task-item'); // 正常任务块
            const menu = document.getElementById('gantt-context-menu');

            tasks.forEach(task => {
                // 右键点击
                task.addEventListener('contextmenu', function(e) {
                    e.preventDefault();
                    if (menu) {
                        menu.style.left = `${e.pageX}px`;
                        menu.style.top = `${e.pageY}px`;
                        menu.classList.remove('hidden');
                        
                        // 暂存当前选中的任务ID
                        menu.dataset.targetId = this.getAttribute('data-id');
                    }
                });
            });

            // 点击空白处关闭菜单
            document.addEventListener('click', function(e) {
                if (menu && !menu.contains(e.target)) {
                    menu.classList.add('hidden');
                }
            });

            // 菜单动作：拆分任务
            const splitAction = document.getElementById('ctx-split');
            if (splitAction) {
                splitAction.addEventListener('click', function(e) {
                    e.preventDefault();
                    const id = menu.dataset.targetId;
                    const qty = prompt(`请输入 [${id}] 的拆分数量：`, "500");
                    if (qty) {
                        alert(`任务已拆分！剩余部分将自动寻找空闲机台。`);
                        menu.classList.add('hidden');
                    }
                });
            }
            
            // 菜单动作：查看子单 (针对并单任务)
            const detailAction = document.getElementById('ctx-detail');
            if (detailAction) {
                detailAction.addEventListener('click', function(e) {
                    e.preventDefault();
                    alert(`合并任务详情：\n- MO-1002: 50件\n- MO-1003: 30件\n- MO-1004: 20件\n\n共计: 100件`);
                    menu.classList.add('hidden');
                });
            }
        }
        function setupActivity23() {
            // 确认计划按钮点击事件
            const confirmT3PlanBtn = document.getElementById('confirm-t3-plan-btn');
            const issueT3PlanBtn = document.getElementById('issue-t3-plan-btn');
            
            if (confirmT3PlanBtn) {
                confirmT3PlanBtn.addEventListener('click', function() {
                    // 模拟确认计划过程
                    alert('两器T+3计划确认成功！');
                });
            }
            
            if (issueT3PlanBtn) {
                issueT3PlanBtn.addEventListener('click', function() {
                    // 模拟下发计划过程
                    alert('两器T+3计划下发成功！');
                });
            }
        }
        
        function setupActivity24() {
            // 刷新数据按钮点击事件
            const refreshDataBtn = document.getElementById('refresh-data-btn');
            const exportReportBtn = document.getElementById('export-report-btn');
            const manualAdjustBtn = document.getElementById('manual-adjust-btn');
            
            if (refreshDataBtn) {
                refreshDataBtn.addEventListener('click', function() {
                    // 模拟刷新数据过程
                    alert('数据刷新成功！已获取最新的MES和WMS数据。');
                });
            }
            
            if (exportReportBtn) {
                exportReportBtn.addEventListener('click', function() {
                    // 模拟导出报告过程
                    alert('执行监控报告导出成功！');
                });
            }
            
            if (manualAdjustBtn) {
                manualAdjustBtn.addEventListener('click', function() {
                    // 模拟人工修正过程
                    alert('请选择需要修正的数据记录，点击"修正"按钮进行调整。');
                });
            }
            
            // 初始化图表
            initActivity24Charts();
        }
             setupActivity29();
        // 别忘了在初始化时调用： setupActivity29();
        // 别忘了在初始化时调用： setupActivity29();

        // ==========================================
        // Activity 29: 全景追溯 - 交互逻辑 (修复导出版)
        // ==========================================
        function setupActivity29() {
            console.log('Initializing Activity 29 (Export Fixed)...');

            const table = document.getElementById('traceability-table');
            const tbody = document.getElementById('trace-table-body');
            const colModal = document.getElementById('column-modal');
            const colContainer = document.getElementById('column-list-container');
            
            // 1. 导出 Excel             // ------------------------------------------
            const exportBtn = document.getElementById('export-excel-btn');
            
            if (exportBtn) {
                
                exportBtn.onclick = function(e) {
                    e.preventDefault(); // 防止默认行为
                    console.log('Export button clicked!'); // 调试日志

                    // 如果正在导出，直接返回
                    if (this.disabled) return;

                    const originalContent = this.innerHTML;
                    const originalClass = this.className;
                    const btn = this;

                    // 状态: 准备
                    btn.disabled = true;
                    // 强制修改样式，确保用户看到反馈
                    btn.className = "px-4 py-1.5 bg-blue-100 text-blue-700 rounded cursor-wait transition-all text-sm shadow-inner flex items-center relative overflow-hidden";
                    
                    // 进度条结构
                    const progressBar = document.createElement('div');
                    progressBar.className = "absolute left-0 top-0 bottom-0 bg-blue-200 transition-all duration-100 ease-linear";
                    progressBar.style.width = "0%";
                    progressBar.style.zIndex = "0";
                    progressBar.style.pointerEvents = "none"; // 防止遮挡文字
                    
                    const textSpan = document.createElement('span');
                    textSpan.className = "relative z-10 flex items-center";
                    textSpan.style.pointerEvents = "none";
                    textSpan.innerHTML = '<i class="fa fa-circle-o-notch fa-spin mr-2"></i> 正在生成...';
                    
                    btn.innerHTML = ''; 
                    btn.appendChild(progressBar); 
                    btn.appendChild(textSpan);

                    // 进度动画
                    let progress = 0;
                    const timer = setInterval(() => {
                        progress += Math.floor(Math.random() * 20) + 10;
                        if (progress > 90) progress = 95; // 稍作停顿
                        progressBar.style.width = progress + "%";
                        
                        if (progress >= 95) {
                            clearInterval(timer);
                            
                            // 模拟完成
                            setTimeout(() => {
                                progressBar.style.width = "100%";
                                progressBar.className = "absolute left-0 top-0 bottom-0 bg-green-500 transition-all";
                                textSpan.innerHTML = '<i class="fa fa-check mr-2"></i> 导出成功！';
                                textSpan.className = "relative z-10 flex items-center text-white font-bold";
                                
                                // 延迟恢复
                                setTimeout(() => {
                                    btn.className = originalClass; // 恢复原样式
                                    btn.innerHTML = originalContent; // 恢复原文字
                                    btn.disabled = false;
                                }, 2000);
                            }, 500);
                        }
                    }, 200);
                };
            } else {
                console.error('Error: export-excel-btn not found in DOM!');
            }

            // 2. 自定义列功能 (保持原逻辑)
            // ------------------------------------------
            const custBtn = document.getElementById('customize-columns-btn');
            if(custBtn) {
                custBtn.onclick = function() {
                    colContainer.innerHTML = '';
                    const headers = table.querySelectorAll('#table-header-row th[data-col]');
                    headers.forEach(th => {
                        const colId = th.getAttribute('data-col');
                        const isVisible = !th.classList.contains('hidden');
                        const item = document.createElement('div');
                        item.className = 'flex items-center p-2 hover:bg-gray-50 rounded cursor-pointer';
                        item.innerHTML = `<label class="flex items-center w-full cursor-pointer"><input type="checkbox" id="chk-${colId}" class="form-checkbox h-4 w-4 text-blue-600 rounded" ${isVisible ? 'checked' : ''}><span class="ml-2 text-sm text-gray-700">${th.innerText}</span></label>`;
                        colContainer.appendChild(item);
                    });
                    colModal.classList.remove('hidden');
                };
            }

            const applyBtn = document.getElementById('apply-column-btn');
            if(applyBtn) {
                applyBtn.onclick = function() {
                    const headers = table.querySelectorAll('#table-header-row th[data-col]');
                    headers.forEach(th => {
                        const colId = th.getAttribute('data-col');
                        const chk = document.getElementById(`chk-${colId}`);
                        const cells = table.querySelectorAll(`[data-col="${colId}"]`);
                        if (chk && chk.checked) cells.forEach(c => c.classList.remove('hidden'));
                        else cells.forEach(c => c.classList.add('hidden'));
                    });
                    colModal.classList.add('hidden');
                };
            }

            const cancelBtn = document.getElementById('cancel-column-btn');
            if(cancelBtn) {
                cancelBtn.onclick = () => colModal.classList.add('hidden');
            }

            // 3. 查询按钮模拟
            // ------------------------------------------
            // 更精确地查找查询按钮（排除导出按钮）
            const allBtns = document.querySelectorAll('#activity-29 button');
            let queryBtn = null;
            allBtns.forEach(btn => {
                if(btn.textContent.includes('查询')) queryBtn = btn;
            });

            if (queryBtn) {
                queryBtn.onclick = function() {
                    const originalHtml = this.innerHTML;
                    this.innerHTML = '<i class="fa fa-spinner fa-spin mr-1"></i>';
                    this.disabled = true;
                    if(tbody) tbody.style.opacity = '0.5';

                    setTimeout(() => {
                        this.innerHTML = originalHtml;
                        this.disabled = false;
                        if(tbody) tbody.style.opacity = '1';
                        // 简单提示
                        alert('数据已刷新（模拟）。');
                    }, 600);
                };
            }

            // 4. 版本追溯侧滑
            const drawer = document.getElementById('version-drawer');
            const closeDrawer = document.getElementById('close-drawer-btn');
            const traceBody = document.getElementById('trace-table-body');
            
            if(traceBody) {
                traceBody.onclick = function(e) {
                    if (e.target.classList.contains('version-link')) {
                        e.preventDefault();
                        if(drawer) {
                            const woId = e.target.getAttribute('data-id');
                            const titleEl = drawer.querySelector('p.text-xs');
                            if(titleEl) titleEl.textContent = woId;
                            drawer.classList.remove('translate-x-full');
                        }
                    }
                };
            }
            if(closeDrawer) closeDrawer.onclick = () => drawer.classList.add('translate-x-full');
        }
        
       
    function initActivity24Charts() {
            // 生产进度趋势图
            const productionTrendCtx = document.getElementById('productionTrendChart');
            if (productionTrendCtx) {
                new Chart(productionTrendCtx, {
                    type: 'line',
                    data: {
                        labels: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
                        datasets: [
                            {
                                label: '计划进度',
                                data: [10, 25, 40, 55, 70, 85, 100],
                                borderColor: '#4299e1',
                                backgroundColor: 'rgba(66, 153, 225, 0.1)',
                                borderWidth: 2,
                                fill: true,
                                tension: 0.4
                            },
                            {
                                label: '实际进度',
                                data: [8, 20, 35, 50, 65, 78, 85],
                                borderColor: '#48bb78',
                                backgroundColor: 'rgba(72, 187, 120, 0.1)',
                                borderWidth: 2,
                                fill: true,
                                tension: 0.4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: '完成率 (%)'
                                }
                            }
                        }
                    }
                });
            }
            
            // 订单完成情况图
            const orderCompletionCtx = document.getElementById('orderCompletionChart');
            if (orderCompletionCtx) {
                new Chart(orderCompletionCtx, {
                    type: 'bar',
                    data: {
                        labels: ['ORD-202507-001', 'ORD-202507-002', 'ORD-202507-003', 'ORD-202507-004', 'ORD-202507-005'],
                        datasets: [
                            {
                                label: '计划数量',
                                data: [50, 30, 20, 40, 60],
                                backgroundColor: 'rgba(66, 153, 225, 0.7)',
                            },
                            {
                                label: '完成数量',
                                data: [48, 30, 17, 35, 55],
                                backgroundColor: 'rgba(72, 187, 120, 0.7)',
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: '数量'
                                }
                            }
                        }
                    }
                });
            }
        }
    </script>
</body>
</html>
     